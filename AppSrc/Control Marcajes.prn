Compiling Program: C:\DataFlex Projects\Control Marcajes\AppSrc\Control Marcajes.src
Memory Available: 2147483646
1>//**************************************************************
1>// WindowsProject.tpl for Spanish translated by Moose Software (www.moose-software.com) 
1>// 28/10/2008 revised for VDF 14.1 by Moose Software  
1>// 13/07/2010 Revised for VDF 16.0 by Moose Software
1>// 05/02/2012 Revised for VDF 17.0 by Moose Software
1>// 13/06/2013 Revised for VDF 17.1 by Moose Software
1>// 02/05/2014 Revised for VDF 18.0 by Moose Software
1>//*************************************************************************************
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 18.2\Pkg\dfallent.pkd)
75339>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardCommandBarSystem.pkg)
75339>>>// these are all the packages used in a standard MDI menubar/toolbar system
75339>>>
75339>>>Use cCJCommandBarSystem.pkg
75339>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardMenuItemClasses.pkg)
75339>>>>>Use Dfpanel.pkg
75339>>>>>Use cCJCommandBarSystem.pkg
75339>>>>>Use LanguageText.pkg
75339>>>>>
75339>>>>>
75339>>>>>Class cCJUndoMenuItem is a cCJMenuItem
75340>>>>>    
75340>>>>>    Procedure Construct_Object
75342>>>>>        Forward Send Construct_Object
75344>>>>>        Set psCaption   to C_$CaptionUndo
75345>>>>>        Set psToolTip to C_$ToolTipUndo
75346>>>>>        Set psDescription to C_$DescUndo
75347>>>>>        Set psImage to "ActionUndo.ico"
75348>>>>>        Set pbActiveUpdate to True
75349>>>>>        Set psCategory to C_$CategoryEdit
75350>>>>>        Set psShortcut to C_$Key_Ctrl_Z
75351>>>>>    End_Procedure
75352>>>>>
75352>>>>>    Procedure OnExecute Variant vCommandBarControl
75354>>>>>        Send Undo of (focus(Self))
75355>>>>>    End_Procedure
75356>>>>>    
75356>>>>>    Function IsEnabled Returns Boolean
75358>>>>>        Boolean bEnabled
75358>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
75359>>>>>        Function_Return bEnabled
75360>>>>>    End_Function
75361>>>>>         
75361>>>>>End_Class
75362>>>>>
75362>>>>>
75362>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
75363>>>>>    
75363>>>>>    Procedure Construct_Object
75365>>>>>        Forward Send Construct_Object
75367>>>>>        Set psCaption   to C_$CaptionDelete
75368>>>>>        Set psToolTip to C_$ToolTipDelete
75369>>>>>        Set psDescription to C_$DescDelete
75370>>>>>        Set psImage to "actionDelete.ico"
75371>>>>>        Set psShortcut to C_$Key_Delete
75372>>>>>        Set pbActiveUpdate to True
75373>>>>>        Set psCategory to C_$CategoryEdit
75374>>>>>    End_Procedure
75375>>>>>
75375>>>>>
75375>>>>>    Procedure OnExecute Variant vCommandBarControl
75377>>>>>        Send Delete of (focus(Self))
75378>>>>>    End_Procedure
75379>>>>>    
75379>>>>>    Function IsEnabled Returns Boolean
75381>>>>>        Boolean bEnabled
75381>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
75382>>>>>        Function_Return bEnabled
75383>>>>>    End_Function
75384>>>>>         
75384>>>>>End_Class
75385>>>>>
75385>>>>>
75385>>>>>Class cCJCutMenuItem is a cCJMenuItem
75386>>>>>    
75386>>>>>    Procedure Construct_Object
75388>>>>>        Forward Send Construct_Object
75390>>>>>        Set psCaption   to C_$CaptionCut
75391>>>>>        Set psToolTip to C_$TooltipCut
75392>>>>>        Set psDescription to C_$DescCut
75393>>>>>        Set psImage to "actionCut.ico"
75394>>>>>        Set psShortcut to C_$Key_Ctrl_X
75395>>>>>        Set pbActiveUpdate to True
75396>>>>>        Set psCategory to C_$CategoryEdit
75397>>>>>    End_Procedure
75398>>>>>
75398>>>>>
75398>>>>>    Procedure OnExecute Variant vCommandBarControl
75400>>>>>        Send Cut of (focus(Self))
75401>>>>>    End_Procedure
75402>>>>>    
75402>>>>>    Function IsEnabled Returns Boolean
75404>>>>>        Boolean bEnabled
75404>>>>>        Get CanCut of (Focus(Self)) to bEnabled
75405>>>>>        Function_Return bEnabled
75406>>>>>    End_Function
75407>>>>>         
75407>>>>>End_Class
75408>>>>>
75408>>>>>
75408>>>>>Class cCJCopyMenuItem is a cCJMenuItem
75409>>>>>    
75409>>>>>    Procedure Construct_Object
75411>>>>>        Forward Send Construct_Object
75413>>>>>        Set psCaption   to C_$CaptionCopy
75414>>>>>        Set psToolTip to C_$ToolTipCopy
75415>>>>>        Set psDescription to C_$DescCopy
75416>>>>>        Set psImage to "actionCopy.ico"
75417>>>>>        Set psShortcut to C_$Key_Ctrl_C
75418>>>>>        Set pbActiveUpdate to True
75419>>>>>        Set psCategory to C_$CategoryEdit
75420>>>>>    End_Procedure
75421>>>>>
75421>>>>>
75421>>>>>    Procedure OnExecute Variant vCommandBarControl
75423>>>>>        Send Copy of (focus(Self))
75424>>>>>    End_Procedure
75425>>>>>    
75425>>>>>    Function IsEnabled Returns Boolean
75427>>>>>        Boolean bEnabled
75427>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
75428>>>>>        Function_Return bEnabled
75429>>>>>    End_Function
75430>>>>>         
75430>>>>>End_Class
75431>>>>>
75431>>>>>
75431>>>>>Class cCJPasteMenuItem is a cCJMenuItem
75432>>>>>    
75432>>>>>    Procedure Construct_Object
75434>>>>>        Forward Send Construct_Object
75436>>>>>        Set psCaption   to C_$CaptionPaste
75437>>>>>        Set psToolTip to C_$ToolTipPaste
75438>>>>>        Set psDescription to C_$DescPaste
75439>>>>>        Set psImage to "actionPaste.ico"
75440>>>>>        Set pbActiveUpdate to True
75441>>>>>        Set psShortcut to C_$Key_Ctrl_V
75442>>>>>        Set psCategory to C_$CategoryEdit
75443>>>>>    End_Procedure
75444>>>>>
75444>>>>>
75444>>>>>    Procedure OnExecute Variant vCommandBarControl
75446>>>>>        Send Paste of (focus(Self))
75447>>>>>    End_Procedure
75448>>>>>    
75448>>>>>    Function IsEnabled Returns Boolean
75450>>>>>        Boolean bEnabled
75450>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
75451>>>>>        Function_Return bEnabled
75452>>>>>    End_Function
75453>>>>>         
75453>>>>>End_Class
75454>>>>>
75454>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
75455>>>>>    
75455>>>>>    Procedure Construct_Object
75457>>>>>        Forward Send Construct_Object
75459>>>>>        Set psCaption   to C_$CaptionSelectAll
75460>>>>>        Set psToolTip to C_$ToolTipSelectAll
75461>>>>>        Set psDescription to C_$DescSelectAll
75462>>>>>        Set pbActiveUpdate to True
75463>>>>>        Set psShortcut to C_$Key_Ctrl_A
75464>>>>>        Set psCategory to C_$CategoryEdit
75465>>>>>    End_Procedure
75466>>>>>
75466>>>>>
75466>>>>>    Procedure OnExecute Variant vCommandBarControl
75468>>>>>        Send Select_All of (focus(Self))
75469>>>>>    End_Procedure
75470>>>>>    
75470>>>>>    Function IsEnabled Returns Boolean
75472>>>>>        Boolean bEnabled
75472>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
75473>>>>>        Function_Return bEnabled
75474>>>>>    End_Function
75475>>>>>         
75475>>>>>End_Class
75476>>>>>
75476>>>>> 
75476>>>>>Class cCJExitMenuItem is a cCJMenuItem
75477>>>>>
75477>>>>>    Procedure Construct_Object
75479>>>>>        Forward Send Construct_Object
75481>>>>>        Set psCaption to C_$CaptionExit
75482>>>>>        Set psToolTip to C_$ToolTipExit
75483>>>>>        Set psDescription to C_$ToolTipExit
75484>>>>>        Set psShortcut to C_$Key_Alt_F4
75485>>>>>        Set psCategory to C_$CategoryFile
75486>>>>>    End_Procedure
75487>>>>>
75487>>>>>    Procedure OnExecute Variant vCommandBarControl
75489>>>>>        Send Exit_Application of Desktop
75490>>>>>    End_Procedure
75491>>>>>
75491>>>>>End_Class           
75492>>>>>
75492>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
75493>>>>>
75493>>>>>    Procedure Construct_Object
75495>>>>>        Forward Send Construct_Object
75497>>>>>        Set psCaption to C_$CaptionHelp
75498>>>>>        Set psDescription to C_$ToolTipHelp
75499>>>>>        Set psToolTip to C_$DescHelp
75500>>>>>        Set psImage to "ActionHelp.ico"
75501>>>>>        Set psShortcut to "F1"
75502>>>>>        Set psCategory to C_$CategoryHelp
75503>>>>>    End_Procedure
75504>>>>>    
75504>>>>>    Procedure OnExecute Variant vCommandBarControl
75506>>>>>        Send Help of (Focus(Self))
75507>>>>>    End_Procedure
75508>>>>>
75508>>>>>End_Class
75509>>>>>
75509>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
75510>>>>>
75510>>>>>    Procedure Construct_Object
75512>>>>>        Forward Send Construct_Object
75514>>>>>        Set psCaption to C_$CaptionAddStatusbar
75515>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
75516>>>>>        Set psDescription to  C_$DescAddStatusbar
75517>>>>>        Set psCategory to C_$CategoryWindow
75518>>>>>    End_Procedure
75519>>>>>
75519>>>>>    Procedure OnExecute Variant vCommandBarControl
75521>>>>>        Handle hoCommandBars hoClientArea
75521>>>>>        Get CommandBarSystemObject to hoCommandBars
75522>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75523>>>>>        If hoClientArea Begin
75525>>>>>            // the clientarea's parent panel has message
75525>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
75526>>>>>        End
75526>>>>>>
75526>>>>>    End_Procedure
75527>>>>>
75527>>>>>     Function IsChecked Returns Boolean
75529>>>>>        Boolean bOn
75529>>>>>        Handle hoCommandBars hoClientArea
75529>>>>>        Get CommandBarSystemObject to hoCommandBars
75530>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75531>>>>>        If hoClientArea Begin
75533>>>>>            // the clientarea's parent panel has message
75533>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
75534>>>>>        End
75534>>>>>>
75534>>>>>        Function_Return bOn
75535>>>>>     End_Function
75536>>>>>End_Class
75537>>>>>
75537>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
75538>>>>>
75538>>>>>    Procedure Construct_Object
75540>>>>>        Forward Send Construct_Object
75542>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
75543>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
75544>>>>>        Set psDescription to C_$DescAutoArrangeIcons
75545>>>>>        Set psCategory to C_$CategoryWindow
75546>>>>>    End_Procedure
75547>>>>>
75547>>>>>    Procedure OnExecute Variant vCommandBarControl
75549>>>>>        Handle hoCommandBars hoClientArea
75549>>>>>        Get CommandBarSystemObject to hoCommandBars
75550>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75551>>>>>        If hoClientArea Begin
75553>>>>>            // the clientarea's parent panel has message
75553>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
75554>>>>>        End
75554>>>>>>
75554>>>>>    End_Procedure
75555>>>>>    
75555>>>>>     Function IsChecked Returns Boolean
75557>>>>>        Boolean bOn
75557>>>>>        Handle hoCommandBars hoClientArea
75557>>>>>        Get CommandBarSystemObject to hoCommandBars
75558>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75559>>>>>        If hoClientArea Begin
75561>>>>>            // the clientarea's parent panel has message
75561>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
75562>>>>>        End
75562>>>>>>
75562>>>>>        Function_Return bOn
75563>>>>>     End_Function
75564>>>>>End_Class
75565>>>>>
75565>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
75566>>>>>
75566>>>>>    Procedure Construct_Object
75568>>>>>        Forward Send Construct_Object
75570>>>>>        Set psCaption to C_$CaptionRestoreMenus
75571>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
75572>>>>>        Set psDescription to C_$DescRestoreMenus
75573>>>>>        Set psCategory to C_$CategoryWindow
75574>>>>>    End_Procedure
75575>>>>>
75575>>>>>    Procedure OnExecute Variant vCommandBarControl
75577>>>>>        Handle hoCommandBars
75577>>>>>        Get CommandBarSystemObject to hoCommandBars
75578>>>>>        Send RestoreLayout of hoCommandBars
75579>>>>>    End_Procedure
75580>>>>>    
75580>>>>>End_Class
75581>>>>>
75581>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
75582>>>>>
75582>>>>>    Procedure Construct_Object
75584>>>>>        Forward Send Construct_Object
75586>>>>>        Set psCaption to C_$CaptionCascade
75587>>>>>        Set psToolTip to C_$ToolTipCascade
75588>>>>>        Set psDescription to  C_$DescCascade
75589>>>>>        Set psImage to "ActionCascade.ico"
75590>>>>>        Set psCategory to C_$CategoryWindow
75591>>>>>    End_Procedure
75592>>>>>    
75592>>>>>    Procedure OnExecute Variant vCommandBarControl
75594>>>>>        Handle hoCommandBars hoClientArea
75594>>>>>        Get CommandBarSystemObject to hoCommandBars
75595>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75596>>>>>        If hoClientArea Begin
75598>>>>>            Send Cascade_Windows of hoClientArea
75599>>>>>        End
75599>>>>>>
75599>>>>>    End_Procedure
75600>>>>>End_Class
75601>>>>>
75601>>>>>Class cCJTileHorizontally is a cCJMenuItem
75602>>>>>
75602>>>>>    Procedure Construct_Object
75604>>>>>        Forward Send Construct_Object
75606>>>>>        Set psCaption to C_$CaptionTileHorizontally 
75607>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
75608>>>>>        Set psDescription to  C_$DescTileHorizontally
75609>>>>>        Set psImage to "ActionTileHorizontally.ico"
75610>>>>>        Set psCategory to C_$CategoryWindow
75611>>>>>    End_Procedure
75612>>>>>
75612>>>>>    Procedure OnExecute Variant vCommandBarControl
75614>>>>>        Handle hoCommandBars hoClientArea
75614>>>>>        Get CommandBarSystemObject to hoCommandBars
75615>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75616>>>>>        If hoClientArea Begin
75618>>>>>            Send Tile_Windows_Horizontal of hoClientArea
75619>>>>>        End
75619>>>>>>
75619>>>>>    End_Procedure
75620>>>>>End_Class
75621>>>>>
75621>>>>>Class cCJTileVertically is a cCJMenuItem
75622>>>>>
75622>>>>>    Procedure Construct_Object
75624>>>>>        Forward Send Construct_Object
75626>>>>>        Set psCaption to C_$CaptionTileVertically  
75627>>>>>        Set psToolTip to C_$ToolTipTileVertically
75628>>>>>        Set psDescription to  C_$DescTileVertically
75629>>>>>        Set psImage to "ActionTileVertically.ico"
75630>>>>>        Set psCategory to C_$CategoryWindow
75631>>>>>    End_Procedure
75632>>>>>
75632>>>>>    Procedure OnExecute Variant vCommandBarControl
75634>>>>>        Handle hoCommandBars hoClientArea
75634>>>>>        Get CommandBarSystemObject to hoCommandBars
75635>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75636>>>>>        If hoClientArea Begin
75638>>>>>            Send Tile_Windows_Vertical of hoClientArea
75639>>>>>        End
75639>>>>>>
75639>>>>>    End_Procedure
75640>>>>>End_Class
75641>>>>>
75641>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
75642>>>>>
75642>>>>>    Procedure Construct_Object
75644>>>>>        Forward Send Construct_Object
75646>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
75647>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
75648>>>>>        Set psDescription to  C_$DescMinimizeWindows
75649>>>>>        Set psCategory to C_$CategoryWindow
75650>>>>>    End_Procedure
75651>>>>>
75651>>>>>    Procedure OnExecute Variant vCommandBarControl
75653>>>>>        Handle hoCommandBars hoClientArea
75653>>>>>        Get CommandBarSystemObject to hoCommandBars
75654>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75655>>>>>        If hoClientArea Begin
75657>>>>>            // the clientarea's parent panel has message
75657>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
75658>>>>>        End
75658>>>>>>
75658>>>>>    End_Procedure
75659>>>>>End_Class
75660>>>>>
75660>>>>>
75660>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
75661>>>>>
75661>>>>>    Procedure Construct_Object
75663>>>>>        Forward Send Construct_Object
75665>>>>>        Set psCaption to C_$CaptionRestoreWindows
75666>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
75667>>>>>        Set psDescription to  C_$DescRestoreWindows
75668>>>>>        Set psCategory to C_$CategoryWindow
75669>>>>>    End_Procedure
75670>>>>>
75670>>>>>    Procedure OnExecute Variant vCommandBarControl
75672>>>>>        Handle hoCommandBars hoClientArea
75672>>>>>        Get CommandBarSystemObject to hoCommandBars
75673>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75674>>>>>        If hoClientArea Begin
75676>>>>>            // the clientarea's parent panel has message
75676>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
75677>>>>>        End
75677>>>>>>
75677>>>>>    End_Procedure
75678>>>>>End_Class
75679>>>>>
75679>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
75680>>>>>
75680>>>>>    Procedure Construct_Object
75682>>>>>        Forward Send Construct_Object
75684>>>>>        Set psCaption to C_$CaptionArrangeIcons  
75685>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
75686>>>>>        Set psDescription to  C_$DescArrangeIcons
75687>>>>>        Set psCategory to C_$CategoryWindow
75688>>>>>    End_Procedure
75689>>>>>
75689>>>>>    Procedure OnExecute Variant vCommandBarControl
75691>>>>>        Handle hoCommandBars hoClientArea
75691>>>>>        Get CommandBarSystemObject to hoCommandBars
75692>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75693>>>>>        If hoClientArea Begin
75695>>>>>            Send Arrange_Icons of hoClientArea
75696>>>>>        End
75696>>>>>>
75696>>>>>    End_Procedure
75697>>>>>
75697>>>>>End_Class
75698>>>>>    
75698>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJAboutMenuItem.pkg)
75698>>>>>Use cCJCommandBarSystem.pkg
75698>>>>>Use LanguageText.pkg
75698>>>>>
75698>>>>>// It is expected that if you use this class that you provide an about object that is
75698>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
75698>>>>>// because you may wish to create your own custom about package.
75698>>>>>
75698>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
75699>>>>>
75699>>>>>    Procedure Construct_Object
75701>>>>>        Forward Send Construct_Object
75703>>>>>        Set psCaption to C_$CaptionAbout
75704>>>>>        Set psDescription to C_$ToolTipAbout
75705>>>>>        Set psToolTip to C_$DescAbout
75706>>>>>        Set psImage to "ActionAbout.ico"
75707>>>>>        Set psCategory to C_$CategoryHelp
75708>>>>>    End_Procedure
75709>>>>>    
75709>>>>>    Procedure OnExecute Variant vCommandBarControl
75711>>>>>        Handle hoCommandBars hoClientArea
75711>>>>>        Get CommandBarSystemObject to hoCommandBars
75712>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75713>>>>>        If hoClientArea Begin
75715>>>>>            Send Activate_About of hoClientArea
75716>>>>>        End
75716>>>>>>
75716>>>>>    End_Procedure
75717>>>>>
75717>>>>>End_Class
75718>>>>>
75718>>>>>
75718>>>Use cCJDeoMenuItemClasses.pkg
75718>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJMDIWindowsMenuItem.pkg)
75718>>>>>Use cCJCommandBarSystem.pkg
75718>>>>>
75718>>>>>Register_Function Client_ID Returns Integer
75718>>>>>
75718>>>>>// only used by cCJMDIWIndowsMenuItem
75718>>>>>Class cCJMDIWindowItem is a cCJMenuItem
75719>>>>>
75719>>>>>    Procedure Construct_Object
75721>>>>>        Forward Send Construct_Object
75723>>>>>        Property Handle phWindow 0 // object id of view
75724>>>>>        Set pbControlFlagNoMovable to True
75725>>>>>        Set pbActiveUpdate to True
75726>>>>>    End_Procedure
75727>>>>>    
75727>>>>>    Procedure OnExecute Variant vCommandBarControl
75729>>>>>        Handle hWindow
75729>>>>>        Get phWindow to hWindow
75730>>>>>        Send Activate_View of hWindow
75731>>>>>    End_Procedure
75732>>>>>    
75732>>>>>End_Class                
75733>>>>>
75733>>>>>
75733>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
75734>>>>>    
75734>>>>>    Procedure Construct_Object
75736>>>>>        Forward Send Construct_Object
75738>>>>>        Property Handle[] phArrayOfWindows
75739>>>>>        Set peControlType to xtpControlPopup
75740>>>>>        Set psCategory to C_$CategoryWindow
75741>>>>>    End_Procedure
75742>>>>>    
75742>>>>>     // This adds MDI windows to the existing menu items.
75742>>>>>     // This removes any existing windows menus and always adds a new set to the end
75742>>>>>
75742>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
75744>>>>>        Handle  hClientArea hView
75744>>>>>        String  sLabel
75744>>>>>        Integer i iWindows
75744>>>>>        Handle[] hArrayOfWindows
75745>>>>>        Variant vItem
75745>>>>>        
75745>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
75745>>>>>        // also assume that destroying an action removes all menu instances of that action
75745>>>>>        Get phArrayOfWindows to hArrayOfWindows
75746>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
75747>>>>>        For i from 0 to (iWindows-1)
75753>>>>>>
75753>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
75754>>>>>        Loop
75755>>>>>>
75755>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
75756>>>>>
75756>>>>>        // Add all views to this menu. Create the action and add the item
75756>>>>>        Move 0 to i
75757>>>>>        Get Client_Id to hClientArea // object id of client area
75758>>>>>        If (hClientArea > 0) Begin
75760>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
75761>>>>>            While (hView <> 0)
75765>>>>>                If (Active_State(hView)) Begin
75767>>>>>                    // create the action
75767>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
75768>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
75769>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
75770>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
75771>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
75773>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
75774>>>>>                    End
75774>>>>>>
75774>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
75775>>>>>                    If (i=0) Begin
75777>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
75778>>>>>                    End
75778>>>>>>
75778>>>>>                    // Create a menu item for this action
75778>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
75779>>>>>                    Increment i
75780>>>>>                End
75780>>>>>>
75780>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
75781>>>>>            Loop
75782>>>>>>
75782>>>>>        End
75782>>>>>>
75782>>>>>
75782>>>>>        Set phArrayOfWindows to hArrayOfWindows
75783>>>>>
75783>>>>>     End_Procedure
75784>>>>>     
75784>>>>>End_Class
75785>>>>>
75785>
75785>Object oHtmlHelp is a cHtmlHelp
75787>End_Object
75788>
75788>Object oApplication is a cApplication
75790>    Set peHelpType to htHtmlHelp
75791>End_Object
75792>
75792>Object oToolTipController is a cToolTipController
75794>    Move Self to ghoToolTipController
75795>End_Object
75796>
75796>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oEditContextMenu.pkg)
75796>>>Use cCJStandardMenuItemClasses.pkg
75796>>>
75796>>>Object oEditContextMenu is a cCJContextMenu
75798>>>    
75798>>>    Move Self to Default_Form_Floating_Menu_ID
75799>>>    
75799>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75801>>>    End_Object
75802>>>    
75802>>>    Object oCutMenuItem is a cCJCutMenuItem
75804>>>        Set pbControlBeginGroup to True
75805>>>    End_Object
75806>>>    
75806>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75808>>>    End_Object
75809>>>
75809>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75811>>>    End_Object
75812>>>
75812>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75814>>>    End_Object
75815>>>
75815>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75817>>>        Set pbControlBeginGroup to True
75818>>>    End_Object
75819>>>
75819>>>End_Object
75820>>>
75820>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oDEOEditContextMenu17.pkg)
75820>>>Use Windows.pkg
75820>>>Use cCJStandardMenuItemClasses.pkg
75820>>>Use cCJDeoMenuItemClasses.pkg
75820>>>
75820>>>
75820>>>Object oDEOEditContextMenu17 is a cCJContextMenu
75822>>>    
75822>>>    Move Self to Default_dbFloating_Menu_ID
75823>>>    
75823>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75825>>>    End_Object
75826>>>    
75826>>>    Object oCutMenuItem is a cCJCutMenuItem
75828>>>        Set pbControlBeginGroup to True
75829>>>    End_Object
75830>>>    
75830>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75832>>>    End_Object
75833>>>
75833>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75835>>>    End_Object
75836>>>
75836>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75838>>>    End_Object
75839>>>
75839>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75841>>>        Set pbControlBeginGroup to True
75842>>>    End_Object
75843>>>
75843>>>    Object oPromptMenuItem is a cCJPromptMenuItem
75845>>>        Set pbControlBeginGroup to True
75846>>>    End_Object
75847>>>
75847>>>    Object oFindNextMenu is a cCJFindNextMenuItem
75849>>>        Set pbControlBeginGroup to True
75850>>>    End_Object
75851>>>
75851>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75853>>>    End_Object
75854>>>
75854>>>    Object oClearMenuItem is a cCJClearMenuItem
75856>>>        Set pbControlBeginGroup to True
75857>>>    End_Object
75858>>>
75858>>>    Object oClearAllMenu is a cCJClearAllMenuItem
75860>>>    End_Object
75861>>>
75861>>>    Object oSaveMenu is a cCJSaveMenuItem
75863>>>    End_Object
75864>>>    
75864>>>    Object oDeleteMenu is a cCJDeleteMenuItem
75866>>>    End_Object
75867>>>
75867>>>    Object oRememberitem is a cCJRememberFieldMenuItem
75869>>>        Set pbControlBeginGroup to True
75870>>>    End_Object
75871>>>
75871>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
75873>>>    End_Object
75874>>>
75874>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
75876>>>    End_Object
75877>>>
75877>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
75879>>>    End_Object
75880>>>
75880>>>End_Object
75881>
75881>Object oMain is a Panel
75883>    Set Label to "Mi Proyecto"
75884>    Set Location to 4 3
75885>    Set Size to 300 539
75886>
75886>    Object oCommandBarSystem is a cCJCommandBarSystem
75888>        Set pbTimerUpdate to True
75889>
75889>        Procedure OnCreateCommandBars
75892>            Handle hoOptions
75892>            Get OptionsObject to hoOptions
75893>            Forward Send OnCreateCommandBars
75895>        End_Procedure
75896>
75896>        Object oMenuBar is a cCJMenuBar
75898>
75898>            Object oFileMenu is a cCJMenuItem
75900>                Set peControlType to xtpControlPopup          
75901>                Set psCaption   to "Archivo"    // &F   <--------------------------
75902>                Set psDescription to "Buscar, Grabar, Borrar, limpiar informaci¢n o salir de esta aplicaci¢n."
75903>                Set psCategory to "Men£s"
75904>
75904>                Object oClearMenuItem is a cCJClearMenuItem
75906>                    Set pbAddToDesignerMenu to True
75907>                End_Object
75908>
75908>                Object oClearAllMenu is a cCJClearAllMenuItem
75910>                    Set pbAddToDesignerMenu to True
75911>                End_Object
75912>
75912>                Object oPromptMenuItem is a cCJPromptMenuItem
75914>                    Set pbAddToDesignerMenu to True
75915>                    Set pbControlBeginGroup to True
75916>                End_Object
75917>
75917>                Object oFindMenuItem is a cCJFindMenuItem
75919>                    Set pbAddToDesignerMenu to True
75920>                    Set pbControlBeginGroup to True
75921>                End_Object
75922>
75922>                Object oFindNextMenu is a cCJFindNextMenuItem
75924>                    Set pbAddToDesignerMenu to True
75925>                End_Object
75926>
75926>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75928>                    Set pbAddToDesignerMenu to True
75929>                End_Object
75930>
75930>                Object oFindFirstMenu is a cCJFindFirstMenuItem
75932>                    Set pbAddToDesignerMenu to True
75933>                End_Object
75934>
75934>                Object oFindLastMenu is a cCJFindLastMenuItem
75936>                    Set pbAddToDesignerMenu to True
75937>                End_Object
75938>
75938>                Object oSaveMenuItem is a cCJSaveMenuItem
75940>                    Set pbAddToDesignerMenu to True
75941>                    Set pbControlBeginGroup to True
75942>                End_Object
75943>
75943>                Object oDeleteMenuItem is a cCJDeleteMenuItem
75945>                    Set pbAddToDesignerMenu to True
75946>                End_Object
75947>
75947>                Object oExitMenu is a cCJExitMenuItem
75949>                    Set pbControlBeginGroup to True
75950>                End_Object
75951>
75951>            End_Object
75952>
75952>            Object oViewMenu is a cCJMenuItem
75954>                Set peControlType to xtpControlPopup
75955>                Set psCaption to "&Vistas"
75956>                Set psToolTip to "Vistas"
75957>               Set psDescription to "Vistas disponibles"
75958>
75958>               Object oRegistrodeEmpleadoMenuItem is a cCJMenuItem
75960>                   Set psCaption to "Registro de Empleado"
75961>                   Set psTooltip to "Registro de Empleado"
75962>               
75962>                   Procedure OnExecute Variant vCommandBarControl
75965>                       Handle hoClient
75965>                       Get Client_Id to hoClient
75966>                       Send Activate_RegistroEmpleado of hoClient
75967>                   End_Procedure
75968>               End_Object
75969>
75969>               Object oRegistrodeMarcajesMenuItem is a cCJMenuItem
75971>                   Set psCaption to "Registro de Marcajes"
75972>                   Set psTooltip to "Registro de Marcajes"
75973>               
75973>                   Procedure OnExecute Variant vCommandBarControl
75976>                       Handle hoClient
75976>                       Get Client_Id to hoClient
75977>                       Send Activate_RegistroMarcajes of hoClient
75978>                   End_Procedure
75979>               End_Object
75980>            End_Object
75981>            
75981>            Object oReportMenu is a cCJMenuItem
75983>                Set peControlType to xtpControlPopup          
75984>                Set psCaption to "&Informes"
75985>                Set psToolTip to "Informes"
75986>                Set psDescription to "Informes disponibles"
75987>            End_Object
75988>
75988>            Object oNavigateMenu is a cCJMenuItem
75990>                Set peControlType to xtpControlPopup      
75991>                Set psCaption to "&Navegar"    
75992>                Set psTooltip to "Navegar"    
75993>                Set psDescription to "Desplazarse a diferentes areas de la aplicaci¢n"
75994>
75994>                Object oNextAreaMenu is a cCJNextAreaMenu
75996>                End_Object
75997>
75997>                Object oPriorAreaMenu is a cCJPriorAreaMenu
75999>                End_Object
76000>
76000>                Object oNextViewMenu is a cCJNextViewMenu
76002>                End_Object
76003>
76003>                Object oPriorViewMenu is a cCJPriorViewMenu
76005>                End_Object
76006>
76006>                Object oPromptMenu is a cCJPromptMenuItem
76008>                    Set pbControlBeginGroup to True
76009>                End_Object
76010>
76010>                Object oZoomMenu is a cCJZoomMenuItem
76012>                End_Object
76013>
76013>            End_Object
76014>
76014>            Object oWindowMenu is a cCJMDIWindowsMenuItem
76016>                Set peControlType to xtpControlPopup
76017>                Set psCaption to "Ventana"      // &W <---------------
76018>                Set psToolTip to "Ventana"
76019>                Set psDescription to "Muestre vistas actuales y fije otras opciones de visualizaci¢n."
76020>
76020>                // These are the static windows items. More will be created in onInitPopup 
76020>                Object oDisplayOptionsMenu is a cCJMenuItem
76022>                    Set peControlType to xtpControlPopup          
76023>                    Set psCaption to "Opciones de visualizaci¢n"  // &D <--------------
76024>                    Set psToolTip to "Opciones de visualizaci¢n"
76025>                    Set psDescription to "Fije opciones de visualizaci¢n"
76026>
76026>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
76028>                    End_Object
76029>
76029>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
76031>                    End_Object
76032>
76032>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
76034>                        Set pbControlBeginGroup to True
76035>                    End_Object
76036>
76036>                End_Object
76037>
76037>                Object oCascadeMenu is a cCJCascadeMenuItem
76039>                    Set pbControlBeginGroup to True
76040>                End_Object
76041>
76041>                Object oHorizTile is a cCJTileHorizontally
76043>                End_Object
76044>
76044>                Object oVertTile is a cCJTileVertically
76046>                End_Object
76047>
76047>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
76049>                    Set pbControlBeginGroup to True
76050>                End_Object
76051>
76051>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
76053>                End_Object
76054>
76054>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
76056>                    Set pbControlBeginGroup to True
76057>                End_Object
76058>
76058>            End_Object
76059>
76059>            Object oHelpMenu is a cCJMenuItem
76061>                Set peControlType to xtpControlPopup    
76062>                Set psCaption to "&Ayuda"   // &H    <----------------------
76063>                Set psDescription to "Informaci¢n para aprender y para usar esta aplicaci¢n VDF"
76064>                Set psToolTip to "Ayuda"
76065>
76065>                Object oHelpMenuItem is a cCJHelpMenuItem 
76067>                End_Object
76068>
76068>                Object oAboutMenuItem is a cCJAboutMenuItem
76070>                End_Object
76071>
76071>            End_Object
76072>
76072>        End_Object
76073>
76073>        Object oFindToolBar is a cCJToolbar
76075>            Set psTitle to "Barra de herramientas de b£squeda"
76076>
76076>            Object oFindFirstTool is a cCJFindFirstMenuItem
76078>            End_Object
76079>
76079>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
76081>            End_Object
76082>
76082>            Object oFindMenuTool is a cCJFindMenuItem
76084>            End_Object
76085>
76085>            Object oFindNextTool is a cCJFindNextMenuItem
76087>            End_Object
76088>
76088>            Object oFindLastTool is a cCJFindLastMenuItem
76090>            End_Object
76091>
76091>            Object oPromptToolItem is a cCJPromptMenuItem
76093>                Set pbControlBeginGroup to True
76094>            End_Object
76095>
76095>        End_Object
76096>
76096>        Object oFileToolBar is a cCJToolbar
76098>            Set psTitle to "Barra de herramientas de introducci¢n de datos"
76099>
76099>            Object oClearToolItem is a cCJClearMenuItem
76101>                Set peControlStyle to xtpButtonIconAndCaption
76102>            End_Object
76103>
76103>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
76105>                Set peControlStyle to xtpButtonIconAndCaption
76106>            End_Object
76107>
76107>            Object oSaveToolItem is a cCJSaveMenuItem
76109>                Set peControlStyle to xtpButtonIconAndCaption
76110>                Set pbControlBeginGroup to True
76111>            End_Object
76112>
76112>            Object oDeleteToolItem is a cCJDeleteMenuItem
76114>                Set peControlStyle to xtpButtonIconAndCaption
76115>            End_Object
76116>
76116>        End_Object
76117>
76117>        Object oEditToolBar is a cCJToolbar
76119>            Set psTitle to "Barra de herramientas de edici¢n"
76120>
76120>            Object oCutToolbarItem is a cCJCutMenuItem
76122>            End_Object
76123>
76123>            Object oCopyToolbarItem is a cCJCopyMenuItem
76125>            End_Object
76126>
76126>            Object oPasteToolbarItem is a cCJPasteMenuItem
76128>            End_Object
76129>
76129>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
76131>                Set pbControlBeginGroup to True
76132>            End_Object
76133>
76133>        End_Object
76134>
76134>        Object oRememberToolbar is a cCJToolbar
76136>            Set psTitle to C_$Remember
76137>
76137>            Object oRememberItems is a cCJMenuItem
76139>
76139>                Set peControlType to xtpControlPopup
76140>                Set peControlStyle to xtpButtonCaption
76141>                Set psCaption to C_$Remember
76142>                
76142>                Object oMenuItem is a cCJRememberFieldMenuItem
76144>                    Set peControlStyle to xtpButtonIconAndCaption
76145>                End_Object
76146>                
76146>                Object oMenuItem is a cCJRememberLastFieldMenuItem
76148>                    Set peControlStyle to xtpButtonIconAndCaption
76149>                End_Object
76150>                
76150>                Object oMenuItem is a cCJUnRememberFieldMenuItem
76152>                    Set peControlStyle to xtpButtonIconAndCaption
76153>                End_Object
76154>                
76154>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
76156>                    Set peControlStyle to xtpButtonIconAndCaption
76157>                End_Object
76158>
76158>            End_Object
76159>            
76159>        End_Object
76160>        
76160>        Object oStatusBar is a cCJStatusBar
76162>
76162>            Object oStatusPane1 is a cCJStatusBarPane
76164>                Set piID to sbpIDIdlePane
76165>                Set pbStyleStretch to True
76166>            End_Object
76167>
76167>            Object oStatusPane2 is a cCJStatusBarPane
76169>                Set phoViewPane to Self
76170>                Set pbStyleStretch to True
76171>            End_Object
76172>
76172>        End_Object
76173>
76173>    End_Object
76174>
76174>    Object oClientArea is a ClientArea
76176>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\StdAbout.pkg)
76176>>>//************************************************************************
76176>>>// Confidential Trade Secret.
76176>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76176>>>// as an unpublished work.  All rights reserved.
76176>>>// DataFlex is a registered trademark of Data Access Corporation.
76176>>>//
76176>>>//************************************************************************
76176>>>//************************************************************************
76176>>>//
76176>>>// $File name  : StdAbout.pkg
76176>>>// $File title : Standard about object package for VDF
76176>>>// Notice      :
76176>>>// $Author(s)  : John Tuohy
76176>>>//
76176>>>// $Rev History
76176>>>//
76176>>>// JT 06/27/97   File created
76176>>>//************************************************************************
76176>>>
76176>>>// This provides a quick and simple way to create an about package for a program.
76176>>>// You need to create a message inside you client area called Activate_About.
76176>>>// Within this message you should send the message DoAbout passing needed
76176>>>// string information.
76176>>>//
76176>>>//       Procedure Activate_About
76176>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
76176>>>//       End_Procedure
76176>>>//    where: sTitle =     Name of application. If none provided, uses caption
76176>>>//                        bar title
76176>>>//           sVersion   = Version Line. If none provided, will be blank
76176>>>//           sCopyRight = Copyright Line. If none provided, will be blank
76176>>>//           sAuthor    = Author name, blank if none provided
76176>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
76176>>>//                        is used.
76176>>>// It is expected that you will place this in your own object package. For
76176>>>// example an order about package may look like this:
76176>>>//
76176>>>//   // OrderAbout.pkg
76176>>>//   Use StdAbout.pkg
76176>>>//   Procedure Activate_About
76176>>>//      String sTitle sCopyright sVersion sAuthor
76176>>>//      Move "My Order Entry System" to sTitle
76176>>>//      Move "Version 2.1" to sVersion
76176>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
76176>>>//      Move "John Smith"  to sAuthor
76176>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
76176>>>//   end_procedure
76176>>>//   // end of file.
76176>>>
76176>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\Dfabout.pkg)
76176>>>>>//************************************************************************
76176>>>>>// Confidential Trade Secret.
76176>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76176>>>>>// as an unpublished work.  All rights reserved.
76176>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
76176>>>>>//
76176>>>>>//************************************************************************
76176>>>>>//************************************************************************
76176>>>>>//
76176>>>>>// $File name  : DfAbout.pkg
76176>>>>>// $File title : About class support
76176>>>>>// Notice      :
76176>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
76176>>>>>//
76176>>>>>// $Rev History
76176>>>>>//
76176>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
76176>>>>>//                Windows for the size first. 
76176>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
76176>>>>>//                with anchor technique. Removed unnessary property in the
76176>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
76176>>>>>//                object To better look in Windows XP. Repositioned the close
76176>>>>>//                button in the sysinfo dialog To line up with the display area
76176>>>>>//                Replaced obsolete code and techniques. Removed dead code.
76176>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
76176>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
76176>>>>>//                the global Workspace object, if it is present
76176>>>>>// JJT 11/05/98   Added version information
76176>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
76176>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
76176>>>>>//                workspace package.
76176>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
76176>>>>>//                class can create this object.
76176>>>>>//                Cleaned up the interface (used correct classes and messages)
76176>>>>>//                Added workspace reporting support To sys-info.
76176>>>>>//                Turned off wrapping in the sys-info editor.
76176>>>>>// KR  ??/??/96   File created
76176>>>>>//************************************************************************
76176>>>>>Use LanguageText.pkg
76176>>>>>Use Windows.pkg
76176>>>>>Use DFbitmap.pkg
76176>>>>>Use GlobalFunctionsProcedures.pkg
76176>>>>>Use cTextEdit.pkg
76176>>>>>
76176>>>>>Use cli.pkg
Including file: cli.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cli.pkg)
76176>>>>>>>//*****************************************************************************
76176>>>>>>>//*** CLI.PKG                                                               ***
76176>>>>>>>//***                                                                       ***
76176>>>>>>>//*** Author: Ben Weijers                                                   ***
76176>>>>>>>//***         Data Access Nederland                                         ***
76176>>>>>>>//***         10 September 1998                                             ***
76176>>>>>>>//***                                                                       ***
76176>>>>>>>//*** Purpose:                                                              ***
76176>>>>>>>//***   CLI specific functionality. There are several connectivity kits     ***
76176>>>>>>>//***   based on  SQL/92 CLI. Those are:                                    ***
76176>>>>>>>//***    - ODBC_DRV  The Data Access CK for ODBC                            ***
76176>>>>>>>//***    - DB2_DRV   The Data Access CK for DB2                             ***
76176>>>>>>>//***    - MSSQLDRV  The Data Access CK for Microsoft SQL Server            ***
76176>>>>>>>//***                                                                       ***
76176>>>>>>>//***   This package defines the common functionality for all CLI based     ***
76176>>>>>>>//***   drivers.                                                            ***
76176>>>>>>>//***                                                                       ***
76176>>>>>>>//***   Updated:  May 23rd 2008 (Current CK build: 5.0.0.53 )               ***
76176>>>>>>>//***             Added NULLABLE and DEFAULT attributes for DATETIME type   ***
76176>>>>>>>//***   Updated:  Apr  6th 2009 (Current CK build: 5.0.0.61 )               ***
76176>>>>>>>//***             Added DF_DRIVER_MATCH_CLIENT_SERVER_VERSION attribute     ***
76176>>>>>>>//***                   DF_DRIVER_SQLSERVER_CLIENT_VERSION    attribute     ***
76176>>>>>>>//***   Updated:  Mar 30th 2012 (Current CK build: 5.1.0.93 )               ***
76176>>>>>>>//***             Added SQLSERVER2012CLIENT return value for                ***
76176>>>>>>>//***             DF_DRIVER_SQLSERVER_CLIENT_VERSION attribute              ***
76176>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
76176>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
76176>>>>>>>//***             mssqldrv.pkg                                              ***
76176>>>>>>>//***   Updated:  april 23, 2013 (Current CK build: 6.0.0.4)                ***
76176>>>>>>>//***             Added type mappings attributes                            ***
76176>>>>>>>//***   Updated:  october 11, 2013 (Current CK build: 6.0.0.18)             ***
76176>>>>>>>//***             Added DF_FILE_SQL_FILTER_EQ attribute                     ***
76176>>>>>>>//*****************************************************************************
76176>>>>>>>
76176>>>>>>>//*** We are not using ifndef below because that is not supported in Character Mode
76176>>>>>>>//*** Driver attributes
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//------------------------------------------------------------
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//-------------------------------------
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*** Replacement for logical column number that indicates all columns
76176>>>>>>>
76176>>>>>>>//*** Possible DF_FILE_GENERATE_RECORD_ID_METHOD values
76176>>>>>>>
76176>>>>>>>//*** Possible DF_FIELD_READ_ONLY values
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*** Possible DF_DRIVER_DEFAULT_MAP_DF_TO_SQL_TYPE_SCHEMA values
76176>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK5        1       
76176>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK6        2   
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>// Moved to Mssqldrv.pkg
76176>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
76176>>>>>>>//#REPLACE SQLSERVERUNKNOWNCLIENT  0
76176>>>>>>>//#REPLACE SQLSERVER2000CLIENT     8          //   "SQL Server"
76176>>>>>>>//#REPLACE SQLSERVER2005CLIENT     9          //   "SQL Native Client"
76176>>>>>>>//#REPLACE SQLSERVER2008CLIENT    10          //   "SQL Server Native Client 10.0"
76176>>>>>>>//#Replace SQLSERVER2012CLIENT    11          //   "SQL Server Native Client 11.0"
76176>>>>>>>
76176>>>>>>>//*** Possible SQL Column type values
76176>>>>>>>Define SQL_UNKNOWN_TYPE   For    0
76176>>>>>>>Define SQL_CHAR           For    1
76176>>>>>>>Define SQL_NUMERIC        For    2
76176>>>>>>>Define SQL_DECIMAL        For    3
76176>>>>>>>Define SQL_INTEGER        For    4
76176>>>>>>>Define SQL_SMALLINT       For    5
76176>>>>>>>Define SQL_FLOAT          For    6
76176>>>>>>>Define SQL_REAL           For    7
76176>>>>>>>Define SQL_DOUBLE         For    8
76176>>>>>>>Define SQL_DATETIME       For    9
76176>>>>>>>Define SQL_VARCHAR        For   12
76176>>>>>>>Define SQL_TYPE_DATE      For   91
76176>>>>>>>Define SQL_TYPE_TIME      For   92
76176>>>>>>>Define SQL_TYPE_TIMESTAMP for   93
76176>>>>>>>// Moved to mssqldrv.pkg
76176>>>>>>>//Define SQL_TYPE_TIMESTAMP2 for   (-200) //SQL server datetime2 type */
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>Define SQL_DATE           For    9
76176>>>>>>>Define SQL_INTERVAL       For   10
76176>>>>>>>Define SQL_TIME           For   10
76176>>>>>>>Define SQL_TIMESTAMP      For   11
76176>>>>>>>Define SQL_LONGVARCHAR    For  (-1)
76176>>>>>>>Define SQL_BINARY         For  (-2)
76176>>>>>>>Define SQL_VARBINARY      For  (-3)
76176>>>>>>>Define SQL_LONGVARBINARY  For  (-4)
76176>>>>>>>Define SQL_BIGINT         For  (-5)
76176>>>>>>>Define SQL_TINYINT        For  (-6)
76176>>>>>>>Define SQL_BIT            For  (-7)
76176>>>>>>>Define SQL_WCHAR          For  (-8)
76176>>>>>>>Define SQL_WVARCHAR       For  (-9)
76176>>>>>>>Define SQL_WLONGVARCHAR   For (-10)
76176>>>>>>>Define SQL_GUID           For (-11)
76176>>>>>>>
76176>>>>>>>//*** Driver level attributes
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*** Error number constants
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*** Call driver function identifiers
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*** Init data source types
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*** Dummy strings used in the commands
76176>>>>>>>    String  CLI$StrDummy 255
76176>>>>>>>    Integer CLI$IntDummy
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*****************************************************************************
76176>>>>>>>//*** CLI_SetConstraint <FileNum> <NewState>                                ***
76176>>>>>>>//***                                                                       ***
76176>>>>>>>//***   Setup a constraint for a file.                                      ***
76176>>>>>>>//*****************************************************************************
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*****************************************************************************
76176>>>>>>>//*** CLI_Set_Driver_Atrtribute / CLI_Get_Driver_Attribute                  ***
76176>>>>>>>//***                                                                       ***
76176>>>>>>>//*** Set or get an attribute at driver level. These attributes, when set,  ***
76176>>>>>>>//*** will be set for the remainder of the session or until set again. To   ***
76176>>>>>>>//*** permanently set driver level attributes change the driver             ***
76176>>>>>>>//*** configuration file.                                                   ***
76176>>>>>>>//*****************************************************************************
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>
76176>>>>>>>//*****************************************************************************
76176>>>>>>>//*** Class  : cCLIHandler                                                  ***
76176>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76176>>>>>>>//***          call several CLI releated methods.                           ***
76176>>>>>>>//*****************************************************************************
76176>>>>>>>
76176>>>>>>>Class cCLIHandler Is An Array
76177>>>>>>>
76177>>>>>>>    Procedure Construct_Object Integer iImage
76179>>>>>>>        Forward Send Construct_object iImage
76181>>>>>>>
76181>>>>>>>        Property String  psDriverID       Public ""
76182>>>>>>>    End_Procedure // Construct_Object
76183>>>>>>>
76183>>>>>>>
76183>>>>>>>
76183>>>>>>>    //***
76183>>>>>>>    //*** Fucntion: CKRevsion
76183>>>>>>>    //*** Purpose : The revsion of a CLI Connectivity Kit
76183>>>>>>>    //***
76183>>>>>>>
76183>>>>>>>    Function CKRevision Returns String
76185>>>>>>>        Local String  sDriverID
76185>>>>>>>        Local String  sRevision
76185>>>>>>>        Local String  sVoid
76185>>>>>>>        Local Integer iRetval
76185>>>>>>>
76185>>>>>>>        Get psDriverID To sDriverID
76186>>>>>>>        If (sDRiverID <> "") Begin
76188>>>>>>>            Move (Repeat(" ", 255)) To sRevision
76189>>>>>>>            Call_Driver 0 sDRiverID Function CLI_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76194>>>>>>>        End
76194>>>>>>>>
76194>>>>>>>
76194>>>>>>>        Function_Return sRevision
76195>>>>>>>    End_Function // CKRevision
76196>>>>>>>
76196>>>>>>>
76196>>>>>>>
76196>>>>>>>    //***
76196>>>>>>>    //*** Function: ExtractPartFromRevision
76196>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76196>>>>>>>    //***
76196>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76196>>>>>>>    //***
76196>>>>>>>
76196>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76198>>>>>>>        Local Integer iPartRev
76198>>>>>>>        Local Integer iCurrentPart
76198>>>>>>>        Local Integer iSeparatorPos
76198>>>>>>>
76198>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76201>>>>>>>
76201>>>>>>>        Move 0 To iCurrentPart
76202>>>>>>>        Repeat
76202>>>>>>>>
76202>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76203>>>>>>>            If (iSeparatorPos > 0) Begin
76205>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76206>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76207>>>>>>>                Increment iCurrentPart
76208>>>>>>>            End
76208>>>>>>>>
76208>>>>>>>            Else If (sRevision <> "") Begin
76211>>>>>>>                Move sRevision To iPartRev
76212>>>>>>>                Move "" To sRevision
76213>>>>>>>                Increment iCurrentPart
76214>>>>>>>            End
76214>>>>>>>>
76214>>>>>>>            Else ;                Move -1 To iPartRev
76216>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76218>>>>>>>
76218>>>>>>>        Function_Return iPartRev
76219>>>>>>>    End_Function // EcxtractPartFromRevision
76220>>>>>>>
76220>>>>>>>
76220>>>>>>>
76220>>>>>>>    //***
76220>>>>>>>    //*** Function: CKMajorRevision
76220>>>>>>>    //*** Purpose : Returns the major revision of the CK
76220>>>>>>>    //***
76220>>>>>>>
76220>>>>>>>    Function CKMajorRevision Returns Integer
76222>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76223>>>>>>>    End_Function // CKMajorRevision
76224>>>>>>>
76224>>>>>>>
76224>>>>>>>
76224>>>>>>>    //***
76224>>>>>>>    //*** Function: CKMinorRevision
76224>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76224>>>>>>>    //***
76224>>>>>>>
76224>>>>>>>    Function CKMinorRevision Returns Integer
76226>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76227>>>>>>>    End_Function // CKMinorRevision
76228>>>>>>>
76228>>>>>>>
76228>>>>>>>
76228>>>>>>>    //***
76228>>>>>>>    //*** Function: CKReleaseRevision
76228>>>>>>>    //*** Purpose : Returns the release revision of the CK
76228>>>>>>>    //***
76228>>>>>>>
76228>>>>>>>    Function CKReleaseRevision Returns Integer
76230>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76231>>>>>>>    End_Function // CKReleaseRevision
76232>>>>>>>
76232>>>>>>>
76232>>>>>>>
76232>>>>>>>    //***
76232>>>>>>>    //*** Function: CKBuildRevision
76232>>>>>>>    //*** Purpose : Returns the major revision of the CK
76232>>>>>>>    //***
76232>>>>>>>
76232>>>>>>>    Function CKBuildRevision Returns Integer
76234>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76235>>>>>>>    End_Function // CKBuildRevision
76236>>>>>>>
76236>>>>>>>
76236>>>>>>>
76236>>>>>>>    //***
76236>>>>>>>    //*** Function: IsMinimalRevision
76236>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76236>>>>>>>    //***
76236>>>>>>>
76236>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76238>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76241>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76244>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76247>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76250>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76253>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76257>>>>>>>            End
76257>>>>>>>>
76257>>>>>>>        End
76257>>>>>>>>
76257>>>>>>>
76257>>>>>>>        Function_Return (FALSE)
76258>>>>>>>    End_Function // IsMinimalRevision
76259>>>>>>>
76259>>>>>>>
76259>>>>>>>
76259>>>>>>>    //***
76259>>>>>>>    //*** Function: RegistrationName
76259>>>>>>>    //*** Purpose : Returns the Connectiivty Kit registration name.
76259>>>>>>>    //***
76259>>>>>>>
76259>>>>>>>    Function RegistrationName Returns String
76261>>>>>>>        Local String  sRegistration
76261>>>>>>>        Local String  sDRiverId
76261>>>>>>>        Local String  sVoid
76261>>>>>>>        Local Integer iRetval
76261>>>>>>>
76261>>>>>>>        Get psDriverID To sDriverID
76262>>>>>>>        If (sDRiverID <> "") Begin
76264>>>>>>>            Move (Repeat(" ", 255)) To sRegistration
76265>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETREGNAME Callback 0 Passing sRegistration sVoid 0 Result iRetval
76270>>>>>>>        End
76270>>>>>>>>
76270>>>>>>>
76270>>>>>>>        Function_Return sRegistration
76271>>>>>>>    End_Function // RegistrationName
76272>>>>>>>
76272>>>>>>>
76272>>>>>>>
76272>>>>>>>    //***
76272>>>>>>>    //*** Function: SerialNumber
76272>>>>>>>    //*** Purpose : Returns the Connectiivty Kit serial number.
76272>>>>>>>    //***
76272>>>>>>>
76272>>>>>>>    Function SerialNumber Returns Integer
76274>>>>>>>        Local String  sDRiverId
76274>>>>>>>        Local String  sVoid
76274>>>>>>>        Local Integer iRetval
76274>>>>>>>
76274>>>>>>>        Get psDriverID To sDriverID
76275>>>>>>>        If (sDRiverID <> "") Begin
76277>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETSERIALNUM Callback 0 Passing sVoid sVoid 0 Result iRetval
76282>>>>>>>        End
76282>>>>>>>>
76282>>>>>>>
76282>>>>>>>        Function_Return iRetval
76283>>>>>>>    End_Function // SerialNumber
76284>>>>>>>
76284>>>>>>>
76284>>>>>>>
76284>>>>>>>    //***
76284>>>>>>>    //*** Function: MaxUsers
76284>>>>>>>    //*** Purpose : Returns the Connectiivty Kit maximum number of users.
76284>>>>>>>    //***
76284>>>>>>>
76284>>>>>>>    Function MaxUsers Returns Integer
76286>>>>>>>        Local String  sDRiverId
76286>>>>>>>        Local String  sVoid
76286>>>>>>>        Local Integer iRetval
76286>>>>>>>
76286>>>>>>>        Get psDriverID To sDriverID
76287>>>>>>>        If (sDRiverID <> "") Begin
76289>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETMAXUSERS Callback 0 Passing sVoid sVoid 0 Result iRetval
76294>>>>>>>        End
76294>>>>>>>>
76294>>>>>>>
76294>>>>>>>        Function_Return iRetval
76295>>>>>>>    End_Function // MaxUsers
76296>>>>>>>
76296>>>>>>>
76296>>>>>>>
76296>>>>>>>    //***
76296>>>>>>>    //*** Procedure: DumpStatus
76296>>>>>>>    //*** Purpose  : Dump the current status of the drver in the passed disk file.
76296>>>>>>>    //***
76296>>>>>>>
76296>>>>>>>    Procedure DumpStatus String sFileName
76298>>>>>>>        Local String  sVoid
76298>>>>>>>        Local String  sDriverID
76298>>>>>>>        Local Integer iVoid
76298>>>>>>>
76298>>>>>>>        Get psDriverID To sDriverID
76299>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_DUMPSTATUS Callback 0 Passing sFileName sVoid iVoid Result iVoid
76306>>>>>>>    End_Procedure // DumpStatus
76307>>>>>>>
76307>>>>>>>
76307>>>>>>>
76307>>>>>>>    //***
76307>>>>>>>    //*** Procedure: ReadConfiguration
76307>>>>>>>    //*** Purpose  : Reset all driver level configurable attributes to the
76307>>>>>>>    //***            default value and then reread the configuration.
76307>>>>>>>    //***
76307>>>>>>>
76307>>>>>>>    Procedure ReadConfiguration
76309>>>>>>>        Local String  sVoid
76309>>>>>>>        Local String  sDriverID
76309>>>>>>>        Local Integer iVoid
76309>>>>>>>
76309>>>>>>>        Get psDriverID To sDriverID
76310>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_READCONFIGURATION Callback 0 Passing sVoid sVoid iVoid Result iVoid
76317>>>>>>>    End_Procedure // ReadConfiguration
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>
76318>>>>>>>    //***
76318>>>>>>>    //*** Function: TextToRIMValue
76318>>>>>>>    //*** Purpose : Convert a text to the corresponding
76318>>>>>>>    //***           Generate_Record_ID_Method attribute value
76318>>>>>>>    //***
76318>>>>>>>
76318>>>>>>>    Function TextToRIMValue String sText Returns Integer
76320>>>>>>>        If (sText = "None") ;            Function_return RIM_NONE
76323>>>>>>>        Else If (sText = "Identity Column") ;            Function_return RIM_IDENTITY_COLUMN
76327>>>>>>>        Else If (sText = "Dispenser Table") ;            Function_return RIM_DISPENSER_TABLE
76331>>>>>>>        Else If (sText = "External") ;            Function_return RIM_EXTERNAL
76335>>>>>>>    End_Function // TextToRIMValue
76336>>>>>>>
76336>>>>>>>
76336>>>>>>>
76336>>>>>>>    //***
76336>>>>>>>    //*** Function: RIMValueTotext
76336>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76336>>>>>>>    //***           corresponding text.
76336>>>>>>>    //***
76336>>>>>>>
76336>>>>>>>    Function RIMValueToText Integer iAttrValue Returns String
76338>>>>>>>        If (iAttrValue = RIM_NONE) ;            Function_return "None"
76341>>>>>>>        Else If (iAttrValue = RIM_IDENTITY_COLUMN) ;            Function_return "Identity Column"
76345>>>>>>>        Else If (iAttrValue = RIM_DISPENSER_TABLE) ;            Function_return "Dispenser Table"
76349>>>>>>>        Else If (iAttrValue = RIM_EXTERNAL) ;            Function_return "External"
76353>>>>>>>    End_Function // RIMValueToText
76354>>>>>>>
76354>>>>>>>
76354>>>>>>>
76354>>>>>>>    //***
76354>>>>>>>    //*** Function: TextToROValue
76354>>>>>>>    //*** Purpose : Convert a text to the corresponding
76354>>>>>>>    //***           Generate_Record_ID_Method attribute value
76354>>>>>>>    //***
76354>>>>>>>
76354>>>>>>>    Function TextToROValue String sText Returns Integer
76356>>>>>>>        If (sText = "No") ;            Function_return RO_NO
76359>>>>>>>        Else If (sText = "Ignore Change") ;            Function_return RO_IGNORECHANGE
76363>>>>>>>        Else If (sText = "Accept Change") ;            Function_return RO_ACCEPTCHANGE
76367>>>>>>>        Else If (sText = "Error On Change") ;            Function_return RO_ERRORONCHANGE
76371>>>>>>>    End_Function // TextToRIMValue
76372>>>>>>>
76372>>>>>>>
76372>>>>>>>
76372>>>>>>>    //***
76372>>>>>>>    //*** Function: ROValueTotext
76372>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76372>>>>>>>    //***           corresponding text.
76372>>>>>>>    //***
76372>>>>>>>
76372>>>>>>>    Function ROValueToText Integer iAttrValue Returns String
76374>>>>>>>        If (iAttrValue = RO_NO) ;            Function_return "No"
76377>>>>>>>        Else If (iAttrValue = RO_IGNORECHANGE) ;            Function_return "Ignore Change"
76381>>>>>>>        Else If (iAttrValue = RO_ACCEPTCHANGE) ;            Function_return "Accept Change"
76385>>>>>>>        Else If (iAttrValue = RO_ERRORONCHANGE) ;            Function_return "Error On Change"
76389>>>>>>>    End_Function // RIMValueToText
76390>>>>>>>
76390>>>>>>>
76390>>>>>>>
76390>>>>>>>    //***
76390>>>>>>>    //*** Function: LastDriverError
76390>>>>>>>    //*** Purpose : Return the text f the last error geneated by the driver.
76390>>>>>>>    //***
76390>>>>>>>
76390>>>>>>>    Function LastDriverError Returns String
76392>>>>>>>        Local String  sDriverID
76392>>>>>>>        Local String  sLastError
76392>>>>>>>        Local String  sLastErrorLength
76392>>>>>>>        Local Integer iLastErrorLength
76392>>>>>>>        Local Integer iVoid
76392>>>>>>>
76392>>>>>>>        //*** Initialize
76392>>>>>>>        Move "" To sLastError
76393>>>>>>>
76393>>>>>>>        Get psDriverID To sDriverID
76394>>>>>>>        If (sDriverID <> "") Begin
76396>>>>>>>            //*** Get the text of the last error
76396>>>>>>>            Move (Repeat(Character(" "), 14)) To sLastErrorlength
76397>>>>>>>            Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastErrorLength iVoid DRVR_LASTERRORTEXTLENGTH Result iVoid
76402>>>>>>>            Move (Left(sLastErrorLength, Pos(Character(0), sLastErrorLength) - 1)) To iLastErrorLength
76403>>>>>>>
76403>>>>>>>            If (iLastErrorLength > 0) Begin
76405>>>>>>>                Move (Repeat(Character(" "), iLastErrorLength + 1)) To sLastError
76406>>>>>>>                Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastError iVoid DRVR_LASTERRORTEXT Result iVoid
76411>>>>>>>                Move (Left(sLastError, Pos(Character(0), sLastError) - 1)) To sLastError
76412>>>>>>>            End
76412>>>>>>>>
76412>>>>>>>        End
76412>>>>>>>>
76412>>>>>>>
76412>>>>>>>        Function_Return sLastError
76413>>>>>>>    End_Function // LastDriverError
76414>>>>>>>
76414>>>>>>>
76414>>>>>>>
76414>>>>>>>    //***
76414>>>>>>>    //*** Function: EnumerateTables
76414>>>>>>>    //*** Purpose : Enumerate the tables in a database
76414>>>>>>>    //***
76414>>>>>>>
76414>>>>>>>    Function EnumerateTables String sLogin Returns Integer
76416>>>>>>>        Local String  sDriver
76416>>>>>>>        Local String  sVoid
76416>>>>>>>        Local Integer iNumTables
76416>>>>>>>        Local Integer iVoid
76416>>>>>>>
76416>>>>>>>        Get psDriverID To sDriver
76417>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_TABLES Callback 0 Passing sLogin sVoid iVoid Result iNumTables
76424>>>>>>>
76424>>>>>>>        Function_Return iNumTables
76425>>>>>>>    End_Function // EnumerateTables
76426>>>>>>>
76426>>>>>>>
76426>>>>>>>
76426>>>>>>>    //***
76426>>>>>>>    //*** Function: TableName
76426>>>>>>>    //*** Purpose : Returns the name of the table enumerated at the given position
76426>>>>>>>    //***
76426>>>>>>>
76426>>>>>>>    Function TableName Integer iIndex Returns String
76428>>>>>>>        Local String  sDriver
76428>>>>>>>        Local String  sTableName
76428>>>>>>>        Local String  sVoid
76428>>>>>>>        Local Integer iVoid
76428>>>>>>>
76428>>>>>>>        Get psDriverID To sDriver
76429>>>>>>>        If (sDriver <> "") Begin
76431>>>>>>>            Move (Repeat(" ", 255)) To sTableName
76432>>>>>>>            Call_driver 0 sDriver Function CLI_TABLENAME Callback 0 Passing sTableName sVoid iIndex Result iVoid
76437>>>>>>>        End
76437>>>>>>>>
76437>>>>>>>
76437>>>>>>>        Function_Return sTableName
76438>>>>>>>    End_Function // TableName
76439>>>>>>>
76439>>>>>>>
76439>>>>>>>
76439>>>>>>>    //***
76439>>>>>>>    //*** Function: SchemaName
76439>>>>>>>    //*** Purpose : Returns the name of the schema of the table enumerated at the given position
76439>>>>>>>    //***
76439>>>>>>>
76439>>>>>>>    Function SchemaName Integer iIndex Returns String
76441>>>>>>>        Local String  sDriver
76441>>>>>>>        Local String  sSchemaName
76441>>>>>>>        Local String  sVoid
76441>>>>>>>        Local Integer iVoid
76441>>>>>>>
76441>>>>>>>        Get psDriverID To sDriver
76442>>>>>>>        If (sDriver <> "") Begin
76444>>>>>>>            Move (Repeat(" ", 255)) To sSchemaName
76445>>>>>>>            Call_driver 0 sDriver Function CLI_TABLESCHEMA Callback 0 Passing sSchemaName sVoid iIndex Result iVoid
76450>>>>>>>        End
76450>>>>>>>>
76450>>>>>>>
76450>>>>>>>        Function_Return sSchemaName
76451>>>>>>>    End_Function // SchemaName
76452>>>>>>>
76452>>>>>>>
76452>>>>>>>
76452>>>>>>>    //***
76452>>>>>>>    //*** Function: TableType
76452>>>>>>>    //*** Purpose : Returns the type of the table enumerated at the given position.
76452>>>>>>>    //***           Types can be "TABLE", "VIEW", "SYSTEM TABLE", "GLOBAL TEMPORARY",
76452>>>>>>>    //***           "LOCAL TEMPORARY", "ALIAS", "SYNONYM"
76452>>>>>>>    //***
76452>>>>>>>
76452>>>>>>>    Function TableType Integer iIndex Returns String
76454>>>>>>>        Local String  sDriver
76454>>>>>>>        Local String  sTableType
76454>>>>>>>        Local String  sVoid
76454>>>>>>>        Local Integer iVoid
76454>>>>>>>
76454>>>>>>>        Get psDriverID To sDriver
76455>>>>>>>        If (sDriver <> "") Begin
76457>>>>>>>            Move (Repeat(" ", 25)) To sTableType
76458>>>>>>>            Call_driver 0 sDriver Function CLI_TABLETYPE Callback 0 Passing sTableType sVoid iIndex Result iVoid
76463>>>>>>>        End
76463>>>>>>>>
76463>>>>>>>
76463>>>>>>>        Function_Return sTableType
76464>>>>>>>    End_Function // TableType
76465>>>>>>>
76465>>>>>>>
76465>>>>>>>
76465>>>>>>>    //***
76465>>>>>>>    //*** Function: TableComment
76465>>>>>>>    //*** Purpose : Returns the comment of the table enumerated at the given position
76465>>>>>>>    //***
76465>>>>>>>
76465>>>>>>>    Function TableComment Integer iIndex Returns String
76467>>>>>>>        Local String  sDriver
76467>>>>>>>        Local String  sTableComment
76467>>>>>>>        Local String  sVoid
76467>>>>>>>        Local Integer iVoid
76467>>>>>>>
76467>>>>>>>        Get psDriverID To sDriver
76468>>>>>>>        If (sDriver <> "") Begin
76470>>>>>>>            Move (Repeat(" ", 255)) To sTableComment
76471>>>>>>>            Call_driver 0 sDriver Function CLI_TABLECOMMENT Callback 0 Passing sTableComment sVoid iIndex Result iVoid
76476>>>>>>>        End
76476>>>>>>>>
76476>>>>>>>
76476>>>>>>>        Function_Return sTableComment
76477>>>>>>>    End_Function // TableComment
76478>>>>>>>
76478>>>>>>>
76478>>>>>>>
76478>>>>>>>    //***
76478>>>>>>>    //*** Function: EnumerateColumns
76478>>>>>>>    //*** Purpose : Enumerate the columns in a table
76478>>>>>>>    //***
76478>>>>>>>
76478>>>>>>>    Function EnumerateColumns String sLogin String sTableName Returns Integer
76480>>>>>>>        Local String  sDriver
76480>>>>>>>        Local Integer iNumColumns
76480>>>>>>>        Local Integer iVoid
76480>>>>>>>
76480>>>>>>>        Get psDriverID To sDriver
76481>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_COLUMNS Callback 0 Passing sLogin sTablename iVoid Result iNumColumns
76488>>>>>>>
76488>>>>>>>        Function_Return iNumColumns
76489>>>>>>>    End_Function // EnumerateColumns
76490>>>>>>>
76490>>>>>>>
76490>>>>>>>
76490>>>>>>>    //***
76490>>>>>>>    //*** Function: ColumnName
76490>>>>>>>    //*** Purpose : Returns the name of the column enumerated at the given position
76490>>>>>>>    //***
76490>>>>>>>
76490>>>>>>>    Function ColumnName Integer iIndex Returns String
76492>>>>>>>        Local String  sDriver
76492>>>>>>>        Local String  sColumnName
76492>>>>>>>        Local String  sVoid
76492>>>>>>>        Local Integer iVoid
76492>>>>>>>
76492>>>>>>>        Get psDriverID To sDriver
76493>>>>>>>        If (sDriver <> "") Begin
76495>>>>>>>            Move (Repeat(" ", 255)) To sColumnName
76496>>>>>>>            Call_driver 0 sDriver Function CLI_COLUMNNAME Callback 0 Passing sColumnName sVoid iIndex Result iVoid
76501>>>>>>>        End
76501>>>>>>>>
76501>>>>>>>
76501>>>>>>>        Function_Return sColumnName
76502>>>>>>>    End_Function // ColumnName
76503>>>>>>>
76503>>>>>>>
76503>>>>>>>
76503>>>>>>>    //***
76503>>>>>>>    //*** Function: CLIDFDateToSQLDate
76503>>>>>>>    //*** Purpose : Convert a DataFlex date to a SQL date using the dummy zero date value.
76503>>>>>>>    //***
76503>>>>>>>
76503>>>>>>>    Function CLIDFDateToSQLDate String sDRiver Date dDFDate Returns String
76505>>>>>>>        Local String sSQLDate
76505>>>>>>>        Local Integer iOrgDateFmt
76505>>>>>>>        Local Integer iOrgDateSep
76505>>>>>>>
76505>>>>>>>        //*** Change date format to military, SQL dates are military dates
76505>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76508>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76511>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76514>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76517>>>>>>>
76517>>>>>>>        //*** We only need to convert if the date is 0
76517>>>>>>>        If (Integer(dDFDate = 0)) ;            CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sSQLDate
76526>>>>>>>        Else ;            Move dDFDate To sSQLDate
76528>>>>>>>
76528>>>>>>>        //*** Change date format back to original
76528>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76531>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76534>>>>>>>
76534>>>>>>>        Function_Return sSQLDate
76535>>>>>>>    End_Function // CLIDFDateToSQLDate
76536>>>>>>>
76536>>>>>>>
76536>>>>>>>
76536>>>>>>>    //***
76536>>>>>>>    //*** Function: CLISQLDateToDFDate
76536>>>>>>>    //*** Purpose : Convert a SQL date to a DataFlex date using the dummy zero date value.
76536>>>>>>>    //***
76536>>>>>>>
76536>>>>>>>    Function CLISQLDateToDFDate String sDRiver String sSQLDate Returns Date
76538>>>>>>>        Local Date dDFDate
76538>>>>>>>        Local String sDummyDateValue
76538>>>>>>>        Local Integer iOrgDateFmt
76538>>>>>>>        Local Integer iOrgDateSep
76538>>>>>>>
76538>>>>>>>        //*** Change date format to military, SQL dates are military dates
76538>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76541>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76544>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76547>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76550>>>>>>>
76550>>>>>>>        //*** We only need to convert if the date is the dummy zero date value
76550>>>>>>>        CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sDummyDateValue
76557>>>>>>>        If (sDummyDateValue = sSQLDate) ;            Move 0 To dDFDate
76560>>>>>>>        Else ;            Move sSQLDate To dDFDate
76562>>>>>>>
76562>>>>>>>        //*** Change date format back to original
76562>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76565>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76568>>>>>>>
76568>>>>>>>        Function_Return dDFDate
76569>>>>>>>    End_Function // CLISQLDateToDFDate
76570>>>>>>>
76570>>>>>>>
76570>>>>>>>
76570>>>>>>>    //***
76570>>>>>>>    //*** Function: RedirectConnection
76570>>>>>>>    //*** Purpose : Redirect an exisitng connection. The existing connection
76570>>>>>>>    //***           will point to another database but all tables will stay
76570>>>>>>>    //***           open!
76570>>>>>>>    //***
76570>>>>>>>
76570>>>>>>>    Function RedirectConnection String sOldConnection String sNewConnection Returns Integer
76572>>>>>>>        Local String  sDriver
76572>>>>>>>        Local String  sVoid
76572>>>>>>>        Local Integer iResult
76572>>>>>>>        Local Integer iVoid
76572>>>>>>>
76572>>>>>>>        Get psDriverID To sDriver
76573>>>>>>>        If (sDriver <> "") Begin
76575>>>>>>>            Call_driver 0 sDriver Function CLI_REDIRECTCONNECTION Callback 0 Passing sOldConnection sNewConnection iVoid Result iResult
76580>>>>>>>        End
76580>>>>>>>>
76580>>>>>>>        Function_Return iResult
76581>>>>>>>    End_Function // RedirectConnect
76582>>>>>>>
76582>>>>>>>
76582>>>>>>>
76582>>>>>>>    //***
76582>>>>>>>    //*** Function: CreateConnectionID
76582>>>>>>>    //*** Purpose : Create a DataFlex side connection id that can be used later on.
76582>>>>>>>    //***
76582>>>>>>>
76582>>>>>>>    Function CreateConnectionID String sID String sConnStr Integer iOpt Returns Integer
76584>>>>>>>        Local String  sDriver
76584>>>>>>>        Local Integer iResult
76584>>>>>>>        Local Integer iOptions
76584>>>>>>>
76584>>>>>>>        Get psDriverID to sDriver
76585>>>>>>>        If (Num_Arguments = 2) ;            Move 0 to iOptions
76588>>>>>>>        Else ;            Move iOpt to iOptions
76590>>>>>>>        If (sDriver <> "") Begin
76592>>>>>>>            Call_Driver 0 sDriver Function CLI_CREATECONNECTIONID Callback 0 Passing sID sConnStr iOptions Result iResult
76597>>>>>>>        End
76597>>>>>>>>
76597>>>>>>>        Function_Return iResult
76598>>>>>>>    End_Function // CreateConnectionID
76599>>>>>>>
76599>>>>>>>
76599>>>>>>>
76599>>>>>>>    //***
76599>>>>>>>    //*** Function: DeleteConnectionID
76599>>>>>>>    //*** Purpose : Delete a DataFlex side connection id.
76599>>>>>>>    //***
76599>>>>>>>
76599>>>>>>>    Function DeleteConnectionID String sID Integer iIndex Returns Integer
76601>>>>>>>        Local String  sDriver
76601>>>>>>>        Local Integer iResult
76601>>>>>>>        Local String sVoid
76601>>>>>>>
76601>>>>>>>        Get psDriverID To sDriver
76602>>>>>>>        If (sDriver <> "") Begin
76604>>>>>>>            Call_Driver 0 sDriver Function CLI_DELETECONNECTIONID Callback 0 Passing sID sVoid iIndex Result iResult
76609>>>>>>>        End
76609>>>>>>>>
76609>>>>>>>        Function_Return iResult
76610>>>>>>>    End_Function // DeleteConnectionID
76611>>>>>>>
76611>>>>>>>End_Class // cCLIHandler
76612>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 18.2\Pkg\DFBTRDRV.PKG)
76612>>>>>>>//****************************************************************************
76612>>>>>>>//
76612>>>>>>>// $File name  : DFBTRDRV.PKG
76612>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
76612>>>>>>>// Notice      : This package contains constants and commands, used to call
76612>>>>>>>//               specific functions in the DFBTRDRV.
76612>>>>>>>// $Author(s)  : Eddy Kleinjan
76612>>>>>>>//
76612>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
76612>>>>>>>// Created     : 01-07-97 @ 12:00:00
76612>>>>>>>//
76612>>>>>>>// Changed     : 04-04-2001.
76612>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
76612>>>>>>>//
76612>>>>>>>// Changed     : June 6, 2001
76612>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
76612>>>>>>>//
76612>>>>>>>//               Added DFBTR_DDF_OWNER command.
76612>>>>>>>//
76612>>>>>>>// Changed     : June 12, 2001
76612>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
76612>>>>>>>//
76612>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
76612>>>>>>>//
76612>>>>>>>// Changed     : August 4, 2004
76612>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
76612>>>>>>>//
76612>>>>>>>//               Added cDfbtrdrvHandler class.
76612>>>>>>>//               New functions in this class:
76612>>>>>>>//                  Function CKRevision Returns String
76612>>>>>>>//                  Function CkUsesUri Returns Integer
76612>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76612>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76612>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76612>>>>>>>//
76612>>>>>>>// Changed     : September 30, 2005
76612>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
76612>>>>>>>//
76612>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
76612>>>>>>>//****************************************************************************
76612>>>>>>>Use Ui
76612>>>>>>>//
76612>>>>>>>// Driver Indentification
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//*** Driver attributes
76612>>>>>>>//
76612>>>>>>>// Call_Driver functions ID's
76612>>>>>>>//
76612>>>>>>>//
76612>>>>>>>// DFBTRFN_CONVERT_FILE options
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// DFBTRFN_SET_OWNER options
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to create all vars which may be needed
76612>>>>>>>// in other commands.
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to set the owner of a Btrieve file.
76612>>>>>>>// File must have been opened.
76612>>>>>>>// Filenumber needs to be passed.
76612>>>>>>>// To clear set the owner to "".
76612>>>>>>>// Examples:
76612>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
76612>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
76612>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
76612>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
76612>>>>>>>// To clear:
76612>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to parse DFBTR_SET_OWNVER
76612>>>>>>>// options.
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to parse for Callback
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to clear the owner of a Btrieve file.
76612>>>>>>>// File must have been opened.
76612>>>>>>>// Filenumber needs to be passed.
76612>>>>>>>// Examples:
76612>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to add a owner name to the internal list of ownernames
76612>>>>>>>// which will be tries when opening files.
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to remove all owners from the internal list of ownernames
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to set the owner name to be used when opening the DDF files.
76612>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
76612>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
76612>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to change the transaction type.
76612>>>>>>>// Valid types are:
76612>>>>>>>//     DFBTRTT_NONE
76612>>>>>>>//     DFBTRTT_EXCLUSIVE
76612>>>>>>>//     DFBTRTT_CONCURRENT
76612>>>>>>>//
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to get the current transaction type.
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to set explicit_locking
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to get explicit locking
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//
76612>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
76612>>>>>>>//
76612>>>>>>>
76612>>>>>>>//*****************************************************************************
76612>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
76612>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76612>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
76612>>>>>>>//*****************************************************************************
76612>>>>>>>
76612>>>>>>>Class cDFBtrDrvHandler Is An Array
76613>>>>>>>
76613>>>>>>>    Procedure Construct_Object Integer iImage
76615>>>>>>>        Forward Send Construct_object iImage
76617>>>>>>>
76617>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
76618>>>>>>>    End_Procedure // Construct_Object
76619>>>>>>>
76619>>>>>>>
76619>>>>>>>
76619>>>>>>>    //***
76619>>>>>>>    //*** Function: CKRevsion
76619>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
76619>>>>>>>    //***
76619>>>>>>>
76619>>>>>>>    Function CKRevision Returns String
76621>>>>>>>        Local String  sDriverID
76621>>>>>>>        Local String  sRevision
76621>>>>>>>        Local String  sVoid
76621>>>>>>>        Local Integer iRetval
76621>>>>>>>
76621>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76621>>>>>>>        // This error would otherwise be raised when we have an older
76621>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76621>>>>>>>        Send Ignore_error To Error_object_Id 20491
76622>>>>>>>        Get psDriverID To sDriverID
76623>>>>>>>        Move (Repeat(" ", 255)) To sRevision
76624>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76629>>>>>>>        Send Trap_Error To Error_object_Id 20491
76630>>>>>>>        If (Trim(sRevision) = "") Begin
76632>>>>>>>            // Unable to get the revision. return all zeroes.
76632>>>>>>>            Move "0.0.0.0" To sRevision
76633>>>>>>>        End
76633>>>>>>>>
76633>>>>>>>        Function_Return sRevision
76634>>>>>>>    End_Function // CKRevision
76635>>>>>>>
76635>>>>>>>    Function CkUsesUri Returns Integer
76637>>>>>>>        Local String  sDriverID
76637>>>>>>>        Local String  sVoid1
76637>>>>>>>        Local String  sVoid2
76637>>>>>>>        Local Integer iRetval
76637>>>>>>>
76637>>>>>>>        Get psDriverID To sDriverID
76638>>>>>>>
76638>>>>>>>        Move 0 To iRetval
76639>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76639>>>>>>>        // This error would otherwise be raised when we have an older
76639>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
76639>>>>>>>        Send Ignore_error To Error_object_Id 20491
76640>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
76645>>>>>>>        Send Trap_Error To Error_object_Id 20491
76646>>>>>>>
76646>>>>>>>        Function_Return iRetval
76647>>>>>>>    End_Function // CKUsesUri
76648>>>>>>>
76648>>>>>>>
76648>>>>>>>
76648>>>>>>>    //***
76648>>>>>>>    //*** Function: ExtractPartFromRevsion
76648>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76648>>>>>>>    //***
76648>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76648>>>>>>>    //***
76648>>>>>>>
76648>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76650>>>>>>>        Local Integer iPartRev
76650>>>>>>>        Local Integer iCurrentPart
76650>>>>>>>        Local Integer iSeparatorPos
76650>>>>>>>
76650>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76653>>>>>>>
76653>>>>>>>        Move 0 To iCurrentPart
76654>>>>>>>        Repeat
76654>>>>>>>>
76654>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76655>>>>>>>            If (iSeparatorPos > 0) Begin
76657>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76658>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76659>>>>>>>                Increment iCurrentPart
76660>>>>>>>            End
76660>>>>>>>>
76660>>>>>>>            Else If (sRevision <> "") Begin
76663>>>>>>>                Move sRevision To iPartRev
76664>>>>>>>                Move "" To sRevision
76665>>>>>>>                Increment iCurrentPart
76666>>>>>>>            End
76666>>>>>>>>
76666>>>>>>>            Else ;                Move -1 To iPartRev
76668>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76670>>>>>>>
76670>>>>>>>        Function_Return iPartRev
76671>>>>>>>    End_Function // EcxtractPartFromRevision
76672>>>>>>>
76672>>>>>>>
76672>>>>>>>
76672>>>>>>>    //***
76672>>>>>>>    //*** Function: CKMajorRevision
76672>>>>>>>    //*** Purpose : Returns the major revision of the CK
76672>>>>>>>    //***
76672>>>>>>>
76672>>>>>>>    Function CKMajorRevision Returns Integer
76674>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76675>>>>>>>    End_Function // CKMajorRevision
76676>>>>>>>
76676>>>>>>>
76676>>>>>>>
76676>>>>>>>    //***
76676>>>>>>>    //*** Function: CKMinorRevision
76676>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76676>>>>>>>    //***
76676>>>>>>>
76676>>>>>>>    Function CKMinorRevision Returns Integer
76678>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76679>>>>>>>    End_Function // CKMinorRevision
76680>>>>>>>
76680>>>>>>>
76680>>>>>>>
76680>>>>>>>    //***
76680>>>>>>>    //*** Function: CKReleaseRevision
76680>>>>>>>    //*** Purpose : Returns the release revision of the CK
76680>>>>>>>    //***
76680>>>>>>>
76680>>>>>>>    Function CKReleaseRevision Returns Integer
76682>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76683>>>>>>>    End_Function // CKReleaseRevision
76684>>>>>>>
76684>>>>>>>
76684>>>>>>>
76684>>>>>>>    //***
76684>>>>>>>    //*** Function: CKBuildRevision
76684>>>>>>>    //*** Purpose : Returns the major revision of the CK
76684>>>>>>>    //***
76684>>>>>>>
76684>>>>>>>    Function CKBuildRevision Returns Integer
76686>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76687>>>>>>>    End_Function // CKBuildRevision
76688>>>>>>>
76688>>>>>>>
76688>>>>>>>
76688>>>>>>>    //***
76688>>>>>>>    //*** Function: IsMinimalRevision
76688>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76688>>>>>>>    //***
76688>>>>>>>
76688>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76690>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76693>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76696>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76699>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76702>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76705>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76709>>>>>>>            End
76709>>>>>>>>
76709>>>>>>>        End
76709>>>>>>>>
76709>>>>>>>
76709>>>>>>>        Function_Return (FALSE)
76710>>>>>>>    End_Function // IsMinimalRevision
76711>>>>>>>
76711>>>>>>>    //   Functions to query the Pervasive.SQL version:
76711>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
76711>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
76711>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
76711>>>>>>>    //
76711>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
76711>>>>>>>    //   in the following format:
76711>>>>>>>    //       <version>.<revision>.<type>
76711>>>>>>>    //   possible values for <type>:
76711>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
76711>>>>>>>    //         server using Workgroup authentication mode
76711>>>>>>>    //       C for client cache engine
76711>>>>>>>    //       D for DOS workstation
76711>>>>>>>    //       N for client Requester
76711>>>>>>>    //       S for NetWare server
76711>>>>>>>    //       T for 32-bit Windows server engine
76711>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
76711>>>>>>>    //
76711>>>>>>>    //   example:
76711>>>>>>>    //       8.50.T
76711>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
76711>>>>>>>    //   32-bits Windows server.
76711>>>>>>>    //
76711>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
76711>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
76711>>>>>>>    //
76711>>>>>>>    //   If the version information is not available or can not be obtained
76711>>>>>>>    //   the functions will return "0.0.0"
76711>>>>>>>
76711>>>>>>>
76711>>>>>>>    //***
76711>>>>>>>    //*** Function: PSQLRequesterVersionInfo
76711>>>>>>>    //*** Purpose : Returns the version information of the
76711>>>>>>>    //***           Pervasive.SQL Client requester.
76711>>>>>>>
76711>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76713>>>>>>>
76713>>>>>>>        Local String  sDriverID
76713>>>>>>>        Local String  sVersion
76713>>>>>>>        Local String  sVoid
76713>>>>>>>        Local Integer iRetval
76713>>>>>>>
76713>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76713>>>>>>>        // This error would otherwise be raised when we have an older
76713>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76713>>>>>>>        Send Ignore_error To Error_object_Id 20491
76714>>>>>>>        Get psDriverID To sDriverID
76715>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76716>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76721>>>>>>>        Send Trap_Error To Error_object_Id 20491
76722>>>>>>>        If (Trim(sVersion) = "") Begin
76724>>>>>>>            // Unable to get the revision. return all zeroes.
76724>>>>>>>            Move "0.0.0" To sVersion
76725>>>>>>>        End
76725>>>>>>>>
76725>>>>>>>        Function_Return sVersion
76726>>>>>>>    End_Function //  PSQLRequesterVersion
76727>>>>>>>
76727>>>>>>>    //***
76727>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
76727>>>>>>>    //*** Purpose : Returns the version information of the
76727>>>>>>>    //***           Pervasive.SQL Local Engine
76727>>>>>>>
76727>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76729>>>>>>>
76729>>>>>>>        Local String  sDriverID
76729>>>>>>>        Local String  sVersion
76729>>>>>>>        Local String  sVoid
76729>>>>>>>        Local Integer iRetval
76729>>>>>>>
76729>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76729>>>>>>>        // This error would otherwise be raised when we have an older
76729>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76729>>>>>>>        Send Ignore_error To Error_object_Id 20491
76730>>>>>>>        Get psDriverID To sDriverID
76731>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76732>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76737>>>>>>>        Send Trap_Error To Error_object_Id 20491
76738>>>>>>>        If (Trim(sVersion) = "") Begin
76740>>>>>>>            // Unable to get the revision. return all zeroes.
76740>>>>>>>            Move "0.0.0" To sVersion
76741>>>>>>>        End
76741>>>>>>>>
76741>>>>>>>        Function_Return sVersion
76742>>>>>>>    End_Function //  PSQLLocalEngineVersion
76743>>>>>>>
76743>>>>>>>    //***
76743>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
76743>>>>>>>    //*** Purpose : Returns the version information of the
76743>>>>>>>    //***           Pervasive.SQL Server Engine
76743>>>>>>>
76743>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76745>>>>>>>
76745>>>>>>>        Local String  sDriverID
76745>>>>>>>        Local String  sVersion
76745>>>>>>>        Local String  sVoid
76745>>>>>>>        Local Integer iRetval
76745>>>>>>>
76745>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76745>>>>>>>        // This error would otherwise be raised when we have an older
76745>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76745>>>>>>>        Send Ignore_error To Error_object_Id 20491
76746>>>>>>>        Get psDriverID To sDriverID
76747>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76748>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76753>>>>>>>        Send Trap_Error To Error_object_Id 20491
76754>>>>>>>        If (Trim(sVersion) = "") Begin
76756>>>>>>>            // Unable to get the revision. return all zeroes.
76756>>>>>>>            Move "0.0.0" To sVersion
76757>>>>>>>        End
76757>>>>>>>>
76757>>>>>>>        Function_Return sVersion
76758>>>>>>>    End_Function //  PSQLServerEngineVersion
76759>>>>>>>
76759>>>>>>>End_Class // cDfbtrdrvHandler
76760>>>>>>>
76760>>>>>
76760>>>>>
76760>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
76761>>>>>
76761>>>>>Register_Function phoWorkspace Returns Handle
76761>>>>>Register_Function Help_filename Returns String
76761>>>>>Register_Function GetHelpFile Returns String
76761>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
76761>>>>>
76761>>>>>//****************************************************************************
76761>>>>>// $Module type: FUNCTION
76761>>>>>// $Module name: Network_User_Name
76761>>>>>// $Author     : AK/VOO/KCR
76761>>>>>// Created     : 09-24-96 @ 19:17
76761>>>>>//
76761>>>>>// Description
76761>>>>>//    This function reads the current username Of windows and returns that
76761>>>>>//    name or an text unknown user
76761>>>>>//
76761>>>>>// $Rev History
76761>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
76761>>>>>//  07/25/2003  Replaced obsolete code
76761>>>>>//  09/24/1996  Module header created
76761>>>>>//****************************************************************************
76761>>>>>Function Network_User_Name for cDesktop Returns String
76763>>>>>    String sName
76763>>>>>    Integer iRetval iLength
76763>>>>>
76763>>>>>    Move 0 to iLength
76764>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
76765>>>>>    ZeroString iLength to sName
76766>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
76767>>>>>
76767>>>>>    If (iRetval = NO_ERROR) Begin
76769>>>>>        Function_Return (CString (sName))
76770>>>>>    End
76770>>>>>>
76770>>>>>    
76770>>>>>    Function_Return "User Unknown"
76771>>>>>End_Function
76772>>>>>
76772>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
76772>>>>>Type MEMORYSTATUS
76772>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
76772>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
76772>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
76772>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
76772>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
76772>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
76772>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
76772>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
76772>>>>>End_Type // MEMORYSTATUS
76772>>>>>
76772>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
76773>>>>>
76773>>>>>Struct tWinMemoryStatusEx
76773>>>>>    UInteger dwLength                
76773>>>>>    UInteger dwMemoryLoad          
76773>>>>>    UBigInt ullTotalPhys           
76773>>>>>    UBigInt ullAvailPhys           
76773>>>>>    UBigInt ullTotalPageFile       
76773>>>>>    UBigInt ullAvailPageFile       
76773>>>>>    UBigInt ullTotalVirtual        
76773>>>>>    UBigInt ullAvailVirtual        
76773>>>>>    UBigInt ullAvailExtendedVirtual
76773>>>>>End_Struct
76773>>>>>
76773>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
76774>>>>>
76774>>>>>Class SysinfoDisplay is a cTextEdit
76775>>>>>    Procedure Construct_Object
76777>>>>>        Forward Send Construct_Object
76779>>>>>
76779>>>>>        Set Location To 6 6
76780>>>>>        Set Size To 110 255
76781>>>>>        Set Read_Only_State To True
76782>>>>>        Set pbWrap to False
76783>>>>>    End_Procedure
76784>>>>>
76784>>>>>    //****************************************************************************
76784>>>>>    // $Module type: PROCEDURE
76784>>>>>    // $Module name: Show_Current_Directory
76784>>>>>    // $Author     : VOO
76784>>>>>    // Created     : 06-10-96 @ 15:24
76784>>>>>    //
76784>>>>>    // Description
76784>>>>>    //    This method will show the name Of the current directory in the system
76784>>>>>    //    information box
76784>>>>>    //
76784>>>>>    // $Rev History
76784>>>>>    //    06-10-96  Module header created
76784>>>>>    //****************************************************************************
76784>>>>>    Procedure Show_Current_Directory
76786>>>>>        String sDir
76786>>>>>
76786>>>>>        Get_Current_Directory To sDir
76787>>>>>
76787>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
76788>>>>>    End_Procedure
76789>>>>>
76789>>>>>    Procedure Show_Windows_Directory
76791>>>>>        String sWindir
76791>>>>>
76791>>>>>        Get_Windows_Directory To sWindir
76792>>>>>
76792>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
76793>>>>>    End_Procedure
76794>>>>>
76794>>>>>    Procedure Show_Current_User
76796>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
76797>>>>>    End_Procedure
76798>>>>>
76798>>>>>    Procedure Show_Number_Format
76800>>>>>        Integer iFormat
76800>>>>>        String sFormatText
76800>>>>>
76800>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
76803>>>>>        Move (Character (iFormat)) To sFormatText
76804>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
76805>>>>>
76805>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
76808>>>>>        Move (Character (iFormat)) to sFormatText
76809>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
76810>>>>>    End_Procedure
76811>>>>>
76811>>>>>    Procedure Show_Filelist_Name
76813>>>>>        String sFilename
76813>>>>>
76813>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
76816>>>>>
76816>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
76817>>>>>        Send AppendTextLn ""
76818>>>>>    End_Procedure
76819>>>>>
76819>>>>>    Procedure Show_Lock_Delay
76821>>>>>        Integer iLockdelay
76821>>>>>
76821>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
76824>>>>>
76824>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
76825>>>>>    End_Procedure
76826>>>>>
76826>>>>>    Procedure Show_Lock_Timeout
76828>>>>>        Integer iLockTimeout
76828>>>>>
76828>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
76831>>>>>
76831>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
76832>>>>>    End_Procedure
76833>>>>>
76833>>>>>    Procedure Show_Screen_Size
76835>>>>>        Integer iYscreensize iXscreensize
76835>>>>>
76835>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
76836>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
76837>>>>>
76837>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
76838>>>>>    End_Procedure
76839>>>>>
76839>>>>>    Procedure Show_Page_Size
76841>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
76842>>>>>    End_procedure
76843>>>>>
76843>>>>>    Procedure Show_Date
76845>>>>>        Date dToday
76845>>>>>
76845>>>>>        Sysdate dToday
76846>>>>>
76846>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
76847>>>>>    End_procedure
76848>>>>>
76848>>>>>    Procedure Show_Date_Format
76850>>>>>        Integer iDateFormat
76850>>>>>        String sDateFormat
76850>>>>>
76850>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
76853>>>>>        Case Begin
76853>>>>>            Case (iDateFormat = DF_DATE_USA)
76855>>>>>                Move C_$USA To sDateFormat
76856>>>>>                Case Break
76857>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
76860>>>>>                Move C_$European To sDateFormat
76861>>>>>                Case Break
76862>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
76865>>>>>                Move C_$Military To sDateFormat
76866>>>>>                Case Break
76867>>>>>            Case Else
76867>>>>>                Move C_$UnknownDateType To sDateFormat
76868>>>>>                Case Break
76869>>>>>        Case End
76869>>>>>
76869>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
76870>>>>>    End_Procedure
76871>>>>>
76871>>>>>    Procedure Show_Systemresources
76873>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76873>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76873>>>>>        Integer iRetval
76873>>>>>
76873>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
76874>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
76875>>>>>        If (iRetval = 0) Begin
76877>>>>>            Move (ShowLastError ()) to iRetval
76878>>>>>        End
76878>>>>>>
76878>>>>>
76878>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
76879>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
76880>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
76881>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
76882>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
76883>>>>>    End_Procedure
76884>>>>>
76884>>>>>    Procedure Show_Registration
76886>>>>>        String sRegName
76886>>>>>        Integer iSN iMaxUsers
76886>>>>>
76886>>>>>        Registration sRegName iSN
76887>>>>>>
76887>>>>>        
76887>>>>>        Get_Licensed_Max_Users to iMaxUsers
76888>>>>>
76888>>>>>        Send AppendTextLn ""
76889>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
76890>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
76891>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
76892>>>>>    End_Procedure
76893>>>>>
76893>>>>>    //****************************************************************************
76893>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
76893>>>>>    // To the workspace object passing the an object and message To send back
76893>>>>>    // To this object. It is expected that the workspace object will send this
76893>>>>>    // message for every line Of information it wants displayed (passing the
76893>>>>>    // information To be displayed
76893>>>>>    //****************************************************************************
76893>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
76893>>>>>
76893>>>>>    Procedure Show_ServicePack
76895>>>>>        String sKey sVersionDescription sVersion 
76895>>>>>        Handle hoRegistry
76895>>>>>        Boolean bExists bOpened
76895>>>>>        
76895>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
76896>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
76897>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
76898>>>>>
76898>>>>>        Move C_DFVersionRegistryRoot to sKey
76899>>>>>        Get KeyExists of hoRegistry sKey to bExists
76900>>>>>        If (bExists) Begin
76902>>>>>            Get OpenKey of hoRegistry sKey to bOpened
76903>>>>>            If (bOpened) Begin
76905>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
76906>>>>>                If (bExists) Begin
76908>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
76909>>>>>                End
76909>>>>>>
76909>>>>>                
76909>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
76910>>>>>                If (bExists) Begin
76912>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
76913>>>>>                End                
76913>>>>>>
76913>>>>>                Send CloseKey of hoRegistry
76914>>>>>            End
76914>>>>>>
76914>>>>>        End
76914>>>>>>
76914>>>>>        Send Destroy of hoRegistry
76915>>>>>
76915>>>>>        If (sVersionDescription <> "") Begin
76917>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
76918>>>>>           Send AppendTextLn ""
76919>>>>>        End
76919>>>>>>
76919>>>>>    End_Procedure
76920>>>>>    
76920>>>>>
76920>>>>>    Procedure Show_WorkspaceInformation
76922>>>>>        Integer hoWorkspace
76922>>>>>
76922>>>>>        If (ghoApplication <> 0) Begin
76924>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
76925>>>>>            If (hoWorkspace <> 0) Begin
76927>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
76928>>>>>                Send AppendTextLn ""
76929>>>>>            End
76929>>>>>>
76929>>>>>        End
76929>>>>>>
76929>>>>>    End_Procedure
76930>>>>>
76930>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
76932>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
76933>>>>>    End_Function
76934>>>>>
76934>>>>>    Procedure Show_Versions
76936>>>>>        Integer iVersion iRevision iBuild
76936>>>>>
76936>>>>>        Version_Information iVersion iRevision iBuild
76938>>>>>
76938>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
76939>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
76940>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
76941>>>>>    End_Procedure
76942>>>>>    
76942>>>>>    Function CKRevisionNumber String sDriverID Returns String
76944>>>>>        Handle hoCLIHandler
76944>>>>>        Handle hoDFBtrDrvHandler
76944>>>>>        String sCKRevision
76944>>>>>
76944>>>>>
76944>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
76946>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
76947>>>>>            Set psDriverID of hoCLIHandler to sDriverID
76948>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
76949>>>>>            Send Destroy of hoCLIHandler
76950>>>>>        End
76950>>>>>>
76950>>>>>        Else Begin
76951>>>>>            If (sDriverID = "DFBTRDRV") Begin
76953>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
76954>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
76955>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
76956>>>>>                Send Destroy of hoDFBtrDrvHandler
76957>>>>>            End
76957>>>>>>
76957>>>>>        End
76957>>>>>>
76957>>>>>        
76957>>>>>        Function_Return sCKRevision
76958>>>>>    End_Function
76959>>>>>    
76959>>>>>    
76959>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
76961>>>>>        
76961>>>>>        If (sDriverID = "DATAFLEX") Begin
76963>>>>>            Function_Return False
76964>>>>>        End
76964>>>>>>
76964>>>>>    
76964>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
76965>>>>>    End_Function    
76966>>>>>
76966>>>>>
76966>>>>>    //***
76966>>>>>    //*** BW
76966>>>>>    //*** Procedure: Show_Drivers
76966>>>>>    //*** Purpose  : Show loaded database drivers
76966>>>>>    //***
76966>>>>>
76966>>>>>    Procedure Show_Drivers
76968>>>>>        String sCurrentDriver sRevNumber
76968>>>>>        String sLoadedDrivers
76968>>>>>        Integer iNumberOfDrivers iCount
76968>>>>>        Boolean bOK
76968>>>>>
76968>>>>>        Move "" To sLoadedDrivers
76969>>>>>        Get_Attribute DF_NUMBER_DRIVERS To iNumberOfDrivers
76972>>>>>        For iCount From 1 To iNumberOfDrivers
76978>>>>>>
76978>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
76981>>>>>            If (sLoadedDrivers <> "") Begin
76983>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
76984>>>>>            End
76984>>>>>>
76984>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
76985>>>>>            If (bOK) Begin
76987>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
76988>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
76989>>>>>            End
76989>>>>>>
76989>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) To sLoadedDrivers
76990>>>>>        Loop
76991>>>>>>
76991>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
76992>>>>>    End_Procedure
76993>>>>>
76993>>>>>    Procedure Show_HelpFile
76995>>>>>        String sHelpFile
76995>>>>>        Integer eHelpType
76995>>>>>
76995>>>>>        If (ghoApplication <> 0) Begin
76997>>>>>            Get peHelpType Of ghoApplication To eHelpType
76998>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
77000>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
77001>>>>>            End
77001>>>>>>
77001>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
77004>>>>>                Get Help_filename Of Help_object_id To sHelpFile
77005>>>>>            End
77005>>>>>>
77005>>>>>            Else Begin
77006>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
77007>>>>>            End
77007>>>>>>
77007>>>>>
77007>>>>>            Send AppendTextLn ""
77008>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
77009>>>>>        End
77009>>>>>>
77009>>>>>    End_Procedure
77010>>>>>
77010>>>>>    Procedure Show_EnterAsTab
77012>>>>>        Boolean bEnterKeyAsTabKey
77012>>>>>        String sText
77012>>>>>
77012>>>>>        If (ghoApplication <> 0) Begin
77014>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
77015>>>>>            If (bEnterKeyAsTabKey) Begin
77017>>>>>                Move "True" To sText
77018>>>>>            End
77018>>>>>>
77018>>>>>            Else Begin
77019>>>>>                Move "False" To sText
77020>>>>>            End
77020>>>>>>
77020>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
77021>>>>>        End
77021>>>>>>
77021>>>>>    End_Procedure
77022>>>>>
77022>>>>>    //****************************************************************************
77022>>>>>    // $Module type: PROCEDURE
77022>>>>>    // $Module name: Add_Focus
77022>>>>>    // $Author     : VOO
77022>>>>>    // Created     : 24-09-96 @ 19:43
77022>>>>>    //
77022>>>>>    // Description
77022>>>>>    //    During activation we will remove the old information and add the newly
77022>>>>>    //    found systeminformation
77022>>>>>    //
77022>>>>>    // $Rev History
77022>>>>>    //    24-09-96  Module header created
77022>>>>>    //****************************************************************************
77022>>>>>    Procedure Add_Focus Integer hoRoot
77024>>>>>        Forward Send Add_Focus hoRoot
77026>>>>>
77026>>>>>        Send Delete_Data
77027>>>>>
77027>>>>>        Set Changed_State To False
77028>>>>>        Set Read_Only_State To True
77029>>>>>
77029>>>>>        Send Show_ServicePack
77030>>>>>        Send Show_Versions   
77031>>>>>        Send Show_Drivers         
77032>>>>>        Send Show_HelpFile
77033>>>>>        Send Show_Current_Directory
77034>>>>>        Send Show_Filelist_Name          
77035>>>>>        If (ghoApplication <> 0) Begin
77037>>>>>            Send Show_WorkSpaceInformation // added To show WS info
77038>>>>>        End
77038>>>>>>
77038>>>>>        Send Show_Current_User 
77039>>>>>        Send Show_Windows_Directory 
77040>>>>>        Send Show_Screen_Size
77041>>>>>        Send Show_Page_Size
77042>>>>>        Send Show_EnterAsTab        
77043>>>>>        Send Show_Number_Format
77044>>>>>        Send Show_Date_Format
77045>>>>>        Send Show_Lock_Delay
77046>>>>>        Send Show_Lock_Timeout
77047>>>>>        Send Show_Date
77048>>>>>        Send Show_Systemresources
77049>>>>>        Send Show_Registration
77050>>>>>        Send Beginning_of_Data
77051>>>>>
77051>>>>>        Set Icon to 'default.ico'
77052>>>>>    End_Procedure
77053>>>>>End_Class
77054>>>>>
77054>>>>>//****************************************************************************
77054>>>>>// $Module type: OBJECT
77054>>>>>// $Module name: Sysinfo_Dialog
77054>>>>>// $Author     : VOO
77054>>>>>// Created     : 24-09-96 @ 18:47
77054>>>>>//
77054>>>>>// Description
77054>>>>>//    This object shows the systeminformation on the screen
77054>>>>>//
77054>>>>>// $Rev History
77054>>>>>//    24-09-96  Module header created
77054>>>>>//****************************************************************************
77054>>>>>Class SysInfoDialog Is A ModalPanel
77055>>>>>    Procedure Construct_Object
77057>>>>>        Forward Send Construct_Object
77059>>>>>
77059>>>>>        Set Label to C_$SystemInformation
77060>>>>>        Set Size to 140 267
77061>>>>>        Set piMinSize to 140 267
77062>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77063>>>>>        Set Border_Style to Border_Thick
77064>>>>>
77064>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
77066>>>>>            Set peAnchors to anAll
77067>>>>>        End_Object
77068>>>>>
77068>>>>>        Object oCloseButton Is A Button
77070>>>>>            Set Label To C_$Close
77071>>>>>            Set Location To 120 210
77072>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
77073>>>>>            Set Default_State To True
77074>>>>>            Set peAnchors to anBottomRight
77075>>>>>        End_Object
77076>>>>>
77076>>>>>        On_Key kCancel Send Close_Panel
77077>>>>>    End_Procedure
77078>>>>>End_Class
77079>>>>>
77079>>>>>// Purpose:
77079>>>>>//
77079>>>>>// Ken Ross 12/17/96 5:16PM
77079>>>>>//
77079>>>>>Class AboutDialog Is A ModalPanel
77080>>>>>    Procedure Construct_Object
77082>>>>>        String sVdfRootDir
77082>>>>>
77082>>>>>        Forward Send Construct_Object
77084>>>>>
77084>>>>>        Set Label To C_$About
77085>>>>>        Set Size to 89 212
77086>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77087>>>>>
77087>>>>>        Object oSysInfoDialog Is A SysInfoDialog
77089>>>>>        End_Object
77090>>>>>
77090>>>>>        Object oBox Is A Container3d
77092>>>>>            Set Border_Style To Border_StaticEdge
77093>>>>>            Set Size to 63 202
77094>>>>>            Set Location To 4 5
77095>>>>>
77095>>>>>            Object oAboutGraphic Is A BitmapContainer
77097>>>>>                Set Border_Style To Border_None
77098>>>>>                Set Bitmap_Style To Bitmap_Center
77099>>>>>                Set Size To 48 48
77100>>>>>                Set Location To 7 2
77101>>>>>            End_Object
77102>>>>>
77102>>>>>            Object oProductName Is A TextBox
77104>>>>>                Set Label To C_$ProductName
77105>>>>>                Set Size To 10 45
77106>>>>>                Set Location To 8 53
77107>>>>>            End_Object
77108>>>>>
77108>>>>>            Object oVersion Is A TextBox
77110>>>>>                Set Label To C_$Version
77111>>>>>                Set Size To 10 25
77112>>>>>                Set Location To 21 53
77113>>>>>            End_Object
77114>>>>>
77114>>>>>            Object oCopyright Is A TextBox
77116>>>>>                Set Label To C_$Copyright
77117>>>>>                Set Size To 10 31
77118>>>>>                Set Location To 34 53
77119>>>>>            End_Object
77120>>>>>
77120>>>>>            Object oAuthor Is A TextBox
77122>>>>>                Set Label To C_$Author
77123>>>>>                Set Size To 10 22
77124>>>>>                Set Location To 46 53
77125>>>>>            End_Object
77126>>>>>        End_Object
77127>>>>>
77127>>>>>        Object oOKButton Is A Button
77129>>>>>            On_Item C_$OK Send Close_Panel
77130>>>>>            Set Size To 14 50
77131>>>>>            Set Location To 71 157
77132>>>>>        End_Object
77133>>>>>
77133>>>>>        Object oSysInfoButton Is A Button
77135>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
77136>>>>>            Set Size To 14 50
77137>>>>>            Set Location To 71 101
77138>>>>>        End_Object
77139>>>>>
77139>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
77140>>>>>
77140>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
77141>>>>>    End_Procedure
77142>>>>>
77142>>>>>    Procedure Set ProductName String sProductName
77144>>>>>        Set Label Of oProductName To sProductName
77145>>>>>    End_Procedure
77146>>>>>
77146>>>>>    Procedure Set Version String sVersion
77148>>>>>        Set Label Of oVersion To sVersion
77149>>>>>    End_Procedure
77150>>>>>
77150>>>>>    Procedure Set Copyright string sCopyright
77152>>>>>        Set Label Of oCopyright To sCopyright
77153>>>>>    End_Procedure
77154>>>>>
77154>>>>>    Procedure Set Author String sAuthor
77156>>>>>        Set Label Of oAuthor To sAuthor
77157>>>>>    End_Procedure
77158>>>>>
77158>>>>>    Procedure Set Logo string sLogo
77160>>>>>        // square bitmaps Of 42x42 work best
77160>>>>>        Set Bitmap Of oAboutGraphic To sLogo
77161>>>>>    End_Procedure
77162>>>>>
77162>>>>>    Procedure Show_Sysinfo
77164>>>>>        Send Popup_Modal Of oSysinfoDialog
77165>>>>>    End_Procedure
77166>>>>>
77166>>>>>    Procedure End_Construct_Object
77168>>>>>        Handle hoVersionInfo
77168>>>>>        Boolean bIncluded
77168>>>>>        Integer iMajor iMinor iRelease iBuild
77168>>>>>        String sLabel
77168>>>>>
77168>>>>>        Get Label Of oVersion To sLabel
77169>>>>>        If (sLabel = C_$VERSION) Begin
77171>>>>>            // set it To the version info Of the program, if available
77171>>>>>            If (ghoApplication <> 0) Begin
77173>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
77174>>>>>                If (hoVersionInfo <> 0) Begin
77176>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
77177>>>>>                    If (bIncluded) Begin
77179>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
77180>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
77181>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
77182>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
77183>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
77184>>>>>                        Set Version to sLabel
77185>>>>>                    End
77185>>>>>>
77185>>>>>                End
77185>>>>>>
77185>>>>>            End
77185>>>>>>
77185>>>>>        End
77185>>>>>>
77185>>>>>
77185>>>>>        Forward Send End_Construct_Object
77187>>>>>    End_Procedure
77188>>>>>End_Class
77189>>>
77189>>>// *************************************************************************
77189>>>//  Public message. This is the default message. It is expected that you will
77189>>>//   create your own message to override this
77189>>>// *************************************************************************
77189>>>
77189>>>Procedure Activate_About
77192>>>   Send DoAbout "" "" "" "" ""
77193>>>End_Procedure
77194>>>
77194>>>// *************************************************************************
77194>>>//  Public message. It is expected that you will send this message (most
77194>>>//  likely from Activate_About. This creates an about object, activates it
77194>>>//  and destroys it when done. It is not exepected that you will augment this.
77194>>>// *************************************************************************
77194>>>
77194>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
77197>>>        integer hoObj hoMain
77197>>>
77197>>>        // create object
77197>>>        Object About is an AboutDialog
77199>>>            // if no title passed use the label of the main panel
77199>>>            // (if a main panel exists).
77199>>>            if sTitle     eq '' Begin
77201>>>                Get Main_Window of desktop to hoMain
77202>>>                if hoMain Get Label of hoMain to sTitle
77205>>>            end
77205>>>>
77205>>>            set productname to sTitle
77206>>>            set version     to sVersion
77207>>>            set copyright   to sCopyRight
77208>>>            set author      to sAuthor
77209>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
77212>>>            Move self to hoObj // object Id
77213>>>        End_Object
77214>>>        Send Popup   of hoObj    // popup the about object
77215>>>        Send Destroy of hoObj // when done, it will be destroyed
77216>>>End_procedure
77217>        Use RegistroEmpleado.vw
Including file: RegistroEmpleado.vw    (C:\DataFlex Projects\Control Marcajes\AppSrc\RegistroEmpleado.vw)
77217>>>Use Windows.pkg
77217>>>Use DFClient.pkg
77217>>>Use cNacionalidadDataDictionary.dd
Including file: cNacionalidadDataDictionary.dd    (C:\DataFlex Projects\Control Marcajes\DDSrc\cNacionalidadDataDictionary.dd)
77217>>>>>Use DataDict.pkg
77217>>>>>
77217>>>>>Open Nacionalidad
Including file: Nacionalidad.fd    (C:\DataFlex Projects\Control Marcajes\DDSrc\Nacionalidad.fd)
77219>>>>>Open Empleado
Including file: Empleado.fd    (C:\DataFlex Projects\Control Marcajes\DDSrc\Empleado.fd)
77221>>>>>Open Autoincrementable
Including file: Autoincrementable.fd    (C:\DataFlex Projects\Control Marcajes\DDSrc\Autoincrementable.fd)
77223>>>>>
77223>>>>>Register_Object ListadoNacionalidades
77223>>>>>
77223>>>>>Class cNacionalidadDataDictionary is a DataDictionary
77224>>>>>    
77224>>>>>    Procedure Construct_Object
77226>>>>>        Forward Send Construct_Object
77228>>>>>        Set Main_File to Nacionalidad.File_Number
77229>>>>>
77229>>>>>        Set Add_System_File to Autoincrementable.File_Number DD_Lock_On_All
77230>>>>>
77230>>>>>        Set Add_Client_File to Empleado.File_Number
77231>>>>>
77231>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77232>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77233>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77234>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77235>>>>>
77235>>>>>        Set Field_Option Field Nacionalidad.Numero DD_AUTOFIND to True
77236>>>>>        Set Key_Field_State Field Nacionalidad.Numero to True
77237>>>>>        Set Field_Auto_Increment Field Nacionalidad.Numero to File_Field Autoincrementable.NumNacionalidad
77238>>>>>
77238>>>>>        Set Field_Option Field Nacionalidad.Pais DD_AUTOFIND to True
77239>>>>>        Set Field_Option Field Nacionalidad.Pais DD_CAPSLOCK to True
77240>>>>>        Set Field_Option Field Nacionalidad.Pais DD_REQUIRED to True
77241>>>>>        
77241>>>>>
77241>>>>>    End_Procedure
77242>>>>>
77242>>>>>End_Class
77243>>>>>
77243>>>>>
77243>>>Use cEmpleadoDataDictionary.dd
Including file: cEmpleadoDataDictionary.dd    (C:\DataFlex Projects\Control Marcajes\DDSrc\cEmpleadoDataDictionary.dd)
77243>>>>>Use DataDict.pkg
77243>>>>>
77243>>>>>Open Empleado
77245>>>>>Open Nacionalidad
77247>>>>>Open Marcaje
Including file: Marcaje.fd    (C:\DataFlex Projects\Control Marcajes\DDSrc\Marcaje.fd)
77249>>>>>Open Autoincrementable
77251>>>>>
77251>>>>>Register_Object ListaEmpleado
77251>>>>>Register_Object ListaNacionalidad
77251>>>>>
77251>>>>>Class cEmpleadoDataDictionary is a DataDictionary
77252>>>>>    
77252>>>>>    Procedure Construct_Object
77254>>>>>        Forward Send Construct_Object
77256>>>>>        Set Main_File to Empleado.File_Number
77257>>>>>
77257>>>>>        Set Add_System_File to Autoincrementable.File_Number DD_Lock_On_All
77258>>>>>
77258>>>>>        Set Add_Client_File to Marcaje.File_Number
77259>>>>>
77259>>>>>        Set Add_Server_File to Nacionalidad.File_Number
77260>>>>>
77260>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77261>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77262>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77263>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77264>>>>>
77264>>>>>        Set Field_Option Field Empleado.Numero DD_AUTOFIND to True
77265>>>>>        Set Key_Field_State Field Empleado.Numero to True
77266>>>>>        Set Field_Auto_Increment Field Empleado.Numero to File_Field Autoincrementable.NumEmpleado
77267>>>>>        Set Field_Prompt_Object Field Empleado.Numero to ListaEmpleado
77268>>>>>
77268>>>>>        Set Field_Option Field Empleado.PrimerNombre DD_CAPSLOCK to True
77269>>>>>        Set Field_Option Field Empleado.PrimerNombre DD_REQUIRED to True
77270>>>>>        Set Field_Option Field Empleado.PrimerNombre DD_AUTOFIND to True
77271>>>>>
77271>>>>>        Set Field_Option Field Empleado.SegundoNombre DD_AUTOFIND to True
77272>>>>>        Set Field_Option Field Empleado.SegundoNombre DD_CAPSLOCK to True
77273>>>>>        Set Field_Option Field Empleado.SegundoNombre DD_REQUIRED to True
77274>>>>>
77274>>>>>        Set Field_Option Field Empleado.PrimerApellido DD_AUTOFIND to True
77275>>>>>        Set Field_Option Field Empleado.PrimerApellido DD_CAPSLOCK to True
77276>>>>>        Set Field_Option Field Empleado.PrimerApellido DD_REQUIRED to True
77277>>>>>
77277>>>>>        Set Field_Option Field Empleado.SegundoApellido DD_AUTOFIND to True
77278>>>>>        Set Field_Option Field Empleado.SegundoApellido DD_CAPSLOCK to True
77279>>>>>        Set Field_Option Field Empleado.SegundoApellido DD_REQUIRED to True
77280>>>>>
77280>>>>>         
77280>>>>>        Set Field_Option Field Empleado.Nacionalidad DD_AUTOFIND to True
77281>>>>>        Set Field_Prompt_Object Field Empleado.Nacionalidad to ListaNacionalidad
77282>>>>>        Set Field_Option Field Empleado.Nacionalidad DD_CAPSLOCK to True
77283>>>>>        Set Field_Option Field Empleado.Nacionalidad DD_REQUIRED to True
77284>>>>>
77284>>>>>    End_Procedure
77285>>>>>
77285>>>>>End_Class
77286>>>>>
77286>>>>>Use ListaNacionalidad.sl
Including file: ListaNacionalidad.sl    (C:\DataFlex Projects\Control Marcajes\AppSrc\ListaNacionalidad.sl)
77286>>>>>>>//**************************************************************
77286>>>>>>>// TableLookup.tpl for Windows application for Spanish 
77286>>>>>>>// translated by Moose Software (www.moose-software.com) 
77286>>>>>>>// 13/07/2010 Revised for VDF 16.0 by Moose Software
77286>>>>>>>// 05/02/2012 Revised for VDF 17.0 by Moose Software
77286>>>>>>>// 13/06/2013 Revised for VDF 17.1 by Moose Software
77286>>>>>>>// 02/05/2014 Revised for VDF 18.0 by Moose Software
77286>>>>>>>//*************************************************************
77286>>>>>>>
77286>>>>>>>Use Windows.pkg
77286>>>>>>>Use DFClient.pkg
77286>>>>>>>use DFSellst.pkg
77286>>>>>>>Use cNacionalidadDataDictionary.dd
77286>>>>>>>
77286>>>>>>>Object ListaNacionalidad is a dbModalPanel
77288>>>>>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77290>>>>>>>    End_Object
77291>>>>>>>
77291>>>>>>>    Set Main_DD to oNacionalidad_DD
77292>>>>>>>    Set Server to oNacionalidad_DD
77293>>>>>>>
77293>>>>>>>    Set Size to 133 292
77294>>>>>>>    Set Location     to 4 5
77295>>>>>>>    Set Border_Style to Border_Thick
77296>>>>>>>    Set Label to "Lista de Nacionalidades"
77297>>>>>>>
77297>>>>>>>    Object oSelList is a dbList
77299>>>>>>>        Set peAnchors to anAll
77300>>>>>>>        Set Size      to 105 280
77301>>>>>>>        Set Location  to 6 6
77302>>>>>>>
77302>>>>>>>        Begin_Row
77305>>>>>>>            Entry_Item Nacionalidad.Numero
77306>>>>>>>            Entry_Item Nacionalidad.Pais
77307>>>>>>>        End_Row
77312>>>>>>>
77312>>>>>>>        Set Main_File to Nacionalidad.File_Number
77313>>>>>>>
77313>>>>>>>        Set Form_Width 0 to 84
77314>>>>>>>        Set Header_Label 0 to "Numero"
77315>>>>>>>        Set Form_Width 1 to 270
77316>>>>>>>        Set Header_Label 1 to "Pais"
77317>>>>>>>    End_Object
77318>>>>>>>
77318>>>>>>>    Object oOK_bn is a Button
77320>>>>>>>        Set Label     to "&Aceptar"
77321>>>>>>>        Set Location  to 115 128
77322>>>>>>>        Set peAnchors to anBottomRight
77323>>>>>>>
77323>>>>>>>        Procedure OnClick
77326>>>>>>>            Send Ok of oSelList
77327>>>>>>>        End_Procedure
77328>>>>>>>
77328>>>>>>>    End_Object
77329>>>>>>>
77329>>>>>>>    Object oCancel_bn is a Button
77331>>>>>>>        Set Label     to "&Cancelar"
77332>>>>>>>        Set Location  to 115 182
77333>>>>>>>        Set peAnchors to anBottomRight
77334>>>>>>>
77334>>>>>>>        Procedure OnClick
77337>>>>>>>            Send Cancel of oSelList
77338>>>>>>>        End_Procedure
77339>>>>>>>
77339>>>>>>>    End_Object
77340>>>>>>>
77340>>>>>>>    Object oSearch_bn is a Button
77342>>>>>>>        Set Label     to "&Buscar..."
77343>>>>>>>        Set Location  to 115 236
77344>>>>>>>        Set peAnchors to anBottomRight
77345>>>>>>>
77345>>>>>>>        Procedure OnClick
77348>>>>>>>            Send Search of oSelList
77349>>>>>>>        End_Procedure
77350>>>>>>>
77350>>>>>>>    End_Object
77351>>>>>>>
77351>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction of oOk_bn
77352>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77353>>>>>>>    On_Key Key_Alt+Key_B Send KeyAction of oSearch_bn
77354>>>>>>>
77354>>>>>>>End_Object
77355>>>>>>>
77355>>>>>>>//*********************************************** end of TableLookup.tpl for Spanish ****************
77355>>>>>>>
77355>>>>>
77355>>>>>Use ListaEmpleado.sl
Including file: ListaEmpleado.sl    (C:\DataFlex Projects\Control Marcajes\AppSrc\ListaEmpleado.sl)
77355>>>>>>>//**************************************************************
77355>>>>>>>// TableLookup.tpl for Windows application for Spanish 
77355>>>>>>>// translated by Moose Software (www.moose-software.com) 
77355>>>>>>>// 13/07/2010 Revised for VDF 16.0 by Moose Software
77355>>>>>>>// 05/02/2012 Revised for VDF 17.0 by Moose Software
77355>>>>>>>// 13/06/2013 Revised for VDF 17.1 by Moose Software
77355>>>>>>>// 02/05/2014 Revised for VDF 18.0 by Moose Software
77355>>>>>>>//*************************************************************
77355>>>>>>>
77355>>>>>>>Use Windows.pkg
77355>>>>>>>Use DFClient.pkg
77355>>>>>>>use DFSellst.pkg
77355>>>>>>>Use cNacionalidadDataDictionary.dd
77355>>>>>>>Use cEmpleadoDataDictionary.dd
77355>>>>>>>
77355>>>>>>>Object ListaEmpleado is a dbModalPanel
77357>>>>>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
77359>>>>>>>    End_Object
77360>>>>>>>
77360>>>>>>>    Object oEmpleado_DD is a cEmpleadoDataDictionary
77362>>>>>>>        Set DDO_Server to oNacionalidad_DD
77363>>>>>>>    End_Object
77364>>>>>>>
77364>>>>>>>    Set Main_DD to oEmpleado_DD
77365>>>>>>>    Set Server to oEmpleado_DD
77366>>>>>>>
77366>>>>>>>    Set Size to 133 455
77367>>>>>>>    Set Location     to 4 5
77368>>>>>>>    Set Border_Style to Border_Thick
77369>>>>>>>    Set Label to "Lista de Empleado"
77370>>>>>>>
77370>>>>>>>    Object oSelList is a dbList
77372>>>>>>>        Set peAnchors to anAll
77373>>>>>>>        Set Size to 105 443
77374>>>>>>>        Set Location  to 6 6
77375>>>>>>>
77375>>>>>>>        Begin_Row
77378>>>>>>>            Entry_Item Empleado.Numero
77379>>>>>>>            Entry_Item Empleado.PrimerNombre
77380>>>>>>>            Entry_Item Empleado.SegundoNombre
77381>>>>>>>            Entry_Item Empleado.PrimerApellido
77382>>>>>>>            Entry_Item Empleado.SegundoApellido
77383>>>>>>>            Entry_Item Nacionalidad.Pais
77384>>>>>>>        End_Row
77389>>>>>>>
77389>>>>>>>        Set Main_File to Empleado.File_Number
77390>>>>>>>
77390>>>>>>>        Set Form_Width 0 to 24
77391>>>>>>>        Set Header_Label 0 to "#"
77392>>>>>>>        Set Form_Width 1 to 60
77393>>>>>>>        Set Header_Label 1 to "Primer Nombre"
77394>>>>>>>        Set Form_Width 2 to 60
77395>>>>>>>        Set Header_Label 2 to "Segundo Nombre"
77396>>>>>>>        Set Form_Width 3 to 60
77397>>>>>>>        Set Header_Label 3 to "Primer Apellido"
77398>>>>>>>        Set Form_Width 4 to 60
77399>>>>>>>        Set Header_Label 4 to "Segundo Apellido"
77400>>>>>>>        Set Form_Width 5 to 60
77401>>>>>>>        Set Header_Label 5 to "Pais"
77402>>>>>>>    End_Object
77403>>>>>>>
77403>>>>>>>    Object oOK_bn is a Button
77405>>>>>>>        Set Label     to "&Aceptar"
77406>>>>>>>        Set Location to 115 291
77407>>>>>>>        Set peAnchors to anBottomRight
77408>>>>>>>
77408>>>>>>>        Procedure OnClick
77411>>>>>>>            Send Ok of oSelList
77412>>>>>>>        End_Procedure
77413>>>>>>>
77413>>>>>>>    End_Object
77414>>>>>>>
77414>>>>>>>    Object oCancel_bn is a Button
77416>>>>>>>        Set Label     to "&Cancelar"
77417>>>>>>>        Set Location to 115 345
77418>>>>>>>        Set peAnchors to anBottomRight
77419>>>>>>>
77419>>>>>>>        Procedure OnClick
77422>>>>>>>            Send Cancel of oSelList
77423>>>>>>>        End_Procedure
77424>>>>>>>
77424>>>>>>>    End_Object
77425>>>>>>>
77425>>>>>>>    Object oSearch_bn is a Button
77427>>>>>>>        Set Label     to "&Buscar..."
77428>>>>>>>        Set Location to 115 399
77429>>>>>>>        Set peAnchors to anBottomRight
77430>>>>>>>
77430>>>>>>>        Procedure OnClick
77433>>>>>>>            Send Search of oSelList
77434>>>>>>>        End_Procedure
77435>>>>>>>
77435>>>>>>>    End_Object
77436>>>>>>>
77436>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction of oOk_bn
77437>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
77438>>>>>>>    On_Key Key_Alt+Key_B Send KeyAction of oSearch_bn
77439>>>>>>>
77439>>>>>>>End_Object
77440>>>>>>>
77440>>>>>>>//*********************************************** end of TableLookup.tpl for Spanish ****************
77440>>>>>>>
77440>>>Use DFEntry.pkg
77440>>>Use cDbCJGrid.pkg
77440>>>Use cdbCJGridColumn.pkg
77440>>>Use cDbCJGridColumnSuggestion.pkg
Including file: cDbCJGridColumnSuggestion.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cDbCJGridColumnSuggestion.pkg)
77440>>>>>Use WinSuggestion.pkg
Including file: WinSuggestion.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\WinSuggestion.pkg)
77440>>>>>>>// 
77440>>>>>>>
77440>>>>>>>Use Windows.pkg
77440>>>>>>>Use tWinStructs.pkg
77440>>>>>>>Use tSuggestion.pkg
Including file: tSuggestion.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\tSuggestion.pkg)
77440>>>>>>>>>// struct used for suggestion forms, representing an item of data
77440>>>>>>>>>Enum_List 
77440>>>>>>>>>    Define smFind
77440>>>>>>>>>    Define smValidationTable
77440>>>>>>>>>    Define smCustom
77440>>>>>>>>>End_Enum_List
77440>>>>>>>>>
77440>>>>>>>>>Struct tSuggestion
77440>>>>>>>>>    String sRowId
77440>>>>>>>>>    String[] aValues
77440>>>>>>>>>End_Struct
77440>>>>>>>>>
77440>>>>>>>Use cTimer.pkg
Including file: cTimer.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cTimer.pkg)
77440>>>>>>>>>// cTimer class
77440>>>>>>>>>//
77440>>>>>>>>>// This supercedes the DFTimer class. 
77440>>>>>>>>>// It is simpler and more flexible
77440>>>>>>>>>
77440>>>>>>>>>Use Dftimer.pkg // we still use the Timer Manager classes and global objects
Including file: Dftimer.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\Dftimer.pkg)
77440>>>>>>>>>>>//************************************************************************
77440>>>>>>>>>>>//--- DFTimer   Timer package for DataFlex programs
77440>>>>>>>>>>>//
77440>>>>>>>>>>>// Copyright (c) 1983-2002 Data Access Corporation, Miami Florida,
77440>>>>>>>>>>>// All rights reserved.
77440>>>>>>>>>>>// DataFlex is a registered trademark of Data Access Corporation.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//************************************************************************
77440>>>>>>>>>>>//  Description:
77440>>>>>>>>>>>//      This package contains all components needed to implement timers
77440>>>>>>>>>>>//      in a DataFlex 4 program.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//  Author: Eddy Kleinjan, Data Access Nederland
77440>>>>>>>>>>>//************************************************************************
77440>>>>>>>>>>>// 03/03/2001 EK  Fixed Timer_Active_State to check for valid windows
77440>>>>>>>>>>>//                handle before trying to set or kill a timer.
77440>>>>>>>>>>>//                Fixed Kill_All_Timers to check for valid windows
77440>>>>>>>>>>>//                handle before trying to kill a timer.
77440>>>>>>>>>>>//                The windows handle might not exist anymore when the
77440>>>>>>>>>>>//                program is being exited using Exit_Application.
77440>>>>>>>>>>>// 12/13/2001 JJT fixed Timer_Active_State to check for -1 (not 0). Fixed a
77440>>>>>>>>>>>//                a bug where set Timeout started inactive timers.
77440>>>>>>>>>>>//                Added code to force timer object to desktop
77440>>>>>>>>>>>//************************************************************************
77440>>>>>>>>>>>// CLASS DFTimer
77440>>>>>>>>>>>//
77440>>>>>>>>>>>// Usage:
77440>>>>>>>>>>>//    Object MyTimer is a DFTimer
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//        Set Timeout to 2000                             // Default 1000
77440>>>>>>>>>>>//        Set Auto_Start_State to TRUE|FALSE              // Default TRUE
77440>>>>>>>>>>>//        Set Auto_Stop_State to TRUE|FALSE               // Default TRUE
77440>>>>>>>>>>>//        Set Timer_Message to MyMessage                  // Default 0
77440>>>>>>>>>>>//        Set Timer_Object to (MyObject(self))            // Default 0
77440>>>>>>>>>>>//        Set Timer_Active_State to TRUE|FALSE            // Default FALSE
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//        // Augment when no Timer_Message
77440>>>>>>>>>>>//        Procedure OnTimer
77440>>>>>>>>>>>//            Send Info_Box "HEY, WAKE UP!"
77440>>>>>>>>>>>//        End_Procedure
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//    End_Object
77440>>>>>>>>>>>//
77440>>>>>>>>>>>// DESCRIPTION
77440>>>>>>>>>>>//      Objects of this class can be used to trigger an event after a
77440>>>>>>>>>>>//      certain amount of time has passed. You can specify this time
77440>>>>>>>>>>>//      by setting the Timeout property of the object. This timeout
77440>>>>>>>>>>>//      is in miliseconds.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//      Whenever a timer event happens, it will notify the object by
77440>>>>>>>>>>>//      sending an OnTimer event. You can trap this event to do whatever
77440>>>>>>>>>>>//      you want the timer to do. By default this OnTimer event
77440>>>>>>>>>>>//      will send the Timer_Message to Timer_Object, when these have
77440>>>>>>>>>>>//      been specified.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//      By default, you have to activate a timer by setting its
77440>>>>>>>>>>>//      Timer_Active_State to TRUE. When the timer has been placed
77440>>>>>>>>>>>//      inside a user-interface object, it can also be activated
77440>>>>>>>>>>>//      automatically when this user-interface object is being
77440>>>>>>>>>>>//      activated. This only happes when it Auto_Start_State is TRUE,
77440>>>>>>>>>>>//      which is the default setting. In such a case, the timer will
77440>>>>>>>>>>>//      also automatically being stopped when the user-interface
77440>>>>>>>>>>>//      object is taken of the screen. This depends on the
77440>>>>>>>>>>>//      Auto_Stop_Timer state to happen.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//      When you need to set a new timeout value, you can do so
77440>>>>>>>>>>>//      even when the timer is active. It will adjust the timeout
77440>>>>>>>>>>>//      immediately.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//      Note that timer events depend on Windows for the delivery of
77440>>>>>>>>>>>//      the event. Since timer events get a low priority in Windows,
77440>>>>>>>>>>>//      it might put your program on hold when other programs are very
77440>>>>>>>>>>>//      busy. In such a case, you will only receive one timer event
77440>>>>>>>>>>>//      after the process stopped. There is no way, other than
77440>>>>>>>>>>>//      calculating it yourself, to determine how many time has passed
77440>>>>>>>>>>>//      or how many timer event should have happened since the last
77440>>>>>>>>>>>//      timer event or timer activation.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>// PUBLIC INTERFACE
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//    PROPERTIES
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//    Auto_Start_State When TRUE (default) the timer will be activated
77440>>>>>>>>>>>//                     automatically when the object will be (virtually)
77440>>>>>>>>>>>//                     paged on the screen.
77440>>>>>>>>>>>//                     Example: When a timer object has been placed
77440>>>>>>>>>>>//                     inside a view, then the timer will be activated
77440>>>>>>>>>>>//                     when the view is activated.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//    Auto_Stop_State  When TRUE (default) the timer will be deactivated
77440>>>>>>>>>>>//                     automatically when the object will be (virtually)
77440>>>>>>>>>>>//                     taken off the screen.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//    Timeout          The timeout value for the timer to fire. The
77440>>>>>>>>>>>//                     timeout value must be set in miliseconds.
77440>>>>>>>>>>>//                     This property may be set even when the timer is
77440>>>>>>>>>>>//                     active. The new timeout value will be applied
77440>>>>>>>>>>>//                     immediately.
77440>>>>>>>>>>>//                     NOTE: The timeout set here is never precise. It
77440>>>>>>>>>>>//                     depends on Windows to deliver the message to our
77440>>>>>>>>>>>//                     application.
77440>>>>>>>>>>>//                     Default 1000.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//    Timer_Active_State
77440>>>>>>>>>>>//                     Set to TRUE to activate the timer, to FALSE to
77440>>>>>>>>>>>//                     deactivate the timer.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//    Timer_Message    This property can be set to a messageID which has
77440>>>>>>>>>>>//                     to be sent whenever a timer event occurs. Default
77440>>>>>>>>>>>//                     this message will be send to the object itself
77440>>>>>>>>>>>//                     unless a Timer_Object as been specified.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//    Timer_Object     This property can be set to an objectID which has
77440>>>>>>>>>>>//                     to receive the Timer_Message whenever a timer
77440>>>>>>>>>>>//                     event occurs. This value has no meaning when
77440>>>>>>>>>>>//                     no Timer_Message has been set.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//    METHODS
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//    OnTimer          This event will happen whenever the specified
77440>>>>>>>>>>>//                     amount of time has passed and the timer is
77440>>>>>>>>>>>//                     active. By default it sends the message in
77440>>>>>>>>>>>//                     the Timer_Message property to the object in
77440>>>>>>>>>>>//                     the Timer_Object when these have been specified.
77440>>>>>>>>>>>//                     When you don't need this, you can just override
77440>>>>>>>>>>>//                     the OnTimer event.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>// PUBLIC INTERFACE
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//    Page_Object      Has been augmented to auto_start the timer when
77440>>>>>>>>>>>//                     it becomes active as part or a user-interface
77440>>>>>>>>>>>//                     object.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//    Page_Delete      Has been augmented to auto_stop the timer when
77440>>>>>>>>>>>//                     it is deactivated as part or a user-interface
77440>>>>>>>>>>>//                     object.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>//    Destroy_Object   Has been augmented to deactivate the timer.
77440>>>>>>>>>>>//
77440>>>>>>>>>>>Use LanguageText.pkg
77440>>>>>>>>>>>Use Windows.pkg
77440>>>>>>>>>>>Use WinUser.pkg
77440>>>>>>>>>>>
77440>>>>>>>>>>>External_Function SetTimer "SetTimer" User32.DLL ;    Integer hWnd ;    Integer idTimer ;    Integer idTimeout ;    Pointer tmprc ;    Returns Integer
77441>>>>>>>>>>>
77441>>>>>>>>>>>External_Function KillTimer "KillTimer" User32.DLL ;    Integer hWnd ;    Integer idTimer ;    Returns Integer
77442>>>>>>>>>>>
77442>>>>>>>>>>>// This global integer holds the ID of the object
77442>>>>>>>>>>>// that manages all timers.
77442>>>>>>>>>>>Integer giTimerManager
77442>>>>>>>>>>>
77442>>>>>>>>>>>// This class is used to store the object IDs
77442>>>>>>>>>>>// of the active timer objects. It augments
77442>>>>>>>>>>>// the Destroy_Object procedure to notify
77442>>>>>>>>>>>// the DFTimerManager to kill all its active
77442>>>>>>>>>>>// timers.
77442>>>>>>>>>>>// NOTE: This class looks very much like the
77442>>>>>>>>>>>// Set class. I didn't want to use Set because
77442>>>>>>>>>>>// Remove_Element shifts items which I don't
77442>>>>>>>>>>>// want to happen because item numbers are used
77442>>>>>>>>>>>// as timerIDs.
77442>>>>>>>>>>>
77442>>>>>>>>>>>Class TimersArray is an Array
77443>>>>>>>>>>>
77443>>>>>>>>>>>    Function Find_Object Integer iObj Returns Integer
77445>>>>>>>>>>>        Integer iMax
77445>>>>>>>>>>>        Integer iItem
77445>>>>>>>>>>>        Integer iValue
77445>>>>>>>>>>>        Get Item_count to iMax
77446>>>>>>>>>>>        Decrement iMax
77447>>>>>>>>>>>        For iItem from 1 to iMax
77453>>>>>>>>>>>>
77453>>>>>>>>>>>            Get Integer_Value item iItem to iValue
77454>>>>>>>>>>>            If iValue EQ iObj;                Function_Return iItem
77457>>>>>>>>>>>        Loop
77458>>>>>>>>>>>>
77458>>>>>>>>>>>        Function_Return -1
77459>>>>>>>>>>>    End_Function
77460>>>>>>>>>>>
77460>>>>>>>>>>>    Procedure Add_Object Integer iObj Returns Integer
77462>>>>>>>>>>>        Integer iItem
77462>>>>>>>>>>>        Get Find_Object iObj to iItem
77463>>>>>>>>>>>        If iItem LT 0 Begin
77465>>>>>>>>>>>            Get Find_Object 0 to iItem
77466>>>>>>>>>>>            If iItem LT 0 ;                Get Item_Count to iItem
77469>>>>>>>>>>>        End
77469>>>>>>>>>>>>
77469>>>>>>>>>>>        Set Array_Value item iItem to iObj
77470>>>>>>>>>>>        Procedure_Return iItem
77471>>>>>>>>>>>    End_Procedure
77472>>>>>>>>>>>
77472>>>>>>>>>>>    Procedure Remove_Object Integer iObj
77474>>>>>>>>>>>        Integer iItem
77474>>>>>>>>>>>        Get Find_Object iObj to iItem
77475>>>>>>>>>>>        If iItem GT 0 ;            Set Array_Value item iItem to 0
77478>>>>>>>>>>>    End_Procedure
77479>>>>>>>>>>>
77479>>>>>>>>>>>    Procedure Destroy_Object
77481>>>>>>>>>>>        Delegate Send Kill_All_Timers
77483>>>>>>>>>>>        Forward Send Destroy_Object
77485>>>>>>>>>>>    End_Procedure
77486>>>>>>>>>>>
77486>>>>>>>>>>>End_Class // TimersArray
77487>>>>>>>>>>>
77487>>>>>>>>>>>// This class is the actual timer manager
77487>>>>>>>>>>>// A timer will be created when Message Set_Timer_Active_State
77487>>>>>>>>>>>// has been send. This message needs two arguments. The first
77487>>>>>>>>>>>// is the objectID of the object to receive the timer event,
77487>>>>>>>>>>>// and the second is state. The object which ID has been passed,
77487>>>>>>>>>>>// needs to have a Timeout property to return the timeout for the
77487>>>>>>>>>>>// timer and it also needs to handle the MSG_OnTimer whenever a
77487>>>>>>>>>>>// timer event occurs.
77487>>>>>>>>>>>// The objectID of the Object will be placed in an array which contains
77487>>>>>>>>>>>// the objectIDs of all active timers. The Windows timer ID of a timer
77487>>>>>>>>>>>// is the itemnumber of the object in the array.
77487>>>>>>>>>>>//
77487>>>>>>>>>>>Class DFTimerManager is a DfBaseControl
77488>>>>>>>>>>>
77488>>>>>>>>>>>    Procedure Construct_Object
77490>>>>>>>>>>>
77490>>>>>>>>>>>        Forward Send Construct_Object
77492>>>>>>>>>>>
77492>>>>>>>>>>>        Set Visible_State to FALSE
77493>>>>>>>>>>>
77493>>>>>>>>>>>        Set External_Class_Name "cVdfTimer" to "static"
77494>>>>>>>>>>>        Set External_Message WM_TIMER to OnTimer
77495>>>>>>>>>>>
77495>>>>>>>>>>>        Object TimersArray is a TimersArray
77497>>>>>>>>>>>            Set Array_Value item 0 to -9999 // So we don't use item 0
77498>>>>>>>>>>>        End_Object
77499>>>>>>>>>>>
77499>>>>>>>>>>>        Move self to giTimerManager
77500>>>>>>>>>>>
77500>>>>>>>>>>>    End_Procedure
77501>>>>>>>>>>>
77501>>>>>>>>>>>    Procedure Set Timer_Active_State Integer iObj Integer iState
77503>>>>>>>>>>>        Integer iTimerID
77503>>>>>>>>>>>        Integer iTimeout
77503>>>>>>>>>>>        Integer iResult
77503>>>>>>>>>>>        Integer iSet
77503>>>>>>>>>>>        Dword   nResult
77503>>>>>>>>>>>        Handle  hWnd
77503>>>>>>>>>>>
77503>>>>>>>>>>>        // Get the handle of this object
77503>>>>>>>>>>>        Get Window_Handle to hWnd
77504>>>>>>>>>>>        If (Not(hWnd)) Begin
77506>>>>>>>>>>>            Error DFERR_DFTIMER C_$TimerNoHandle
77507>>>>>>>>>>>>
77507>>>>>>>>>>>            Procedure_Return
77508>>>>>>>>>>>        End
77508>>>>>>>>>>>>
77508>>>>>>>>>>>
77508>>>>>>>>>>>        // Test if handle is valid. If not, we leave.
77508>>>>>>>>>>>        If (Not(IsWindow(hWnd))) ;            Procedure_Return
77511>>>>>>>>>>>
77511>>>>>>>>>>>        Move (TimersArray(self)) to iSet
77512>>>>>>>>>>>
77512>>>>>>>>>>>        If (iSet) Begin
77514>>>>>>>>>>>
77514>>>>>>>>>>>            // Let's create or modify a timer
77514>>>>>>>>>>>            If iState Begin
77516>>>>>>>>>>>
77516>>>>>>>>>>>                // Get the exising to new TimerID
77516>>>>>>>>>>>                Get MSG_Add_Object of iSet iObj to iTimerID
77517>>>>>>>>>>>
77517>>>>>>>>>>>                // Set/Modify the timer
77517>>>>>>>>>>>                Get Timeout of iObj to iTimeout
77518>>>>>>>>>>>                Move (SetTimer(hWnd, iTimerID, iTimeout, 0)) to iResult
77519>>>>>>>>>>>                If Not iResult Begin
77521>>>>>>>>>>>                    Error DFERR_DFTIMER C_$TooManyTimers
77522>>>>>>>>>>>>
77522>>>>>>>>>>>                    Procedure_Return
77523>>>>>>>>>>>                End
77523>>>>>>>>>>>>
77523>>>>>>>>>>>
77523>>>>>>>>>>>            End
77523>>>>>>>>>>>>
77523>>>>>>>>>>>
77523>>>>>>>>>>>            // Let's kill an existing timer
77523>>>>>>>>>>>            Else Begin
77524>>>>>>>>>>>
77524>>>>>>>>>>>                // Look up the object in the set
77524>>>>>>>>>>>                Get Find_Object of iSet iObj to iTimerID
77525>>>>>>>>>>>
77525>>>>>>>>>>>                If iTimerID EQ -1 ;                    Procedure_Return
77528>>>>>>>>>>>
77528>>>>>>>>>>>                // Kill the timer
77528>>>>>>>>>>>                Move (KillTimer(hWnd, iTimerID)) to iResult
77529>>>>>>>>>>>                If Not iResult Begin
77531>>>>>>>>>>>                    Move (GetLastError()) to nResult
77532>>>>>>>>>>>                    Error DFERR_DFTIMER (C_$CantKillTimer * string(nResult) - "!")
77533>>>>>>>>>>>>
77533>>>>>>>>>>>                    Procedure_Return
77534>>>>>>>>>>>                End
77534>>>>>>>>>>>>
77534>>>>>>>>>>>
77534>>>>>>>>>>>                // Remove the objectID
77534>>>>>>>>>>>                Send Remove_Object to iSet iObj
77535>>>>>>>>>>>            End
77535>>>>>>>>>>>>
77535>>>>>>>>>>>        End
77535>>>>>>>>>>>>
77535>>>>>>>>>>>    End_Procedure
77536>>>>>>>>>>>
77536>>>>>>>>>>>    Function Timer_Active_State Integer iObj Returns Integer
77538>>>>>>>>>>>        Integer iResult
77538>>>>>>>>>>>        Get Find_Object of (TimersArray(self)) iObj to iResult
77539>>>>>>>>>>>        Function_Return (iResult<>-1) // note: -1= not found
77540>>>>>>>>>>>    End_Function
77541>>>>>>>>>>>
77541>>>>>>>>>>>    // Will be called by the Set when it is being destroyed.
77541>>>>>>>>>>>    Procedure Kill_All_Timers
77543>>>>>>>>>>>        Integer iMax
77543>>>>>>>>>>>        Integer iSet
77543>>>>>>>>>>>        Integer iItem
77543>>>>>>>>>>>        Integer iObj
77543>>>>>>>>>>>        Integer iResult
77543>>>>>>>>>>>        Handle  hWnd
77543>>>>>>>>>>>
77543>>>>>>>>>>>        // Get the handle of this object
77543>>>>>>>>>>>        Get Window_Handle to hWnd
77544>>>>>>>>>>>        If (Not(hWnd)) Begin
77546>>>>>>>>>>>            Error DFERR_DFTIMER C_$TimerNoHandle
77547>>>>>>>>>>>>
77547>>>>>>>>>>>            Procedure_Return
77548>>>>>>>>>>>        End
77548>>>>>>>>>>>>
77548>>>>>>>>>>>
77548>>>>>>>>>>>        // If the window handle is no longer valid, we
77548>>>>>>>>>>>        // leave this procedure. This can happen when the
77548>>>>>>>>>>>        // program is begin aborted using Exit_Application
77548>>>>>>>>>>>        If (Not(IsWindow(hWnd))) ;            Procedure_Return
77551>>>>>>>>>>>
77551>>>>>>>>>>>        // Scan the set and kill all known timers
77551>>>>>>>>>>>        Move (TimersArray(self)) to iSet
77552>>>>>>>>>>>        If (iSet) Begin
77554>>>>>>>>>>>            Get Item_Count of iSet to iMax
77555>>>>>>>>>>>            Decrement iMax
77556>>>>>>>>>>>            For iItem From 1 to iMax
77562>>>>>>>>>>>>
77562>>>>>>>>>>>                Get Integer_Value of iSet item iItem to iObj
77563>>>>>>>>>>>                If iObj Begin
77565>>>>>>>>>>>                    Move (KillTimer(hWnd, iItem)) to iResult
77566>>>>>>>>>>>                    Set Array_Value of iSet item iItem to 0
77567>>>>>>>>>>>                End
77567>>>>>>>>>>>>
77567>>>>>>>>>>>            Loop
77568>>>>>>>>>>>>
77568>>>>>>>>>>>        End
77568>>>>>>>>>>>>
77568>>>>>>>>>>>
77568>>>>>>>>>>>    End_Procedure
77569>>>>>>>>>>>
77569>>>>>>>>>>>    Procedure OnTimer Integer wParam Integer lParam
77571>>>>>>>>>>>        Integer iObj
77571>>>>>>>>>>>        Get Integer_Value of (TimersArray(self)) item wParam to iObj
77572>>>>>>>>>>>        If Not iObj Begin
77574>>>>>>>>>>>            Error DFERR_DFTIMER C_$TimerWithoutObject
77575>>>>>>>>>>>>
77575>>>>>>>>>>>            Procedure_Return
77576>>>>>>>>>>>        End
77576>>>>>>>>>>>>
77576>>>>>>>>>>>        Send OnTimer to iObj wParam lParam
77577>>>>>>>>>>>    End_Procedure
77578>>>>>>>>>>>
77578>>>>>>>>>>>    Procedure Destroy_Object
77580>>>>>>>>>>>        Send Kill_All_Timers
77581>>>>>>>>>>>        Forward Send Destroy_Object
77583>>>>>>>>>>>        Move 0 to giTimerManager
77584>>>>>>>>>>>    End_Procedure
77585>>>>>>>>>>>
77585>>>>>>>>>>>End_Class // DFTimerManger
77586>>>>>>>>>>>
77586>>>>>>>>>>>
77586>>>>>>>>>>>
77586>>>>>>>>>>>
77586>>>>>>>>>>>// This class acts as a container for the
77586>>>>>>>>>>>// timer manager object. This is needed because
77586>>>>>>>>>>>// A DFTimerManager object created directly at the
77586>>>>>>>>>>>// desktop doesn't have a Window_Handle which we
77586>>>>>>>>>>>// need to create a Windoows timer. By placing
77586>>>>>>>>>>>// this non-visual container around the timer
77586>>>>>>>>>>>// manager, it does get a Window_Handle.
77586>>>>>>>>>>>// The procedure End_Construct_Object has been
77586>>>>>>>>>>>// augmented to create a window and also
77586>>>>>>>>>>>// automatically page all children, which will
77586>>>>>>>>>>>// be the timer manager.
77586>>>>>>>>>>>//
77586>>>>>>>>>>>Class DFTimerManagerPanel is a dfBasePanel
77587>>>>>>>>>>>
77587>>>>>>>>>>>    Procedure Construct_Object
77589>>>>>>>>>>>        Forward Send Construct_Object
77591>>>>>>>>>>>        Set Visible_State to FALSE
77592>>>>>>>>>>>        Object DFTimerManager is a DFTimerManager
77594>>>>>>>>>>>        End_Object
77595>>>>>>>>>>>    End_Procedure
77596>>>>>>>>>>>
77596>>>>>>>>>>>    Procedure End_Construct_Object
77598>>>>>>>>>>>        Forward Send End_Construct_Object
77600>>>>>>>>>>>        Send Page_Object TRUE
77601>>>>>>>>>>>        Broadcast Send Page_Object TRUE
77603>>>>>>>>>>>    End_Procedure
77604>>>>>>>>>>>
77604>>>>>>>>>>>End_Class
77605>>>>>>>>>>>
77605>>>>>>>>>>>// This is the class the user uses to create DFTimer objects
77605>>>>>>>>>>>
77605>>>>>>>>>>>
77605>>>>>>>>>>>//{ OverrideProperty=Skip_State DesignTime=False }
77605>>>>>>>>>>>//{ OverrideProperty=TypeFace DesignTime=False }
77605>>>>>>>>>>>Class DFTimer is a Textbox
77606>>>>>>>>>>>
77606>>>>>>>>>>>    Procedure Construct_Object
77608>>>>>>>>>>>        Forward Send Construct_Object
77610>>>>>>>>>>>
77610>>>>>>>>>>>        // Make sure this object never appears
77610>>>>>>>>>>>        Set Visible_State to FALSE
77611>>>>>>>>>>>
77611>>>>>>>>>>>        Property Integer Private.Timeout    1000
77612>>>>>>>>>>>
77612>>>>>>>>>>>        Property Integer Timer_Message      0
77613>>>>>>>>>>>        Property Integer Timer_Object       0
77614>>>>>>>>>>>        Property Integer Auto_Start_State   True
77615>>>>>>>>>>>        Property Integer Auto_Stop_State    True
77616>>>>>>>>>>>    End_Procedure
77617>>>>>>>>>>>
77617>>>>>>>>>>>    Procedure Set Timer_Active_State Integer iState
77619>>>>>>>>>>>        Integer iObj
77619>>>>>>>>>>>        Move self to iObj
77620>>>>>>>>>>>        If giTimerManager ;            Set Timer_Active_State of giTimerManager iObj to iState
77623>>>>>>>>>>>    End_Procedure
77624>>>>>>>>>>>
77624>>>>>>>>>>>    Function Timer_Active_State Returns Integer
77626>>>>>>>>>>>        Integer iState
77626>>>>>>>>>>>        Integer iObj
77626>>>>>>>>>>>        Move self to iObj
77627>>>>>>>>>>>        If giTimerManager ;            Get Timer_Active_State of giTimerManager iObj to iState
77630>>>>>>>>>>>        Function_Return iState
77631>>>>>>>>>>>    End_Function
77632>>>>>>>>>>>
77632>>>>>>>>>>>    Procedure Set Timeout Integer iTimeout
77634>>>>>>>>>>>        Integer iActive
77634>>>>>>>>>>>        Set Private.Timeout to iTimeout
77635>>>>>>>>>>>        Get Timer_Active_State to iActive
77636>>>>>>>>>>>        If iActive ;            Set Timer_Active_State to TRUE
77639>>>>>>>>>>>    End_Procedure
77640>>>>>>>>>>>
77640>>>>>>>>>>>    Function Timeout Returns Integer
77642>>>>>>>>>>>        Integer iTimeout
77642>>>>>>>>>>>        Get Private.Timeout to iTimeout
77643>>>>>>>>>>>        Function_Return iTimeout
77644>>>>>>>>>>>    End_Function
77645>>>>>>>>>>>
77645>>>>>>>>>>>    Procedure OnTimer Integer iwParam Integer ilParam
77647>>>>>>>>>>>        Integer iMsg
77647>>>>>>>>>>>        Integer iObj
77647>>>>>>>>>>>        Get Timer_Message to iMsg
77648>>>>>>>>>>>        If (iMsg) Begin
77650>>>>>>>>>>>            Get Timer_Object  to iObj
77651>>>>>>>>>>>            If iObj ;                Send iMsg to iObj iwParam ilParam
77654>>>>>>>>>>>            Else ;                Send iMsg iwParam ilParam
77656>>>>>>>>>>>        End
77656>>>>>>>>>>>>
77656>>>>>>>>>>>    End_Procedure
77657>>>>>>>>>>>
77657>>>>>>>>>>>    // Augmented to Auto_Start a timer
77657>>>>>>>>>>>    //
77657>>>>>>>>>>>    Procedure Page_Object Integer iState
77659>>>>>>>>>>>        Forward Send Page_Object iState
77661>>>>>>>>>>>        If (iState AND Auto_Start_State(self)) ;            Set Timer_Active_State to TRUE
77664>>>>>>>>>>>    End_Procedure
77665>>>>>>>>>>>
77665>>>>>>>>>>>    // Augmented to Auto_Stop a timer
77665>>>>>>>>>>>    //
77665>>>>>>>>>>>    Procedure Page_Delete
77667>>>>>>>>>>>        If (Auto_Stop_State(self)) ;            Set Timer_Active_State to FALSE
77670>>>>>>>>>>>        Forward Send Page_Delete
77672>>>>>>>>>>>    End_Procedure
77673>>>>>>>>>>>
77673>>>>>>>>>>>    // Augmented to stop the timer
77673>>>>>>>>>>>    //
77673>>>>>>>>>>>    Procedure Destroy_Object
77675>>>>>>>>>>>        Set Timer_Active_State to FALSE
77676>>>>>>>>>>>        Forward Send Destroy_Object
77678>>>>>>>>>>>    End_Procedure
77679>>>>>>>>>>>
77679>>>>>>>>>>>End_Class // DFTimer
77680>>>>>>>>>>>
77680>>>>>>>>>>>//
77680>>>>>>>>>>>// This was moved into a method so it can be reliable created
77680>>>>>>>>>>>// at the desktop. Note that cDesktop adds method to cDesktop class (class of desktop)
77680>>>>>>>>>>>//
77680>>>>>>>>>>>Procedure CreateDfTimerManagerPanel FOR cDesktop
77682>>>>>>>>>>>    // Create the Desktop Timer Manager Object.
77682>>>>>>>>>>>    Object DFTimerManagerPanel is a DFTimerManagerPanel
77684>>>>>>>>>>>    End_Object
77685>>>>>>>>>>>End_Procedure
77686>>>>>>>>>>>
77686>>>>>>>>>>>Send CreateDfTimerManagerPanel of DESKTOP
77687>>>>>>>>>>>
77687>>>>>>>>>
77687>>>>>>>>>Class cTimer is a cObject
77688>>>>>>>>>
77688>>>>>>>>>    Procedure Construct_Object
77690>>>>>>>>>        Forward Send Construct_Object
77692>>>>>>>>>        Property Integer piPrivate_Timeout 1000
77693>>>>>>>>>    End_Procedure
77694>>>>>>>>>
77694>>>>>>>>>    Procedure Set pbEnabled Boolean bEnabled
77696>>>>>>>>>        If giTimerManager Begin
77698>>>>>>>>>            Set Timer_Active_State of giTimerManager Self to bEnabled
77699>>>>>>>>>        End
77699>>>>>>>>>>
77699>>>>>>>>>    End_Procedure
77700>>>>>>>>>
77700>>>>>>>>>    Function pbEnabled Returns Boolean
77702>>>>>>>>>        Boolean bEnabled
77702>>>>>>>>>        If giTimerManager Begin
77704>>>>>>>>>            Get Timer_Active_State of giTimerManager Self to bEnabled
77705>>>>>>>>>        End
77705>>>>>>>>>>
77705>>>>>>>>>        Function_Return bEnabled
77706>>>>>>>>>    End_Function
77707>>>>>>>>>
77707>>>>>>>>>    Procedure Set piTimeout Integer iTimeout
77709>>>>>>>>>        Boolean bEnabled
77709>>>>>>>>>        Set piPrivate_Timeout to iTimeout
77710>>>>>>>>>        Get pbEnabled to bEnabled
77711>>>>>>>>>        If bEnabled Begin
77713>>>>>>>>>            Set pbEnabled to True
77714>>>>>>>>>        End
77714>>>>>>>>>>
77714>>>>>>>>>    End_Procedure
77715>>>>>>>>>
77715>>>>>>>>>    Function piTimeout Returns Integer
77717>>>>>>>>>        Integer iTimeout
77717>>>>>>>>>        Get piPrivate_Timeout to iTimeout
77718>>>>>>>>>        Function_Return iTimeout
77719>>>>>>>>>    End_Function
77720>>>>>>>>>
77720>>>>>>>>>    Procedure OnTimer
77722>>>>>>>>>    End_Procedure
77723>>>>>>>>>    
77723>>>>>>>>>    // this is needed by the timer manager 
77723>>>>>>>>>    Function Timeout Returns Integer
77725>>>>>>>>>        Integer iTimeout
77725>>>>>>>>>        Get piPrivate_Timeout to iTimeout
77726>>>>>>>>>        Function_Return iTimeout
77727>>>>>>>>>    End_Function
77728>>>>>>>>>
77728>>>>>>>>>    Procedure Destroy_Object
77730>>>>>>>>>        Set pbEnabled to False
77731>>>>>>>>>        Forward Send Destroy_Object
77733>>>>>>>>>    End_Procedure
77734>>>>>>>>>
77734>>>>>>>>>End_Class
77735>>>>>>>Use cRichEdit.pkg
Including file: cRichEdit.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cRichEdit.pkg)
77735>>>>>>>>>use Windows.pkg
77735>>>>>>>>>Use cEdit_Mixin.pkg
77735>>>>>>>>>
77735>>>>>>>>>// DFO: cRichEdit.Dfo
77735>>>>>>>>>// DFC: cRichEdit.Dfc
77735>>>>>>>>>
77735>>>>>>>>>// constants used for RichEdit Properties
77735>>>>>>>>>// peAlignment 
77735>>>>>>>>>Enum_List 
77735>>>>>>>>>    Define alLeft   for 1 
77735>>>>>>>>>    Define alRight  for 2 
77735>>>>>>>>>    Define alCenter for 3 
77735>>>>>>>>>End_Enum_List 
77735>>>>>>>>>
77735>>>>>>>>>// peBullets 
77735>>>>>>>>>Enum_List 
77735>>>>>>>>>    Define buNone 
77735>>>>>>>>>    Define buBullets 
77735>>>>>>>>>    Define buArabicNumbers 
77735>>>>>>>>>    Define buLowerLetters 
77735>>>>>>>>>    Define buUpperLetters 
77735>>>>>>>>>    Define buLowerRomans 
77735>>>>>>>>>    Define buUpperRomans 
77735>>>>>>>>>End_Enum_List 
77735>>>>>>>>>
77735>>>>>>>>>// peBulletStyle 
77735>>>>>>>>>Enum_List 
77735>>>>>>>>>    Define busRightParen   for 0 
77735>>>>>>>>>    Define busEncloseParen for 256 
77735>>>>>>>>>    Define busPeriod       for 512 
77735>>>>>>>>>    Define busNumberOnly   for 768 
77735>>>>>>>>>    Define busNoDisplay    for 1024 
77735>>>>>>>>>End_Enum_List
77735>>>>>>>>>    
77735>>>>>>>>>// peLineSpacingType
77735>>>>>>>>>Enum_List 
77735>>>>>>>>>    Define lstSingle
77735>>>>>>>>>    Define lstSingleAndOneHalf
77735>>>>>>>>>    Define lstDouble
77735>>>>>>>>>End_Enum_List
77735>>>>>>>>>
77735>>>>>>>>>Class cRichEdit Is A DFBaseRichEdit
77736>>>>>>>>>
77736>>>>>>>>>    Procedure Construct_Object
77738>>>>>>>>>        Forward Send Construct_Object
77740>>>>>>>>>        Send Define_cEdit_Mixin
77741>>>>>>>>>
77741>>>>>>>>>        On_key Key_Ctrl+Key_B send ToggleBold
77742>>>>>>>>>        On_key Key_Ctrl+Key_I send ToggleItalics
77743>>>>>>>>>        On_key Key_Ctrl+Key_U send ToggleUnderline
77744>>>>>>>>>
77744>>>>>>>>>    End_Procedure // Construct_Object
77745>>>>>>>>>
77745>>>>>>>>>    Import_Class_Protocol cEdit_Mixin
77746>>>>>>>>>    
77746>>>>>>>>>    Procedure ToggleBold
77748>>>>>>>>>        Set pbBold to (not(pbBold(self))) 
77749>>>>>>>>>    end_procedure
77750>>>>>>>>>    
77750>>>>>>>>>    Procedure ToggleItalics
77752>>>>>>>>>        Set pbItalics to (not(pbItalics(self))) 
77753>>>>>>>>>    end_procedure
77754>>>>>>>>>    
77754>>>>>>>>>    Procedure ToggleUnderline
77756>>>>>>>>>       Set pbUnderLine to (not(pbUnderLine(self))) 
77757>>>>>>>>>    end_procedure
77758>>>>>>>>>
77758>>>>>>>>>End_Class
77759>>>>>>>>>
77759>>>>>>>Use sql.pkg
Including file: sql.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\sql.pkg)
77759>>>>>>>>>//*****************************************************************************
77759>>>>>>>>>//*** SQL.pkg                                                               ***
77759>>>>>>>>>//***                                                                       ***
77759>>>>>>>>>//*** Author: Ben Weijers                                                   ***
77759>>>>>>>>>//***         Data Access Wordwide                                          ***
77759>>>>>>>>>//***         14 February 2000                                              ***
77759>>>>>>>>>//***                                                                       ***
77759>>>>>>>>>//*** Purpose:                                                              ***
77759>>>>>>>>>//***   Embedded SQL manager.                                               ***
77759>>>>>>>>>//***                                                                       ***
77759>>>>>>>>>//*** Changes:                                                              ***
77759>>>>>>>>>//***                                                                       ***
77759>>>>>>>>>//***   March 14, 2001. CLI Connectivity Kits 2.0.0.13                      ***
77759>>>>>>>>>//***       Allocate memory before call_driver command with spaces instead  ***
77759>>>>>>>>>//***       of binary zeroes.                                               ***
77759>>>>>>>>>//***                                                                       ***
77759>>>>>>>>>//*****************************************************************************
77759>>>>>>>>>
77759>>>>>>>>>Use UI
77759>>>>>>>>>Use CLI
77759>>>>>>>>>Use Case.mac
77759>>>>>>>>>
77759>>>>>>>>>//Doc/ Ignore=True
77759>>>>>>>>>//*** Global object handle for the manager
77759>>>>>>>>>Integer _embsqlghoSQLHandleMngr
77759>>>>>>>>>
77759>>>>>>>>>//*** Global stroage for results
77759>>>>>>>>>Integer SQLResult
77759>>>>>>>>>
77759>>>>>>>>>//*** Embedded SQL function constants
77759>>>>>>>>>Define FUNC_SQLCONNECT             For 1000000
77759>>>>>>>>>Define FUNC_SQLFILECONNECT         For 1000001
77759>>>>>>>>>Define FUNC_SQLDISCONNECT          For 1000002
77759>>>>>>>>>Define FUNC_SQLOPEN                For 1000003
77759>>>>>>>>>Define FUNC_SQLCLOSE               For 1000004
77759>>>>>>>>>Define FUNC_SQLPREPARE             For 1000005
77759>>>>>>>>>Define FUNC_SQLEXECUTE             For 1000006
77759>>>>>>>>>Define FUNC_SQLEXECDIRECT          For 1000007
77759>>>>>>>>>Define FUNC_SQLFETCH               For 1000008
77759>>>>>>>>>Define FUNC_SQLCOLUMNINFO          For 1000009
77759>>>>>>>>>Define FUNC_SQLCOLUMNVALUE         For 1000010
77759>>>>>>>>>Define FUNC_SQLBINDFILE            For 1000011
77759>>>>>>>>>Define FUNC_SQLGETDATA             For 1000012
77759>>>>>>>>>Define FUNC_SQLCOLSTRINGATTRIBLEN  For 1000013
77759>>>>>>>>>Define FUNC_SQLCOLSTRINGATTRIB     For 1000014
77759>>>>>>>>>Define FUNC_SQLCOLINTATTRIB        For 1000015
77759>>>>>>>>>Define FUNC_SQLSTMTINTATTRIB       For 1000016
77759>>>>>>>>>Define FUNC_SQLSETPROCNAME         For 1000017
77759>>>>>>>>>DEfine FUNC_SQLSETPROCARG          For 1000018
77759>>>>>>>>>Define FUNC_SQLCALL                For 1000019
77759>>>>>>>>>Define FUNC_SQLGETPROCARGLEN       For 1000020
77759>>>>>>>>>Define FUNC_SQLGETPROCARG          For 1000021
77759>>>>>>>>>Define FUNC_SQLGETPROCRETVALLEN    For 1000022
77759>>>>>>>>>Define FUNC_SQLGETPROCRETVAL       For 1000023
77759>>>>>>>>>Define FUNC_SQLNEXTRESULTSET       For 1000024
77759>>>>>>>>>Define FUNC_SQLBUFFERSTATUS        For 1000025
77759>>>>>>>>>
77759>>>>>>>>>//*** Embedded SQL statement attribute constants
77759>>>>>>>>>Define SQLSTMTATTRIB_COLUMNCOUNT    For 1
77759>>>>>>>>>Define SQLSTMTATTRIB_ROWCOUNT       For 2
77759>>>>>>>>>Define SQLSTMTATTRIB_ROWCOUNT_TYPE  For 3
77759>>>>>>>>>
77759>>>>>>>>>//*** Embedded SQL column attribute constants
77759>>>>>>>>>Define SQLCOLATTRIB_SIZE           For 1
77759>>>>>>>>>Define SQLCOLATTRIB_LENGTH         For 1
77759>>>>>>>>>Define SQLCOLATTRIB_PRECISION      For 2
77759>>>>>>>>>Define SQLCOLATTRIB_LABEL          For 3
77759>>>>>>>>>Define SQLCOLATTRIB_BASECOLUMNNAME For 4
77759>>>>>>>>>Define SQLCOLATTRIB_BASETABLENAME  For 5
77759>>>>>>>>>Define SQLCOLATTRIB_SQLTYPE        For 6
77759>>>>>>>>>Define SQLCOLATTRIB_NULLABLE       For 7
77759>>>>>>>>>Define SQLCOLATTRIB_DFTYPE         For 8
77759>>>>>>>>>
77759>>>>>>>>>//*** Possible SQL Column type values
77759>>>>>>>>>Define SQL_UNKNOWN_TYPE   For    0
77759>>>>>>>>>Define SQL_CHAR           For    1
77759>>>>>>>>>Define SQL_NUMERIC        For    2
77759>>>>>>>>>Define SQL_DECIMAL        For    3
77759>>>>>>>>>Define SQL_INTEGER        For    4
77759>>>>>>>>>Define SQL_SMALLINT       For    5
77759>>>>>>>>>Define SQL_FLOAT          For    6
77759>>>>>>>>>Define SQL_REAL           For    7
77759>>>>>>>>>Define SQL_DOUBLE         For    8
77759>>>>>>>>>Define SQL_DATETIME       For    9
77759>>>>>>>>>Define SQL_VARCHAR        For   12
77759>>>>>>>>>Define SQL_TYPE_DATE      For   91
77759>>>>>>>>>Define SQL_TYPE_TIME      For   92
77759>>>>>>>>>Define SQL_TYPE_TIMESTAMP For   93
77759>>>>>>>>>
77759>>>>>>>>>Define SQL_DATE           For    9
77759>>>>>>>>>Define SQL_INTERVAL       For   10
77759>>>>>>>>>Define SQL_TIME           For   10
77759>>>>>>>>>Define SQL_TIMESTAMP      For   11
77759>>>>>>>>>Define SQL_LONGVARCHAR    For  (-1)
77759>>>>>>>>>Define SQL_BINARY         For  (-2)
77759>>>>>>>>>Define SQL_VARBINARY      For  (-3)
77759>>>>>>>>>Define SQL_LONGVARBINARY  For  (-4)
77759>>>>>>>>>Define SQL_BIGINT         For  (-5)
77759>>>>>>>>>Define SQL_TINYINT        For  (-6)
77759>>>>>>>>>Define SQL_BIT            For  (-7)
77759>>>>>>>>>Define SQL_GUID           For (-11)
77759>>>>>>>>>
77759>>>>>>>>>
77759>>>>>>>>>
77759>>>>>>>>>//*****************************************************************************
77759>>>>>>>>>//*** Class  : cSQLStatement                                                ***
77759>>>>>>>>>//*** Purpose: Statement object for embedded sql                            ***
77759>>>>>>>>>//***                                                                       ***
77759>>>>>>>>>//*** Description:                                                          ***
77759>>>>>>>>>//***   An object is created for each statement. These will be children     ***
77759>>>>>>>>>//***   of cSQLConnection objects which manage the create and destruction   ***
77759>>>>>>>>>//***   of these.                                                           ***
77759>>>>>>>>>//*****************************************************************************
77759>>>>>>>>>
77759>>>>>>>>>Class cSQLStatement is an Array
77760>>>>>>>>>
77760>>>>>>>>>    Procedure Construct_object Integer Image
77762>>>>>>>>>        Forward Send Construct_object Image
77764>>>>>>>>>
77764>>>>>>>>>        Property Integer phCLIHandle      public 0
77765>>>>>>>>>        Property String  psDriverID       Public ""
77766>>>>>>>>>        Property Integer phStmtConnection Public 0
77767>>>>>>>>>        Property Integer piLastColumn     Public 0
77768>>>>>>>>>        Property Integer piLastArgument   Public 0
77769>>>>>>>>>        Property Integer piBindFile       Public 0
77770>>>>>>>>>
77770>>>>>>>>>        Set Delegation_mode To NO_Delegation
77771>>>>>>>>>    End_procedure // Construct_object
77772>>>>>>>>>
77772>>>>>>>>>
77772>>>>>>>>>
77772>>>>>>>>>    //***
77772>>>>>>>>>    //*** Procedure: StoreHandleInfo
77772>>>>>>>>>    //*** Purpose  : Store basic information about the statement handle.
77772>>>>>>>>>    //***
77772>>>>>>>>>
77772>>>>>>>>>    Procedure StoreHandleInfo Integer iCLIHandle String sDrvrId Integer iParentHandle
77774>>>>>>>>>        Set phCLIHandle      To iCLIHandle
77775>>>>>>>>>        Set psDriverID       To sDrvrId
77776>>>>>>>>>        Set phStmtConnection To iParentHandle
77777>>>>>>>>>    End_Procedure // StoreHandleInfo
77778>>>>>>>>>
77778>>>>>>>>>
77778>>>>>>>>>
77778>>>>>>>>>    //***
77778>>>>>>>>>    //*** Procedure: FreeHandle
77778>>>>>>>>>    //*** Purpose  : Free a handle. Since a handle is stored in an
77778>>>>>>>>>    //***            cSQLStatement object, we destroy the object.
77778>>>>>>>>>    //***
77778>>>>>>>>>
77778>>>>>>>>>    Procedure FreeHandle
77780>>>>>>>>>        Send Destroy_Object
77781>>>>>>>>>    End_Procedure // FreeHandle
77782>>>>>>>>>
77782>>>>>>>>>
77782>>>>>>>>>
77782>>>>>>>>>    //***
77782>>>>>>>>>    //*** Procedure: HandleError
77782>>>>>>>>>    //*** Puprose  : Handle an error that has occured while checking properties.
77782>>>>>>>>>    //***
77782>>>>>>>>>
77782>>>>>>>>>    Procedure HandleError Integer ihstmt Integer ihdbc String sDrvrId String sOriginMsg
77784>>>>>>>>>        Local Integer iErrHandle
77784>>>>>>>>>        Local Integer iErrNum
77784>>>>>>>>>        Local String  sLocationInfo
77784>>>>>>>>>
77784>>>>>>>>>        //*** Get the DataFlex statement identifier
77784>>>>>>>>>        Move Current_object To iErrHandle
77785>>>>>>>>>
77785>>>>>>>>>        //*** Determine error number
77785>>>>>>>>>        If (ihstmt = 0) ;            Move CLIERR_SQLINVALID_CLI_STMT_HANDLE To iErrNum
77788>>>>>>>>>        Else If (ihdbc = 0) ;            Move CLIERR_SQLINVALID_CLI_CONN_HANDLE To iErrNum
77792>>>>>>>>>        Else If (sDrvrId = "") ;            Move CLIERR_SQLINVALID_DRIVER_ID To iErrNum
77796>>>>>>>>>        Else ;            Move CLIERR_SQL_ERROR To iErrNum
77798>>>>>>>>>
77798>>>>>>>>>        //*** Create location ifnormation
77798>>>>>>>>>        Move "[" To sLocationInfo
77799>>>>>>>>>        If (sOriginMsg <> "") Begin
77801>>>>>>>>>            Move (Append(sLocationInfo, sOriginMsg)) To sLocationInfo
77802>>>>>>>>>            Move (Append(sLocationInfo, ", "))       To sLocationInfo
77803>>>>>>>>>        End
77803>>>>>>>>>>
77803>>>>>>>>>        Move (Append(sLocationInfo, "DataFlex hstmt = ")) To sLocationInfo
77804>>>>>>>>>        Move (Append(sLocationInfo, iErrHandle))          To sLocationInfo
77805>>>>>>>>>        Move (Append(sLocationInfo, "]"))                 To sLocationInfo
77806>>>>>>>>>
77806>>>>>>>>>        //*** Generate the error
77806>>>>>>>>>        Error iErrNum sLocationInfo
77807>>>>>>>>>>
77807>>>>>>>>>    End_Procedure // HandleError
77808>>>>>>>>>
77808>>>>>>>>>
77808>>>>>>>>>
77808>>>>>>>>>    //***
77808>>>>>>>>>    //*** Procedure: StmtError
77808>>>>>>>>>    //*** Purpose  : Handle general error not related to the properties
77808>>>>>>>>>    //***
77808>>>>>>>>>
77808>>>>>>>>>    Procedure StmtError Integer iErrNum String sErrText String sOriginMsg
77810>>>>>>>>>        Local Integer iErrHandle
77810>>>>>>>>>        Local String  sLocationInfo
77810>>>>>>>>>
77810>>>>>>>>>        //*** Get the DataFlex statement identifier
77810>>>>>>>>>        Move Current_object To iErrHandle
77811>>>>>>>>>
77811>>>>>>>>>
77811>>>>>>>>>        //*** Create location information
77811>>>>>>>>>        Move "[" To sLocationInfo
77812>>>>>>>>>        If (sOriginMsg <> "") Begin
77814>>>>>>>>>            Move (Append(sLocationInfo, sOriginMsg)) To sLocationInfo
77815>>>>>>>>>            Move (Append(sLocationInfo, ", "))       To sLocationInfo
77816>>>>>>>>>        End
77816>>>>>>>>>>
77816>>>>>>>>>        If (sErrtext <> "") Begin
77818>>>>>>>>>            Move (Append(sLocationInfo, sErrtext)) To sLocationInfo
77819>>>>>>>>>            Move (Append(sLocationInfo, ", "))     To sLocationInfo
77820>>>>>>>>>        End
77820>>>>>>>>>>
77820>>>>>>>>>        Move (Append(sLocationInfo, "DataFlex hstmt = ")) To sLocationInfo
77821>>>>>>>>>        Move (Append(sLocationInfo, iErrHandle))          To sLocationInfo
77822>>>>>>>>>        Move (Append(sLocationInfo, "]"))                 To sLocationInfo
77823>>>>>>>>>
77823>>>>>>>>>        //*** Generate the error
77823>>>>>>>>>        Error iErrNum sLocationInfo
77824>>>>>>>>>>
77824>>>>>>>>>    End_Procedure // StmtError
77825>>>>>>>>>
77825>>>>>>>>>
77825>>>>>>>>>
77825>>>>>>>>>    //***
77825>>>>>>>>>    //*** Procedure: SQLIllegalAttribute
77825>>>>>>>>>    //*** Purpose  : Handle an illegal attribute error
77825>>>>>>>>>    //***
77825>>>>>>>>>
77825>>>>>>>>>    Procedure SQLIllegalAttribute String sErrText String sOriginMsg
77827>>>>>>>>>        Local Integer bReport
77827>>>>>>>>>
77827>>>>>>>>>        Get_attribute DF_REPORT_UNSUPPORTED_ATTRIBUTES To bReport
77830>>>>>>>>>        If (bReport) ;            Send StmtError CLIERR_SQLINVALID_ATTRIBUTE sErrtext sOriginMsg
77833>>>>>>>>>    End_Procedure // SQLIllegalAttribute
77834>>>>>>>>>
77834>>>>>>>>>
77834>>>>>>>>>
77834>>>>>>>>>    //***
77834>>>>>>>>>    //*** Function: SQLPrivateColumnIsLegal
77834>>>>>>>>>    //*** Purpose : Check if a column number is legal
77834>>>>>>>>>    //***
77834>>>>>>>>>
77834>>>>>>>>>    Function SQLPrivateColumnIsLegal Integer ihdbc String sDrvrId Integer ihstmt Integer iCol Returns Integer
77836>>>>>>>>>        Local Integer bLegal
77836>>>>>>>>>        Local Integer iNumColumns
77836>>>>>>>>>
77836>>>>>>>>>        Get SQLPrivateStmtAttribute SQLSTMTATTRIB_COLUMNCOUNT ihdbc sDrvrId ihstmt To iNumColumns
77837>>>>>>>>>        If (iCol > 0 And iCol <= iNumColumns) ;            Move DFTRUE To bLegal
77840>>>>>>>>>        Else ;            Move DFFALSE To bLegal
77842>>>>>>>>>
77842>>>>>>>>>        Function_Return bLegal
77843>>>>>>>>>    End_Function // SQLPrivateColumnIsLegal
77844>>>>>>>>>
77844>>>>>>>>>
77844>>>>>>>>>
77844>>>>>>>>>    //***
77844>>>>>>>>>    //*** Procedure: SQLClose
77844>>>>>>>>>    //*** Purpose  : Close a statement and free all alllocated resources
77844>>>>>>>>>    //***
77844>>>>>>>>>
77844>>>>>>>>>    Procedure SQLClose
77846>>>>>>>>>        Local Integer ihdbc
77846>>>>>>>>>        Local Integer ihstmt
77846>>>>>>>>>        Local Integer iVoid
77846>>>>>>>>>        Local String  sDrvrId
77846>>>>>>>>>        Local String  sEmpty
77846>>>>>>>>>
77846>>>>>>>>>        //*** Initialize
77846>>>>>>>>>        Move "" To sEmpty
77847>>>>>>>>>
77847>>>>>>>>>        //*** Get the cli handle to the connection
77847>>>>>>>>>        Get phCLIHandle        To ihstmt
77848>>>>>>>>>        Get psDriverId         To sDrvrId
77849>>>>>>>>>        Get phStmtConnection   To ihdbc
77850>>>>>>>>>
77850>>>>>>>>>        //*** Free the CLI handle
77850>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77852>>>>>>>>>            //*** Call the driver function to close
77852>>>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCLOSE ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt ;                        Result iVoid
77857>>>>>>>>>
77857>>>>>>>>>            //*** Free the DataFlex handle
77857>>>>>>>>>            Send FreeHandle
77858>>>>>>>>>        End
77858>>>>>>>>>>
77858>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLClose"
77860>>>>>>>>>    End_procedure // SQLClose
77861>>>>>>>>>
77861>>>>>>>>>
77861>>>>>>>>>
77861>>>>>>>>>    //***
77861>>>>>>>>>    //*** Procedure: SQLPrepare
77861>>>>>>>>>    //*** Purpose  : Prepare a statement for execution
77861>>>>>>>>>    //***
77861>>>>>>>>>
77861>>>>>>>>>    Procedure SQLPrepare String sStatement
77863>>>>>>>>>        Local Integer ihdbc
77863>>>>>>>>>        Local Integer ihstmt
77863>>>>>>>>>        Local Integer iVoid
77863>>>>>>>>>        Local String  sDrvrId
77863>>>>>>>>>
77863>>>>>>>>>        //*** Get the cli handle to the connection
77863>>>>>>>>>        Get phCLIHandle       To ihstmt
77864>>>>>>>>>        Get psDriverId        To sDrvrId
77865>>>>>>>>>        Get phStmtConnection  To ihdbc
77866>>>>>>>>>
77866>>>>>>>>>        //*** Prepare
77866>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77868>>>>>>>>>            //*** Call the driver function to prepare
77868>>>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLPREPARE ;                        Callback Current_Object ;                        Passing ihdbc sStatement ihstmt ;                        Result iVoid
77873>>>>>>>>>        End
77873>>>>>>>>>>
77873>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrepare"
77875>>>>>>>>>    End_procedure // SQLPrepare
77876>>>>>>>>>
77876>>>>>>>>>
77876>>>>>>>>>
77876>>>>>>>>>    //***
77876>>>>>>>>>    //*** Procedure: SQLExecute
77876>>>>>>>>>    //*** Purpose  : Execute a prepared statement
77876>>>>>>>>>    //***
77876>>>>>>>>>
77876>>>>>>>>>    Procedure SQLExecute
77878>>>>>>>>>        Local Integer ihdbc
77878>>>>>>>>>        Local Integer ihstmt
77878>>>>>>>>>        Local Integer iVoid
77878>>>>>>>>>        Local String  sDrvrId
77878>>>>>>>>>        Local String  sEmpty
77878>>>>>>>>>
77878>>>>>>>>>        //*** Initialize
77878>>>>>>>>>        Move "" To sEmpty
77879>>>>>>>>>
77879>>>>>>>>>        //*** Get the cli handle to the connection
77879>>>>>>>>>        Get phCLIHandle       To ihstmt
77880>>>>>>>>>        Get psDriverId        To sDrvrId
77881>>>>>>>>>        Get phStmtConnection  To ihdbc
77882>>>>>>>>>
77882>>>>>>>>>        //*** Execute
77882>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77884>>>>>>>>>            //*** Call the driver function to execute
77884>>>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLEXECUTE ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt ;                        Result iVoid
77889>>>>>>>>>        End
77889>>>>>>>>>>
77889>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLExecute"
77891>>>>>>>>>    End_Procedure // SQLExecute
77892>>>>>>>>>
77892>>>>>>>>>
77892>>>>>>>>>
77892>>>>>>>>>    //***
77892>>>>>>>>>    //*** Procedure: SQLExecDirect
77892>>>>>>>>>    //*** Purpose  : Prepare and execute a statement
77892>>>>>>>>>    //***
77892>>>>>>>>>
77892>>>>>>>>>    Procedure SQLExecDirect String sStatement
77894>>>>>>>>>        Local Integer ihdbc
77894>>>>>>>>>        Local Integer ihstmt
77894>>>>>>>>>        Local Integer iVoid
77894>>>>>>>>>        Local String  sDrvrId
77894>>>>>>>>>
77894>>>>>>>>>        //*** Get the cli handle to the connection
77894>>>>>>>>>        Get phCLIHandle        To ihstmt
77895>>>>>>>>>        Get psDriverId         To sDrvrId
77896>>>>>>>>>        Get phStmtConnection   To ihdbc
77897>>>>>>>>>
77897>>>>>>>>>        //*** ExecDirect
77897>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77899>>>>>>>>>            //*** Call the driver function to execdirect
77899>>>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLEXECDIRECT ;                        Callback Current_Object ;                        Passing ihdbc sStatement ihstmt ;                        Result iVoid
77904>>>>>>>>>        End
77904>>>>>>>>>>
77904>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLExecDirect"
77906>>>>>>>>>    End_procedure // SQLExecDirect
77907>>>>>>>>>
77907>>>>>>>>>
77907>>>>>>>>>
77907>>>>>>>>>    //***
77907>>>>>>>>>    //*** Procedure: SQLFetch
77907>>>>>>>>>    //*** Purpose  : Fetch the next row
77907>>>>>>>>>    //*** Returns  : 0   = No more data
77907>>>>>>>>>    //***            <>0 = Success
77907>>>>>>>>>    //***
77907>>>>>>>>>
77907>>>>>>>>>    Function SQLFetch Returns Integer
77909>>>>>>>>>        Local Integer ihdbc
77909>>>>>>>>>        Local Integer ihstmt
77909>>>>>>>>>        Local Integer iResult
77909>>>>>>>>>        Local String  sDrvrId
77909>>>>>>>>>        Local String  sEmpty
77909>>>>>>>>>
77909>>>>>>>>>        //*** Initialize
77909>>>>>>>>>        Move "" To sEmpty
77910>>>>>>>>>        Move 0  To iResult
77911>>>>>>>>>
77911>>>>>>>>>        //*** Get the cli handle to the connection
77911>>>>>>>>>        Get phCLIHandle        To ihstmt
77912>>>>>>>>>        Get psDriverId         To sDrvrId
77913>>>>>>>>>        Get phStmtConnection   To ihdbc
77914>>>>>>>>>
77914>>>>>>>>>        //*** Fetch
77914>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77916>>>>>>>>>            Indicate Err False
77917>>>>>>>>>
77917>>>>>>>>>            //*** Call the driver function to fetch
77917>>>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLFETCH ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt ;                        Result iResult
77922>>>>>>>>>
77922>>>>>>>>>            //*** If something went wrong, adjust the result
77922>>>>>>>>>            If (Err) ;                Move 0 To iResult
77925>>>>>>>>>
77925>>>>>>>>>            Set piLastcolumn To 0
77926>>>>>>>>>        End
77926>>>>>>>>>>
77926>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLFetch"
77928>>>>>>>>>
77928>>>>>>>>>        Function_return iResult
77929>>>>>>>>>    End_Function // SQLFetch
77930>>>>>>>>>
77930>>>>>>>>>
77930>>>>>>>>>
77930>>>>>>>>>    //***
77930>>>>>>>>>    //*** Function: SQLNextColumn
77930>>>>>>>>>    //*** Purpose : Get the next column
77930>>>>>>>>>    //***
77930>>>>>>>>>
77930>>>>>>>>>    Function SQLNextColumn Returns String
77932>>>>>>>>>        Local Integer iCol
77932>>>>>>>>>        Local String  sResult
77932>>>>>>>>>
77932>>>>>>>>>        Get piLastColumn To iCol
77933>>>>>>>>>        Increment iCol
77934>>>>>>>>>        Get SQLColumnValue iCol To sResult
77935>>>>>>>>>        Set piLastColumn To iCol
77936>>>>>>>>>
77936>>>>>>>>>        Function_return sResult
77937>>>>>>>>>    End_Function // SQLNextColumn
77938>>>>>>>>>
77938>>>>>>>>>
77938>>>>>>>>>
77938>>>>>>>>>    //***
77938>>>>>>>>>    //*** Function: SQLColumnValue
77938>>>>>>>>>    //*** Purpose : Return the value of a column in a fetched row of a given
77938>>>>>>>>>    //***           statement.
77938>>>>>>>>>    //***
77938>>>>>>>>>
77938>>>>>>>>>    Function SQLColumnValue Integer iCol Returns String
77940>>>>>>>>>        Local Integer ihdbc
77940>>>>>>>>>        Local Integer ihstmt
77940>>>>>>>>>        Local String  sDrvrId
77940>>>>>>>>>        Local String  sResult
77940>>>>>>>>>
77940>>>>>>>>>        //*** Initialize
77940>>>>>>>>>        Move "" To sResult
77941>>>>>>>>>
77941>>>>>>>>>        //*** Get the cli handle to the connection
77941>>>>>>>>>        Get phCLIHandle       To ihstmt
77942>>>>>>>>>        Get psDriverId        To sDrvrId
77943>>>>>>>>>        Get phStmtConnection  To ihdbc
77944>>>>>>>>>
77944>>>>>>>>>        //*** Get the value
77944>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") ;            Get SQLPrivateColumnValue iCol ihdbc sDRvrId ihstmt To sResult
77947>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLColumnValue"
77949>>>>>>>>>
77949>>>>>>>>>        Function_return sResult
77950>>>>>>>>>    End_Function // SQLColumnValue
77951>>>>>>>>>
77951>>>>>>>>>    Function SQLPrivateColumnValue Integer iCol Integer ihdbc String sDrvrId Integer ihstmt Returns String
77953>>>>>>>>>        Local Integer iVoid
77953>>>>>>>>>        Local Integer iColSize
77953>>>>>>>>>        Local String  sResult
77953>>>>>>>>>        Local String  sEmpty
77953>>>>>>>>>        Local Integer bLegalColumn
77953>>>>>>>>>
77953>>>>>>>>>        //*** Initialize
77953>>>>>>>>>        Move "" To sEmpty
77954>>>>>>>>>
77954>>>>>>>>>        //*** Get the value
77954>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77956>>>>>>>>>            //*** Check if the column exists
77956>>>>>>>>>            Get SQLPrivateColumnIsLegal ihdbc sDrvrId ihstmt iCol To bLegalColumn
77957>>>>>>>>>            If (bLegalColumn) Begin
77959>>>>>>>>>                //*** Determine the column size
77959>>>>>>>>>                Get SQLPrivateColAttribute iCol SQLCOLATTRIB_SIZE ihdbc sDrvrId ihstmt To iColSize
77960>>>>>>>>>                If (iColSize > 0) Begin
77962>>>>>>>>>                    //*** Setup function arguments
77962>>>>>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                                Callback Current_Object ;                                Passing ihdbc iCol ihstmt ;                                Result iVoid
77967>>>>>>>>>
77967>>>>>>>>>                    //*** Allocate
77967>>>>>>>>>                    Move (Repeat(' ', iColSize)) To sResult
77968>>>>>>>>>
77968>>>>>>>>>                    //*** Call the driver function to get the value
77968>>>>>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNVALUE ;                                Callback Current_Object ;                                Passing sResult sEmpty 0 ;                                Result iVoid
77973>>>>>>>>>                End
77973>>>>>>>>>>
77973>>>>>>>>>            End
77973>>>>>>>>>>
77973>>>>>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLPrivateColumnValue"
77975>>>>>>>>>        End
77975>>>>>>>>>>
77975>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrivateColumnValue"
77977>>>>>>>>>
77977>>>>>>>>>        Function_return sResult
77978>>>>>>>>>    End_Function // SQLColumnValue
77979>>>>>>>>>
77979>>>>>>>>>
77979>>>>>>>>>
77979>>>>>>>>>    //***
77979>>>>>>>>>    //*** Procedure: SQLBindFile
77979>>>>>>>>>    //*** Purpose  : Add a file to the files used to place the statement result in.
77979>>>>>>>>>    //***
77979>>>>>>>>>
77979>>>>>>>>>    Procedure SQLBindFile Integer iFileNum
77981>>>>>>>>>        Local Integer ihdbc
77981>>>>>>>>>        Local Integer ihstmt
77981>>>>>>>>>        Local Integer iVoid
77981>>>>>>>>>        Local String  sDrvrId
77981>>>>>>>>>        Local String  sFileType
77981>>>>>>>>>        Local Integer bIsOpen
77981>>>>>>>>>
77981>>>>>>>>>        //*** Get the cli handle to the connection
77981>>>>>>>>>        Get phCLIHandle       To ihstmt
77982>>>>>>>>>        Get psDriverId        To sDrvrId
77983>>>>>>>>>        Get phStmtConnection  To ihdbc
77984>>>>>>>>>
77984>>>>>>>>>        //*** If a file number is not passed see if we can use the statement's
77984>>>>>>>>>        //*** default file number which is usually set with SetFileConnection
77984>>>>>>>>>        If (iFileNum = 0) Begin
77986>>>>>>>>>            Get piBindFile To iFileNum
77987>>>>>>>>>            If (iFileNum = 0) Begin
77989>>>>>>>>>                //*** Logic error, if 0 is passed as filenumber, piBindFile should be set.
77989>>>>>>>>>                Send StmtError CLIERR_SQLINVALID_BIND_FILE "piBindFile should be set" "SQLBindFile"
77990>>>>>>>>>
77990>>>>>>>>>                Move 0 to SQLResult
77991>>>>>>>>>                Procedure_Return
77992>>>>>>>>>            End
77992>>>>>>>>>>
77992>>>>>>>>>        End
77992>>>>>>>>>>
77992>>>>>>>>>
77992>>>>>>>>>        //*** Bind the file
77992>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77994>>>>>>>>>            //*** Chek if the file is open
77994>>>>>>>>>            Get_attribute DF_FILE_OPENED Of iFileNum To bIsOpen
77997>>>>>>>>>            If (bIsOpen) Begin
77999>>>>>>>>>                //*** Check if the file has the correct type
77999>>>>>>>>>                Get_attribute DF_FILE_DRIVER Of iFileNum To sFileType
78002>>>>>>>>>                If (sFileType = sDrvrId) Begin
78004>>>>>>>>>                    //*** Call the driver function to add a file to a statement
78004>>>>>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLBINDFILE ;                                Callback Current_Object ;                                Passing ihdbc iFileNum ihstmt ;                                Result iVoid
78009>>>>>>>>>                End
78009>>>>>>>>>>
78009>>>>>>>>>                Else ;                    Send StmtError CLIERR_SQLINVALID_BIND_FILE ("File" * String(iFileNum) * "type incompatible with statement ("  + sFileType + ")") "SQLBindFile"
78011>>>>>>>>>            End
78011>>>>>>>>>>
78011>>>>>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_BIND_FILE ("File not open (number =" * String(iFileNum) + ")") "SQLBindFile"
78013>>>>>>>>>        End
78013>>>>>>>>>>
78013>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLBindFile"
78015>>>>>>>>>    End_Procedure // SQLBindFile
78016>>>>>>>>>
78016>>>>>>>>>
78016>>>>>>>>>
78016>>>>>>>>>    //*************************************************************************
78016>>>>>>>>>    //*** Function: SQLGetData                                              ***
78016>>>>>>>>>    //*** Purpose : Get data of a column.                                   ***
78016>>>>>>>>>    //*************************************************************************
78016>>>>>>>>>
78016>>>>>>>>>    Function SQLGetData Integer iCol Integer iLen Returns String
78018>>>>>>>>>        Local Integer ihdbc
78018>>>>>>>>>        Local Integer ihstmt
78018>>>>>>>>>        Local Integer iVoid
78018>>>>>>>>>        Local Integer iColSize
78018>>>>>>>>>        Local Integer iResult
78018>>>>>>>>>        Local String  sDrvrId
78018>>>>>>>>>        Local String  sResult
78018>>>>>>>>>        Local String  sEmpty
78018>>>>>>>>>        Local Integer bLegalColumn
78018>>>>>>>>>
78018>>>>>>>>>        //*** Initialize
78018>>>>>>>>>        Move "" To sEmpty
78019>>>>>>>>>        Move 0 To iResult
78020>>>>>>>>>
78020>>>>>>>>>        //*** Get the cli handle to the connection
78020>>>>>>>>>        Get phCLIHandle       To ihstmt
78021>>>>>>>>>        Get psDriverId        To sDrvrId
78022>>>>>>>>>        Get phStmtConnection  To ihdbc
78023>>>>>>>>>
78023>>>>>>>>>        //*** Get the data
78023>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
78025>>>>>>>>>            //*** Check if the column exists
78025>>>>>>>>>            Get SQLPrivateColumnIsLegal ihdbc sDrvrId ihstmt iCol To bLegalColumn
78026>>>>>>>>>            If (bLegalColumn) Begin
78028>>>>>>>>>                If (iLen = 0) ;                    Get SQLPrivateColumnValue iCol ihdbc sDrvrId ihstmt To sResult
78031>>>>>>>>>                Else Begin
78032>>>>>>>>>                    //*** Setup function arguments
78032>>>>>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                                Callback Current_Object ;                                Passing ihdbc iCol ihstmt ;                                Result iVoid
78037>>>>>>>>>
78037>>>>>>>>>                    //*** Allocate
78037>>>>>>>>>                    Move (Repeat(' ', iLen)) To sResult
78038>>>>>>>>>
78038>>>>>>>>>                    Indicate Err False
78039>>>>>>>>>
78039>>>>>>>>>                    //*** Call the driver function to get the data
78039>>>>>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLGETDATA ;                                Callback Current_Object ;                                Passing sResult sEmpty iLen ;                                Result iResult
78044>>>>>>>>>
78044>>>>>>>>>                    //*** If something went wrong, adjust the result
78044>>>>>>>>>                    If (Err) ;                        Move 0 To iResult
78047>>>>>>>>>                End
78047>>>>>>>>>>
78047>>>>>>>>>            End
78047>>>>>>>>>>
78047>>>>>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLGetData"
78049>>>>>>>>>        End
78049>>>>>>>>>>
78049>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLGetData"
78051>>>>>>>>>
78051>>>>>>>>>        //*** Fill global result
78051>>>>>>>>>        Move iResult To SQLResult
78052>>>>>>>>>
78052>>>>>>>>>        Function_Return sResult
78053>>>>>>>>>    End_Function // SQLGetData
78054>>>>>>>>>
78054>>>>>>>>>
78054>>>>>>>>>
78054>>>>>>>>>    //***
78054>>>>>>>>>    //*** Function: SQLColumnMap
78054>>>>>>>>>    //*** Purpose : Map a column name to a number, if the name id not found no
78054>>>>>>>>>    //***           error is generated the returned number will be 0 (zero) in
78054>>>>>>>>>    //***           that case
78054>>>>>>>>>    //***
78054>>>>>>>>>
78054>>>>>>>>>    Function SQLColumnMap String sColname Returns Integer
78056>>>>>>>>>        Local Integer ihdbc
78056>>>>>>>>>        Local Integer ihstmt
78056>>>>>>>>>        Local Integer iNumColumns
78056>>>>>>>>>        Local Integer iColCount
78056>>>>>>>>>        Local Integer iColNum
78056>>>>>>>>>        Local String  sDrvrId
78056>>>>>>>>>        Local String  sCurColName
78056>>>>>>>>>
78056>>>>>>>>>        //*** Get the cli handle to the connection
78056>>>>>>>>>        Get phCLIHandle       To ihstmt
78057>>>>>>>>>        Get psDriverId        To sDrvrId
78058>>>>>>>>>        Get phStmtConnection  To ihdbc
78059>>>>>>>>>
78059>>>>>>>>>        //*** Get the number by looping through the column names
78059>>>>>>>>>        Move 0 To iColNum
78060>>>>>>>>>        Get SQLPrivateStmtAttribute SQLSTMTATTRIB_COLUMNCOUNT ihdbc sDrvrId ihstmt To iNumColumns
78061>>>>>>>>>        For iColCount From 1 To iNumColumns
78067>>>>>>>>>>
78067>>>>>>>>>            Get SQLPrivateColAttribute iColCount SQLCOLATTRIB_LABEL ihdbc sDrvrId ihstmt To sCurColName
78068>>>>>>>>>            If (Uppercase(Trim(sColName)) = Uppercase(Trim(sCurColName))) ;                Move iColCount To iColNum
78071>>>>>>>>>
78071>>>>>>>>>            If (iColNum) ;                Break
78074>>>>>>>>>        Loop
78075>>>>>>>>>>
78075>>>>>>>>>
78075>>>>>>>>>        Function_return iColNum
78076>>>>>>>>>    End_Function // SQLColumnMap
78077>>>>>>>>>
78077>>>>>>>>>
78077>>>>>>>>>
78077>>>>>>>>>    //***
78077>>>>>>>>>    //*** Function: SQLStmtAttribute
78077>>>>>>>>>    //*** Purpose : Get a statement attribute
78077>>>>>>>>>    //***
78077>>>>>>>>>
78077>>>>>>>>>    Function SQLStmtAttribute Integer iAttribId Returns String
78079>>>>>>>>>        Local Integer ihdbc
78079>>>>>>>>>        Local Integer ihstmt
78079>>>>>>>>>        Local String  sResult
78079>>>>>>>>>        Local String  sDrvrId
78079>>>>>>>>>
78079>>>>>>>>>        //*** Initialize
78079>>>>>>>>>        Move "" To sResult
78080>>>>>>>>>
78080>>>>>>>>>        //*** Get the cli handle to the connection
78080>>>>>>>>>        Get phCLIHandle       To ihstmt
78081>>>>>>>>>        Get psDriverId        To sDrvrId
78082>>>>>>>>>        Get phStmtConnection  To ihdbc
78083>>>>>>>>>
78083>>>>>>>>>        //*** Get the attribute
78083>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") ;            Get SQLPrivateStmtAttribute iAttribId ihdbc sDrvrId ihstmt To sResult
78086>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLStmtAttribute"
78088>>>>>>>>>
78088>>>>>>>>>        Function_Return sResult
78089>>>>>>>>>    End_Function // SQLStmtAttibute
78090>>>>>>>>>
78090>>>>>>>>>    Function SQLPrivateStmtAttribute Integer iAttribId Integer ihdbc String sDrvrId Integer ihstmt Returns String
78092>>>>>>>>>        Local String  sResult
78092>>>>>>>>>        Local Integer iLen
78092>>>>>>>>>        Local Integer bLegalAttrib
78092>>>>>>>>>
78092>>>>>>>>>        //*** Initialize
78092>>>>>>>>>        Move ""     To sResult
78093>>>>>>>>>
78093>>>>>>>>>        //*** Get the attribute
78093>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
78095>>>>>>>>>            Case Begin
78095>>>>>>>>>                Case (iAttribId = SQLSTMTATTRIB_COLUMNCOUNT)
78097>>>>>>>>>                Case (iAttribId = SQLSTMTATTRIB_ROWCOUNT)
78100>>>>>>>>>                Case (iAttribId = SQLSTMTATTRIB_ROWCOUNT_TYPE)
78103>>>>>>>>>                    Move DFTRUE To bLegalAttrib
78104>>>>>>>>>                    Break
78105>>>>>>>>>
78105>>>>>>>>>                Case Else
78105>>>>>>>>>                    Move DFFALSE To bLegalAttrib
78106>>>>>>>>>                    Send SQLIllegalAttribute ("Attribute is = " + String(iAttribId) + ")") "SQLPrivateStmtAttribute"
78107>>>>>>>>>            Case End
78107>>>>>>>>>
78107>>>>>>>>>            If (bLegalAttrib) Begin
78109>>>>>>>>>                //*** Setup function arguments
78109>>>>>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLSTMTINTATTRIB ;                            Callback Current_Object ;                            Passing ihdbc iAttribId ihstmt ;                            Result sResult
78114>>>>>>>>>            End
78114>>>>>>>>>>
78114>>>>>>>>>        End
78114>>>>>>>>>>
78114>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrivateStmtAttribute"
78116>>>>>>>>>
78116>>>>>>>>>        Function_Return sResult
78117>>>>>>>>>    End_Function // SQLPrivateStmtAttribute
78118>>>>>>>>>
78118>>>>>>>>>
78118>>>>>>>>>
78118>>>>>>>>>    //***
78118>>>>>>>>>    //*** Function: SQLColAttribute
78118>>>>>>>>>    //*** Purpose : Get a column's attribute
78118>>>>>>>>>    //***
78118>>>>>>>>>
78118>>>>>>>>>    Function SQLColAttribute Integer iCol Integer iAttribId Returns String
78120>>>>>>>>>        Local Integer ihdbc
78120>>>>>>>>>        Local Integer ihstmt
78120>>>>>>>>>        Local String  sResult
78120>>>>>>>>>        Local String  sDrvrId
78120>>>>>>>>>
78120>>>>>>>>>        //*** Initialize
78120>>>>>>>>>        Move "" To sResult
78121>>>>>>>>>
78121>>>>>>>>>        //*** Get the cli handle to the connection
78121>>>>>>>>>        Get phCLIHandle       To ihstmt
78122>>>>>>>>>        Get psDriverId        To sDrvrId
78123>>>>>>>>>        Get phStmtConnection  To ihdbc
78124>>>>>>>>>
78124>>>>>>>>>        //*** Get the attribute
78124>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") ;            Get SQLPrivateColAttribute iCol iAttribId ihdbc sDrvrId ihstmt To sResult
78127>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLColAttribute"
78129>>>>>>>>>
78129>>>>>>>>>        Function_Return sResult
78130>>>>>>>>>    End_Function // SQLColAttribute
78131>>>>>>>>>
78131>>>>>>>>>    Function SQLPrivateColAttribute Integer iCol Integer iAttribId Integer ihdbc String sDrvrId Integer ihstmt Returns String
78133>>>>>>>>>        Local String  sResult
78133>>>>>>>>>        Local String  sEmpty
78133>>>>>>>>>        Local Integer bIsStringAttribute
78133>>>>>>>>>        Local Integer iLen
78133>>>>>>>>>        Local Integer iVoid
78133>>>>>>>>>        Local Integer bLegalAttrib
78133>>>>>>>>>        Local Integer bLegalColumn
78133>>>>>>>>>
78133>>>>>>>>>        //*** Initialize
78133>>>>>>>>>        Move "" To sResult
78134>>>>>>>>>        Move "" To sEmpty
78135>>>>>>>>>        MOve 0  To iLen
78136>>>>>>>>>
78136>>>>>>>>>        //*** Get the attribute
78136>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
78138>>>>>>>>>            Get SQLPrivateColumnIsLegal ihdbc sDrvrId ihstmt iCol To bLegalColumn
78139>>>>>>>>>            If (bLegalColumn) Begin
78141>>>>>>>>>                //*** Determine the atributes type
78141>>>>>>>>>                Case Begin
78141>>>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_SIZE)
78143>>>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_LENGTH)
78146>>>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_PRECISION)
78149>>>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_SQLTYPE)
78152>>>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_NULLABLE)
78155>>>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_DFTYPE)
78158>>>>>>>>>                        Move DFFALSE To bIsStringAttribute
78159>>>>>>>>>                        Move DFTRUE To bLegalAttrib
78160>>>>>>>>>                        Break
78161>>>>>>>>>
78161>>>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_LABEL)
78164>>>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_BASECOLUMNNAME)
78167>>>>>>>>>                    Case (iAttribId = SQLCOLATTRIB_BASETABLENAME)
78170>>>>>>>>>                        Move DFTRUE To bIsStringAttribute
78171>>>>>>>>>                        Move DFTRUE To bLegalAttrib
78172>>>>>>>>>                        Break
78173>>>>>>>>>
78173>>>>>>>>>                    Case Else
78173>>>>>>>>>                        Move DFFALSE To bLegalAttrib
78174>>>>>>>>>                        Send SQLIllegalAttribute ("Attribute is = " + String(iAttribId) + ")") "SQLPrivateColAttribute"
78175>>>>>>>>>                Case End
78175>>>>>>>>>
78175>>>>>>>>>                If (bLegalAttrib) Begin
78177>>>>>>>>>                    //*** Setup function arguments
78177>>>>>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                                Callback Current_Object ;                                Passing ihdbc iCol ihstmt ;                                Result iVoid
78182>>>>>>>>>
78182>>>>>>>>>                    If (bIsStringAttribute) Begin
78184>>>>>>>>>                        //*** Call the driver function to get the data length
78184>>>>>>>>>                        Call_driver 0 sDrvrId Function FUNC_SQLCOLSTRINGATTRIBLEN ;                                    Callback Current_Object ;                                    Passing sEmpty sEmpty iAttribId ;                                    Result iLen
78189>>>>>>>>>
78189>>>>>>>>>                        If (iLen) Begin
78191>>>>>>>>>                            //*** Allocate
78191>>>>>>>>>                            Move (Repeat(' ', iLen)) To sResult
78192>>>>>>>>>
78192>>>>>>>>>                            //*** Call the driver function to get the name
78192>>>>>>>>>                            Call_driver 0 sDrvrId Function FUNC_SQLCOLSTRINGATTRIB ;                                        Callback Current_Object ;                                        Passing sResult sEmpty iAttribId ;                                        Result iVoid
78197>>>>>>>>>                        End
78197>>>>>>>>>>
78197>>>>>>>>>                    End
78197>>>>>>>>>>
78197>>>>>>>>>                    Else Begin
78198>>>>>>>>>                        //*** get the attribute
78198>>>>>>>>>                        Call_driver 0 sDrvrId Function FUNC_SQLCOLINTATTRIB ;                                    Callback Current_Object ;                                    Passing sEmpty sEmpty iAttribId ;                                    Result sResult
78203>>>>>>>>>                    End
78203>>>>>>>>>>
78203>>>>>>>>>                End
78203>>>>>>>>>>
78203>>>>>>>>>            End
78203>>>>>>>>>>
78203>>>>>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLPrivateColAttribute"
78205>>>>>>>>>        End
78205>>>>>>>>>>
78205>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrivateColAttribute"
78207>>>>>>>>>
78207>>>>>>>>>        Function_Return sResult
78208>>>>>>>>>    End_Function // SQLPrivateColAttribute
78209>>>>>>>>>
78209>>>>>>>>>
78209>>>>>>>>>
78209>>>>>>>>>    //***
78209>>>>>>>>>    //*** Procedure: SQLSetProcedureName
78209>>>>>>>>>    //*** Purpsoe  : Preapre for calling a stored procedure, pass the procedure name.
78209>>>>>>>>>    //***
78209>>>>>>>>>
78209>>>>>>>>>    Procedure SQLSetProcedureName String sProcName
78211>>>>>>>>>        Local Integer ihdbc
78211>>>>>>>>>        Local Integer ihstmt
78211>>>>>>>>>        Local String  sDrvrId
78211>>>>>>>>>        Local Integer iVoid
78211>>>>>>>>>        Local String  sEmpty
78211>>>>>>>>>
78211>>>>>>>>>        //*** Initialize
78211>>>>>>>>>        Move "" To sEmpty
78212>>>>>>>>>
78212>>>>>>>>>        //*** Get the cli handle to the connection
78212>>>>>>>>>        Get phCLIHandle       To ihstmt
78213>>>>>>>>>        Get psDriverId        To sDrvrId
78214>>>>>>>>>        Get phStmtConnection  To ihdbc
78215>>>>>>>>>
78215>>>>>>>>>        //*** Call the procedure
78215>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
78217>>>>>>>>>            //*** Call the procedure
78217>>>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLSETPROCNAME ;                        Callback Current_Object ;                        Passing ihdbc sProcName ihstmt ;                        Result iVoid
78222>>>>>>>>>
78222>>>>>>>>>            Set piLastArgument To 0
78223>>>>>>>>>        End
78223>>>>>>>>>>
78223>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLSetProcedurename"
78225>>>>>>>>>    End_Procedure // SQLSetProcedureName
78226>>>>>>>>>
78226>>>>>>>>>
78226>>>>>>>>>
78226>>>>>>>>>    //***
78226>>>>>>>>>    //*** Function: SQLSetNextArgument
78226>>>>>>>>>    //*** Purpose : Pass the next argument
78226>>>>>>>>>    //***
78226>>>>>>>>>
78226>>>>>>>>>    Procedure SQLSetNextArgument String sArgument
78228>>>>>>>>>        Local Integer iArgnum
78228>>>>>>>>>
78228>>>>>>>>>        Get piLastArgument To iArgnum
78229>>>>>>>>>        Increment iArgnum
78230>>>>>>>>>        Send SQLSetArgument iArgnum sArgument
78231>>>>>>>>>        Set piLastArgument To iArgnum
78232>>>>>>>>>    End_Procedure // SQLSetNextArgument
78233>>>>>>>>>
78233>>>>>>>>>
78233>>>>>>>>>
78233>>>>>>>>>    //***
78233>>>>>>>>>    //*** Procedure: SQLSetArgument
78233>>>>>>>>>    //*** Purpose  : Set the next argument
78233>>>>>>>>>    //***
78233>>>>>>>>>
78233>>>>>>>>>    Procedure SQLSetArgument Integer iArgnum String sArgument
78235>>>>>>>>>        Local Integer ihdbc
78235>>>>>>>>>        Local Integer ihstmt
78235>>>>>>>>>        Local String  sDrvrId
78235>>>>>>>>>        Local Integer iVoid
78235>>>>>>>>>        Local String  sEmpty
78235>>>>>>>>>
78235>>>>>>>>>        //*** Initialize
78235>>>>>>>>>        Move "" To sEmpty
78236>>>>>>>>>
78236>>>>>>>>>        //*** Get the cli handle to the connection
78236>>>>>>>>>        Get phCLIHandle       To ihstmt
78237>>>>>>>>>        Get psDriverId        To sDrvrId
78238>>>>>>>>>        Get phStmtConnection  To ihdbc
78239>>>>>>>>>
78239>>>>>>>>>        //*** Call the procedure
78239>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
78241>>>>>>>>>            //*** Pass the information
78241>>>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                        Callback Current_Object ;                        Passing ihdbc iArgnum ihstmt ;                        Result iVoid
78246>>>>>>>>>
78246>>>>>>>>>            //*** Pass the argument
78246>>>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLSETPROCARG ;                        Callback Current_Object ;                        Passing sArgument sEmpty 0 ;                        Result iVoid
78251>>>>>>>>>        End
78251>>>>>>>>>>
78251>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLSetArgument"
78253>>>>>>>>>    End_Procedure // SQLSetArgument
78254>>>>>>>>>
78254>>>>>>>>>
78254>>>>>>>>>
78254>>>>>>>>>    //***
78254>>>>>>>>>    //*** Procedure: SQLCall
78254>>>>>>>>>    //*** Purpose  : Call a stored procedure
78254>>>>>>>>>    //***
78254>>>>>>>>>
78254>>>>>>>>>    Procedure SQLCall
78256>>>>>>>>>        Local Integer ihdbc
78256>>>>>>>>>        Local Integer ihstmt
78256>>>>>>>>>        Local String  sDrvrId
78256>>>>>>>>>        Local Integer iVoid
78256>>>>>>>>>        Local String  sEmpty
78256>>>>>>>>>
78256>>>>>>>>>        //*** Initialize
78256>>>>>>>>>        Move "" To sEmpty
78257>>>>>>>>>
78257>>>>>>>>>        //*** Get the cli handle to the connection
78257>>>>>>>>>        Get phCLIHandle       To ihstmt
78258>>>>>>>>>        Get psDriverId        To sDrvrId
78259>>>>>>>>>        Get phStmtConnection  To ihdbc
78260>>>>>>>>>
78260>>>>>>>>>        //*** Call the procedure
78260>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
78262>>>>>>>>>            //*** Call the procedure
78262>>>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCALL ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt ;                        Result iVoid
78267>>>>>>>>>
78267>>>>>>>>>            Set piLastArgument To 0
78268>>>>>>>>>        End
78268>>>>>>>>>>
78268>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLCall"
78270>>>>>>>>>    End_Procedure // SQLCall
78271>>>>>>>>>
78271>>>>>>>>>
78271>>>>>>>>>
78271>>>>>>>>>    //***
78271>>>>>>>>>    //*** Function: SQLGetNextArgument
78271>>>>>>>>>    //*** Purpose : Get the next argument
78271>>>>>>>>>    //***
78271>>>>>>>>>
78271>>>>>>>>>    Function SQLGetNextArgument Returns String
78273>>>>>>>>>        Local Integer iArgnum
78273>>>>>>>>>        Local String  sResult
78273>>>>>>>>>
78273>>>>>>>>>        Get piLastArgument To iArgnum
78274>>>>>>>>>        Increment iArgnum
78275>>>>>>>>>        Get SQLGetArgument iArgnum To sResult
78276>>>>>>>>>        Set piLastArgument To iArgnum
78277>>>>>>>>>
78277>>>>>>>>>        Function_return sResult
78278>>>>>>>>>    End_Function // SQLGetNextArgument
78279>>>>>>>>>
78279>>>>>>>>>
78279>>>>>>>>>
78279>>>>>>>>>    //***
78279>>>>>>>>>    //*** Function: SQLGetArgument
78279>>>>>>>>>    //*** Purpose : Get the specified argument from a procedure
78279>>>>>>>>>    //***
78279>>>>>>>>>
78279>>>>>>>>>    Function SQLGetArgument Integer iArgnum Returns String
78281>>>>>>>>>        Local Integer ihdbc
78281>>>>>>>>>        Local Integer ihstmt
78281>>>>>>>>>        Local String  sDrvrId
78281>>>>>>>>>        Local Integer iVoid
78281>>>>>>>>>        Local String  sEmpty
78281>>>>>>>>>        Local String  sArgument
78281>>>>>>>>>        Local Integer iLen
78281>>>>>>>>>
78281>>>>>>>>>        //*** Initialize
78281>>>>>>>>>        Move "" To sEmpty
78282>>>>>>>>>        Move "" To sArgument
78283>>>>>>>>>
78283>>>>>>>>>        //*** Get the cli handle to the connection
78283>>>>>>>>>        Get phCLIHandle       To ihstmt
78284>>>>>>>>>        Get psDriverId        To sDrvrId
78285>>>>>>>>>        Get phStmtConnection  To ihdbc
78286>>>>>>>>>
78286>>>>>>>>>        //*** Call the procedure
78286>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
78288>>>>>>>>>            //*** Pass the information
78288>>>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                        Callback Current_Object ;                        Passing ihdbc iArgnum ihstmt ;                        Result iVoid
78293>>>>>>>>>
78293>>>>>>>>>            //*** Get the length
78293>>>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLGETPROCARGLEN ;                        Callback Current_Object ;                        Passing sEmpty sEmpty 0 ;                        Result iLen
78298>>>>>>>>>
78298>>>>>>>>>            If (iLen) Begin
78300>>>>>>>>>                //*** Allocate
78300>>>>>>>>>                Move (Repeat(' ', iLen)) To sArgument
78301>>>>>>>>>
78301>>>>>>>>>                //*** Pass the argument
78301>>>>>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLGETPROCARG ;                            Callback Current_Object ;                            Passing sArgument sEmpty 0 ;                            Result iVoid
78306>>>>>>>>>            End
78306>>>>>>>>>>
78306>>>>>>>>>        End
78306>>>>>>>>>>
78306>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLGetArgument"
78308>>>>>>>>>
78308>>>>>>>>>        Function_Return sArgument
78309>>>>>>>>>    End_Function // SQLGetArgument
78310>>>>>>>>>
78310>>>>>>>>>
78310>>>>>>>>>
78310>>>>>>>>>    //***
78310>>>>>>>>>    //*** Function: SQLReturnValue
78310>>>>>>>>>    //*** Purpose : Get the reutn value of a stored function
78310>>>>>>>>>    //***
78310>>>>>>>>>
78310>>>>>>>>>    Function SQLReturnValue Returns String
78312>>>>>>>>>        Local Integer ihdbc
78312>>>>>>>>>        Local Integer ihstmt
78312>>>>>>>>>        Local String  sDrvrId
78312>>>>>>>>>        Local Integer iVoid
78312>>>>>>>>>        Local String  sEmpty
78312>>>>>>>>>        Local String  sRetval
78312>>>>>>>>>        Local Integer iLen
78312>>>>>>>>>
78312>>>>>>>>>        //*** Initialize
78312>>>>>>>>>        Move "" To sEmpty
78313>>>>>>>>>        Move "" To sRetval
78314>>>>>>>>>
78314>>>>>>>>>        //*** Get the cli handle to the connection
78314>>>>>>>>>        Get phCLIHandle       To ihstmt
78315>>>>>>>>>        Get psDriverId        To sDrvrId
78316>>>>>>>>>        Get phStmtConnection  To ihdbc
78317>>>>>>>>>
78317>>>>>>>>>        //*** Call the procedure
78317>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
78319>>>>>>>>>            //*** Get the length
78319>>>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLGETPROCRETVALLEN ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt  ;                        Result iLen
78324>>>>>>>>>
78324>>>>>>>>>            If (iLen) Begin
78326>>>>>>>>>                //*** Allocate
78326>>>>>>>>>                Move (Repeat(' ', iLen)) To sRetval
78327>>>>>>>>>
78327>>>>>>>>>                //*** Pass the argument
78327>>>>>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLGETPROCRETVAL ;                            Callback Current_Object ;                            Passing ihdbc sRetval ihstmt ;                            Result iVoid
78332>>>>>>>>>            End
78332>>>>>>>>>>
78332>>>>>>>>>        End
78332>>>>>>>>>>
78332>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLReturnValue"
78334>>>>>>>>>
78334>>>>>>>>>        Function_Return sRetval
78335>>>>>>>>>    End_Function // SQLReturnValue
78336>>>>>>>>>
78336>>>>>>>>>
78336>>>>>>>>>
78336>>>>>>>>>    //***
78336>>>>>>>>>    //*** Function: SQLNextResultSet
78336>>>>>>>>>    //*** Purpose : Switch to the next set
78336>>>>>>>>>    //*** Returns : 0   = No more result sets
78336>>>>>>>>>    //***           <>0 = Switched to next set
78336>>>>>>>>>    //***
78336>>>>>>>>>
78336>>>>>>>>>    Function SQLNextResultSet Returns Integer
78338>>>>>>>>>        Local Integer ihdbc
78338>>>>>>>>>        Local Integer ihstmt
78338>>>>>>>>>        Local String  sDrvrId
78338>>>>>>>>>        Local String  sEmpty
78338>>>>>>>>>        Local Integer iResult
78338>>>>>>>>>
78338>>>>>>>>>        //*** Initialize
78338>>>>>>>>>        Move "" To sEmpty
78339>>>>>>>>>        Move 0  To iResult
78340>>>>>>>>>
78340>>>>>>>>>        //*** Get the cli handle to the connection
78340>>>>>>>>>        Get phCLIHandle       To ihstmt
78341>>>>>>>>>        Get psDriverId        To sDrvrId
78342>>>>>>>>>        Get phStmtConnection  To ihdbc
78343>>>>>>>>>
78343>>>>>>>>>        //*** Call the procedure
78343>>>>>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
78345>>>>>>>>>            //*** Get the length
78345>>>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLNEXTRESULTSET ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt  ;                        Result iResult
78350>>>>>>>>>
78350>>>>>>>>>            Set piLastArgument To 0
78351>>>>>>>>>        End
78351>>>>>>>>>>
78351>>>>>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLNextResultSet"
78353>>>>>>>>>
78353>>>>>>>>>        Function_Return iResult
78354>>>>>>>>>    End_Function // SQLNextResultSet
78355>>>>>>>>>
78355>>>>>>>>>
78355>>>>>>>>>
78355>>>>>>>>>    //***
78355>>>>>>>>>    //*** Procedure: SQLFetchActivatesBuffer
78355>>>>>>>>>    //*** Purpose  : Setup a file that will be acivated after a succesfull
78355>>>>>>>>>    //***            fetch on the statement
78355>>>>>>>>>    //***
78355>>>>>>>>>
78355>>>>>>>>>    Procedure SQLFetchActivatesBuffer Integer iFileNum Integer bState
78357>>>>>>>>>        Local Integer ihdbc
78357>>>>>>>>>        Local Integer ihstmt
78357>>>>>>>>>        Local String  sDrvrId
78357>>>>>>>>>        Local Integer iResult
78357>>>>>>>>>        Local Integer bIsOpen
78357>>>>>>>>>        Local Integer iVoid
78357>>>>>>>>>        Local String  sFileType
78357>>>>>>>>>
78357>>>>>>>>>        //*** Check if file is open
78357>>>>>>>>>        Get_attribute DF_FILE_OPENED Of iFileNum To bIsOpen
78360>>>>>>>>>        If (bIsOpen) Begin
78362>>>>>>>>>            //*** Get the cli handle to the connection
78362>>>>>>>>>            Get phCLIHandle       To ihstmt
78363>>>>>>>>>            Get psDriverId        To sDrvrId
78364>>>>>>>>>            Get phStmtConnection  To ihdbc
78365>>>>>>>>>
78365>>>>>>>>>            //*** Call the procedure
78365>>>>>>>>>            If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
78367>>>>>>>>>                //*** Check if the file has the correct type
78367>>>>>>>>>                Get_attribute DF_FILE_DRIVER Of iFileNum To sFileType
78370>>>>>>>>>                If (sFileType = sDrvrId) Begin
78372>>>>>>>>>                    //*** Setup the buffer
78372>>>>>>>>>                    Call_driver iFileNum sDrvrId Function FUNC_SQLBUFFERSTATUS ;                                Callback Current_Object ;                                Passing ihdbc bState ihstmt  ;                                Result iVoid
78377>>>>>>>>>                End
78377>>>>>>>>>>
78377>>>>>>>>>                Else ;                    Send StmtError CLIERR_SQLINVALID_BIND_FILE ("File" * String(iFileNum) * "type incompatible with statement ("  + sFileType + ")") "SQLBindFile"
78379>>>>>>>>>            End
78379>>>>>>>>>>
78379>>>>>>>>>            Else ;                Send HandleError ihstmt ihdbc sDrvrId "SQLFetchActivatesBuffer"
78381>>>>>>>>>        End
78381>>>>>>>>>>
78381>>>>>>>>>        Else ;            Send StmtError CLIERR_SQLINVALID_BUFFER ("File not open (number =" * String(iFileNum) + ")") "SQLFetchActivatesBuffer"
78383>>>>>>>>>    End_Procedure // SQLFetchActivatesBuffer
78384>>>>>>>>>
78384>>>>>>>>>End_Class // cSQLStatement
78385>>>>>>>>>
78385>>>>>>>>>
78385>>>>>>>>>//*****************************************************************************
78385>>>>>>>>>//*** Class  : cSQLConnection                                               ***
78385>>>>>>>>>//*** Purpose: Connection object for embedded SQL                           ***
78385>>>>>>>>>//***                                                                       ***
78385>>>>>>>>>//*** Description:                                                          ***
78385>>>>>>>>>//***   This provides the ability to create a connection for a driver.      ***
78385>>>>>>>>>//***   It will contain child statement objects                             ***
78385>>>>>>>>>//*****************************************************************************
78385>>>>>>>>>
78385>>>>>>>>>Class cSQLConnection is an Array
78386>>>>>>>>>
78386>>>>>>>>>    Procedure Construct_object Integer Image
78388>>>>>>>>>        Forward Send Construct_object Image
78390>>>>>>>>>
78390>>>>>>>>>        Property Integer phCLIHandle      Public 0
78391>>>>>>>>>        Property String  psDriverID       Public ""
78392>>>>>>>>>        Property Integer piBindFile       Public 0
78393>>>>>>>>>
78393>>>>>>>>>        Set Delegation_mode to NO_Delegation
78394>>>>>>>>>    End_procedure // COnstruct_object
78395>>>>>>>>>
78395>>>>>>>>>
78395>>>>>>>>>
78395>>>>>>>>>    //***
78395>>>>>>>>>    //*** Procedure: StoreHandleInfo
78395>>>>>>>>>    //*** Purpose  : Store basic information about the statement handle.
78395>>>>>>>>>    //***
78395>>>>>>>>>
78395>>>>>>>>>    Procedure StoreHandleInfo Integer iCLIHandle String sDrvrId Integer iParentHandle
78397>>>>>>>>>        Set phCLIHandle      To iCLIHandle
78398>>>>>>>>>        Set psDriverID       To sDrvrId
78399>>>>>>>>>    End_Procedure // StoreHandleInfo
78400>>>>>>>>>
78400>>>>>>>>>
78400>>>>>>>>>
78400>>>>>>>>>    //***
78400>>>>>>>>>    //*** Procedure: FreeHandle
78400>>>>>>>>>    //*** Purpose : Destroys handle object and all child statement objects
78400>>>>>>>>>    //***
78400>>>>>>>>>    Procedure FreeHandle
78402>>>>>>>>>        Send Destroy_Object
78403>>>>>>>>>    End_Procedure // FreeHandle
78404>>>>>>>>>
78404>>>>>>>>>
78404>>>>>>>>>
78404>>>>>>>>>    //***
78404>>>>>>>>>    //*** Function: SQLConnect
78404>>>>>>>>>    //*** Purpose : Make a connectin to an embedded SQL server
78404>>>>>>>>>    //*** Returns : The DataFlex handle to the connection
78404>>>>>>>>>    //***
78404>>>>>>>>>
78404>>>>>>>>>    Function SQLConnect string sDrvrID String sConnect Returns Integer
78406>>>>>>>>>        Local Integer ihdbc
78406>>>>>>>>>        Local String  sEmpty
78406>>>>>>>>>
78406>>>>>>>>>        //*** Initialize
78406>>>>>>>>>        Move "" To sEmpty
78407>>>>>>>>>        Move 0  To ihdbc
78408>>>>>>>>>
78408>>>>>>>>>        Indicate Err False
78409>>>>>>>>>
78409>>>>>>>>>        //*** Call the driver function to connect
78409>>>>>>>>>        Call_driver 0 sDrvrId Function FUNC_SQLCONNECT ;                    Callback current_object ;                    Passing sConnect sEmpty 0 ;                    Result ihdbc
78414>>>>>>>>>
78414>>>>>>>>>        //*** If there was an error, make result invalid
78414>>>>>>>>>        If (Err) ;            Move 0 To ihdbc
78417>>>>>>>>>
78417>>>>>>>>>        //*** Check result and store it
78417>>>>>>>>>        If (ihdbc <> 0) ;            Send StoreHandleInfo ihdbc sDrvrId 0
78420>>>>>>>>>
78420>>>>>>>>>        //*** Return success status
78420>>>>>>>>>        Function_Return (ihdbc <> 0)
78421>>>>>>>>>    End_function // SQLConnect
78422>>>>>>>>>
78422>>>>>>>>>
78422>>>>>>>>>
78422>>>>>>>>>    //***
78422>>>>>>>>>    //*** Function: SQLFileConnect
78422>>>>>>>>>    //*** Purpose : Use a connection of an already open file
78422>>>>>>>>>    //***
78422>>>>>>>>>
78422>>>>>>>>>    Function SQLFileConnect Integer iFileNum Returns Integer
78424>>>>>>>>>        Local Integer ihdbc
78424>>>>>>>>>        Local Integer bIsOpen
78424>>>>>>>>>        Local String  sDrvrId
78424>>>>>>>>>        Local String  sEmpty
78424>>>>>>>>>
78424>>>>>>>>>        //*** Initialize
78424>>>>>>>>>        Move "" To sEmpty
78425>>>>>>>>>        Move 0  To ihdbc
78426>>>>>>>>>
78426>>>>>>>>>        //*** Check if file is open
78426>>>>>>>>>        Get_attribute DF_FILE_OPENED Of iFileNum To bIsOpen
78429>>>>>>>>>        If (bIsOpen) Begin
78431>>>>>>>>>            //*** Fill the driver id, assume longest is 255 characters
78431>>>>>>>>>            Move (Repeat(' ', 255)) To sDrvrId
78432>>>>>>>>>            Get_attribute DF_FILE_DRIVER Of iFileNum To sDrvrId
78435>>>>>>>>>
78435>>>>>>>>>            Indicate Err False
78436>>>>>>>>>
78436>>>>>>>>>            //*** Call the driver function to connect
78436>>>>>>>>>            Call_driver iFileNum sDrvrId Function FUNC_SQLFILECONNECT ;                        Callback current_object ;                        Passing sEmpty sEmpty 0 ;                        Result ihdbc
78441>>>>>>>>>
78441>>>>>>>>>            //*** If there was an error, make result invalid
78441>>>>>>>>>            If (Err) ;                Move 0 To ihdbc
78444>>>>>>>>>
78444>>>>>>>>>            //*** Check result and store it
78444>>>>>>>>>            If (ihdbc <> 0) Begin
78446>>>>>>>>>                //*** Somehow Call_driver overwrites the sDrvrId variable, restore it here
78446>>>>>>>>>                Get_attribute DF_FILE_DRIVER Of iFileNum To sDrvrId
78449>>>>>>>>>                Send StoreHandleInfo ihdbc sDrvrId 0
78450>>>>>>>>>
78450>>>>>>>>>                //*** Set filenum so it can be used for fetching
78450>>>>>>>>>                Set piBindFile To iFileNum
78451>>>>>>>>>            End
78451>>>>>>>>>>
78451>>>>>>>>>        End
78451>>>>>>>>>>
78451>>>>>>>>>
78451>>>>>>>>>        //*** Return success status
78451>>>>>>>>>        Function_Return (ihdbc <> 0)
78452>>>>>>>>>    End_Function // SQLFileConnect
78453>>>>>>>>>
78453>>>>>>>>>
78453>>>>>>>>>
78453>>>>>>>>>    //***
78453>>>>>>>>>    //*** Procedure: SQLDisconnect
78453>>>>>>>>>    //*** Purpose  : Disconnect from an embedded SQL server and free allocated
78453>>>>>>>>>    //***            resources
78453>>>>>>>>>    //***
78453>>>>>>>>>
78453>>>>>>>>>    Procedure SQLDisconnect
78455>>>>>>>>>        Local Integer ihdbc
78455>>>>>>>>>        Local Integer iVoid
78455>>>>>>>>>        Local String  sDrvrId
78455>>>>>>>>>        Local String  sEmpty
78455>>>>>>>>>
78455>>>>>>>>>        //*** Initialize
78455>>>>>>>>>        Move "" To sEmpty
78456>>>>>>>>>
78456>>>>>>>>>        //*** Get the cli handle
78456>>>>>>>>>        Get phCLIHandle To ihdbc
78457>>>>>>>>>        Get psDriverId To sDrvrId
78458>>>>>>>>>
78458>>>>>>>>>        //*** Free the CLI handle
78458>>>>>>>>>        If (ihdbc <> 0) Begin
78460>>>>>>>>>            //*** Call the driver function to disconnect
78460>>>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLDISCONNECT ;                        Callback Current_object ;                        Passing sEmpty sEmpty ihdbc ;                        Result iVoid
78465>>>>>>>>>
78465>>>>>>>>>            //*** Free the DataFlex handle
78465>>>>>>>>>            Send FreeHandle
78466>>>>>>>>>        End
78466>>>>>>>>>>
78466>>>>>>>>>    End_Procedure // SQLDisconnect
78467>>>>>>>>>
78467>>>>>>>>>
78467>>>>>>>>>
78467>>>>>>>>>    //***
78467>>>>>>>>>    //*** Function: CreateHandle
78467>>>>>>>>>    //*** Purpose : Creates a child statement handle
78467>>>>>>>>>    //***
78467>>>>>>>>>
78467>>>>>>>>>    Function CreateHandle Returns Integer
78469>>>>>>>>>        Local Integer hSQL
78469>>>>>>>>>
78469>>>>>>>>>        Object oSQLStatement Is A cSQLStatement
78471>>>>>>>>>            Move current_object To hSQL
78472>>>>>>>>>        End_Object // oSQLStatement
78473>>>>>>>>>
78473>>>>>>>>>        //*** If the connection has a default Bind File, assign it to the
78473>>>>>>>>>        //*** statement object. The default is set when you open a file with a
78473>>>>>>>>>        //*** SetFileConnection command.
78473>>>>>>>>>        Set piBindFile Of hSQL To (piBindFile(Current_object))
78474>>>>>>>>>
78474>>>>>>>>>        Function_Return hSQL
78475>>>>>>>>>    End_Function // CreateHandle
78476>>>>>>>>>
78476>>>>>>>>>
78476>>>>>>>>>
78476>>>>>>>>>    //***
78476>>>>>>>>>    //*** Function: SQLOpen
78476>>>>>>>>>    //*** Prupose : Open a statement for use
78476>>>>>>>>>    //***
78476>>>>>>>>>
78476>>>>>>>>>    Function SQLOpen Returns Integer
78478>>>>>>>>>        Local Integer hDFHandle
78478>>>>>>>>>        Local Integer ihdbc
78478>>>>>>>>>        Local Integer ihstmt
78478>>>>>>>>>        Local Integer iVoid
78478>>>>>>>>>        Local String  sDrvrId
78478>>>>>>>>>        Local String  sEmpty
78478>>>>>>>>>
78478>>>>>>>>>        //*** Initialize
78478>>>>>>>>>        Move "" To sEmpty
78479>>>>>>>>>
78479>>>>>>>>>        //*** Get the cli handle to the connection
78479>>>>>>>>>        Get phCLIHandle To ihdbc
78480>>>>>>>>>        Get psDriverId  To sDrvrId
78481>>>>>>>>>
78481>>>>>>>>>        //*** Allocate a new handle and populate it
78481>>>>>>>>>        If (ihdbc <> 0) Begin
78483>>>>>>>>>            //**** Create a new DataFlex handle
78483>>>>>>>>>            Get CreateHandle To hDFHandle
78484>>>>>>>>>
78484>>>>>>>>>            //*** Call the driver function to allocate a statement handle
78484>>>>>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLOPEN ;                        Callback Current_object ;                        Passing hDFHandle sEmpty ihdbc ;                        Result ihstmt
78489>>>>>>>>>
78489>>>>>>>>>            //*** If unsuccessful destroy DF side info
78489>>>>>>>>>            If (ihstmt = 0) Begin
78491>>>>>>>>>                Send FreeHandle to hDFHandle
78492>>>>>>>>>                Move 0 to hDFHandle
78493>>>>>>>>>            End
78493>>>>>>>>>>
78493>>>>>>>>>            Else ;                Send StoreHandleInfo to hDFHandle ihstmt sDrvrId ihdbc
78495>>>>>>>>>        End
78495>>>>>>>>>>
78495>>>>>>>>>
78495>>>>>>>>>        Function_return hDFHandle
78496>>>>>>>>>    End_function // SQLOpen
78497>>>>>>>>>
78497>>>>>>>>>End_Class // cSQLConnection
78498>>>>>>>>>
78498>>>>>>>>>
78498>>>>>>>>>
78498>>>>>>>>>//*****************************************************************************
78498>>>>>>>>>//*** Class  : cSQLHandlemanager                                            ***
78498>>>>>>>>>//*** Purpose: Manager for embedded SQL handles.                            ***
78498>>>>>>>>>//***                                                                       ***
78498>>>>>>>>>//*** Description:                                                          ***
78498>>>>>>>>>//***   We want to be able to use multiple drivers and multiple             ***
78498>>>>>>>>>//***   connections within a driver and multiple statements within a        ***
78498>>>>>>>>>//***   connection. To allow this we have palced our own handle logic on    ***
78498>>>>>>>>>//***   top of the driver handle logic. This way we can handle the          ***
78498>>>>>>>>>//***   situation where two driver handles may be equal.                    ***
78498>>>>>>>>>//*****************************************************************************
78498>>>>>>>>>
78498>>>>>>>>>Class cSQLHandleManager Is A Array
78499>>>>>>>>>
78499>>>>>>>>>    Procedure Construct_object Integer Image
78501>>>>>>>>>        Forward Send Construct_object Image
78503>>>>>>>>>
78503>>>>>>>>>        Property String  psDefaultDriver     Public ""
78504>>>>>>>>>        Property String  psDefaultConnection Public ""
78505>>>>>>>>>
78505>>>>>>>>>        Set Delegation_mode to NO_Delegation
78506>>>>>>>>>    End_procedure // COnstruct_object
78507>>>>>>>>>
78507>>>>>>>>>
78507>>>>>>>>>
78507>>>>>>>>>    //***
78507>>>>>>>>>    //*** Function: CreateHandle
78507>>>>>>>>>    //*** Purpose : Allocate memory for the desired type of handle
78507>>>>>>>>>    //***
78507>>>>>>>>>
78507>>>>>>>>>    Function CreateHandle Returns Integer
78509>>>>>>>>>        Local Integer hSQL
78509>>>>>>>>>
78509>>>>>>>>>        //*** Create a connection object
78509>>>>>>>>>        Object oSQLConnection Is A cSQLConnection
78511>>>>>>>>>            Move current_object To hSQL
78512>>>>>>>>>        End_Object // oSQLConnection
78513>>>>>>>>>
78513>>>>>>>>>        Function_Return hSQL
78514>>>>>>>>>    End_Function // CreateHandle
78515>>>>>>>>>
78515>>>>>>>>>
78515>>>>>>>>>
78515>>>>>>>>>    //***
78515>>>>>>>>>    //*** Procedure: SQLSetConnect
78515>>>>>>>>>    //*** Purpose  : Store default connection information
78515>>>>>>>>>    //***
78515>>>>>>>>>
78515>>>>>>>>>    Procedure SQLSetConnect String sDriver String sConnect
78517>>>>>>>>>        Set psDefaultDriver      To sDriver
78518>>>>>>>>>        Set psDefaultConnection  To sConnect
78519>>>>>>>>>    End_Procedure // SQLSetConnect
78520>>>>>>>>>
78520>>>>>>>>>
78520>>>>>>>>>
78520>>>>>>>>>    //***
78520>>>>>>>>>    //*** Function: SQLConnect
78520>>>>>>>>>    //*** Purpose : Make a connectin to an embedded SQL server
78520>>>>>>>>>    //*** Returns : The DataFlex handle to the connection
78520>>>>>>>>>    //***
78520>>>>>>>>>
78520>>>>>>>>>    Function SQLConnect String sDrvrID String sConnect Returns integer
78522>>>>>>>>>        Local Integer hDFHandle
78522>>>>>>>>>        Local Integer bOK
78522>>>>>>>>>
78522>>>>>>>>>        //*** Check arguments
78522>>>>>>>>>        If (sDrvrID = "" And sConnect = "") Begin
78524>>>>>>>>>            Get psDefaultDriver      To sDrvrId
78525>>>>>>>>>            Get psDefaultConnection  To sConnect
78526>>>>>>>>>        End
78526>>>>>>>>>>
78526>>>>>>>>>
78526>>>>>>>>>        //*** Allocate a new handle
78526>>>>>>>>>        Get CreateHandle To hDFHandle
78527>>>>>>>>>        Get SQLConnect of hDFHandle sDrvrID sConnect To bOK
78528>>>>>>>>>
78528>>>>>>>>>        //*** If failure, kill the handle and return a 0 handle
78528>>>>>>>>>        If (Not(bOK)) Begin
78530>>>>>>>>>            Send FreeHandle to hDFHandle
78531>>>>>>>>>            Move 0 to hDFHandle
78532>>>>>>>>>        End
78532>>>>>>>>>>
78532>>>>>>>>>
78532>>>>>>>>>        Function_return hDFHandle
78533>>>>>>>>>    End_function // SQLConnect
78534>>>>>>>>>
78534>>>>>>>>>
78534>>>>>>>>>
78534>>>>>>>>>    //***
78534>>>>>>>>>    //*** Function: SQLFileConnect
78534>>>>>>>>>    //*** Purpose : Make an existing connection available for use with Embedded
78534>>>>>>>>>    //***           SQL. The connection is identified by the number opf a file
78534>>>>>>>>>    //***           that is open for that connection.
78534>>>>>>>>>    //***
78534>>>>>>>>>
78534>>>>>>>>>    Function SQLFileConnect Integer iFileNum Returns Integer
78536>>>>>>>>>        Local Integer hDFHandle
78536>>>>>>>>>        Local Integer bOK
78536>>>>>>>>>
78536>>>>>>>>>        //*** Allocate a new handle
78536>>>>>>>>>        Get CreateHandle To hDFHandle
78537>>>>>>>>>        Get SQLFileConnect of hDFHandle iFileNum To bOK
78538>>>>>>>>>
78538>>>>>>>>>        //*** If failure, kill the handle and return a 0 handle
78538>>>>>>>>>        If (Not(bOK)) Begin
78540>>>>>>>>>            Send FreeHandle to hDFHandle
78541>>>>>>>>>            Move 0 to hDFHandle
78542>>>>>>>>>        End
78542>>>>>>>>>>
78542>>>>>>>>>
78542>>>>>>>>>        Function_return hDFHandle
78543>>>>>>>>>    End_Function // SQLFileConnect
78544>>>>>>>>>
78544>>>>>>>>>End_Class // cSQLHandleManager
78545>>>>>>>>>
78545>>>>>>>>>
78545>>>>>>>>>
78545>>>>>>>>>//***
78545>>>>>>>>>//*** Function: CreateSQLManager
78545>>>>>>>>>//*** Purpose : Create the embedded SQL manager, this is an internal function!
78545>>>>>>>>>//***
78545>>>>>>>>>
78545>>>>>>>>>Function CreateSQLmanager For Desktop Returns Integer
78547>>>>>>>>>    Local Integer hoSQlMngr
78547>>>>>>>>>
78547>>>>>>>>>    Object oSQLHandleManager Is A cSQLHandleManager
78549>>>>>>>>>        MOve Current_object To hoSQLMngr
78550>>>>>>>>>    End_Object // oSQLHandleManager
78551>>>>>>>>>
78551>>>>>>>>>    Function_Return hoSQLMngr
78552>>>>>>>>>End_Function // CreateSQLMngr
78553>>>>>>>>>
78553>>>>>>>>>//*** Make sure the object is global by creating it under DESKTOP
78553>>>>>>>>>Get CreateSQLManager Of Desktop To _embsqlghoSQLHandleMngr
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLSetConnect                                                ***
78554>>>>>>>>>//*** Purpose: Setup default connection information for embedded SQL.       ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLSetConnect sSDriverId sConnectString                      ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLConnect                                                   ***
78554>>>>>>>>>//*** Purpose: Connect to a server for embedded SQL usage.                  ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLConnect To hdbc                                           ***
78554>>>>>>>>>//***          SQLConnect [sDriverId sConnectString] To hdbc                ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLFileConnect                                               ***
78554>>>>>>>>>//*** Purpsoe: Return the handle to a connection of an open file. This      ***
78554>>>>>>>>>//***          connection is (obviously) already opened. We are just using  ***
78554>>>>>>>>>//***          the same connection for Embedded SQL. This allows the        ***
78554>>>>>>>>>//***          programmer not to know connection details.                   ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLFileConnect Filex To hdbc                                 ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLDisconnect                                                ***
78554>>>>>>>>>//*** Purpose: Connect to a server for embedded SQL usage.                  ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLDisConnect hdbc                                           ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLOpen                                                      ***
78554>>>>>>>>>//*** Purpose: Allocate the memory to stroe statement information.          ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLOpen hdbc To hstmt                                        ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLClose                                                     ***
78554>>>>>>>>>//*** Purpose: Close a statement and free all associated memory.            ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLClose hstmt                                               ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLPrepare                                                   ***
78554>>>>>>>>>//*** Purpose: Prepare a statement for execution.                           ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLPrepare hstmt sStatement                                  ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLExecute                                                   ***
78554>>>>>>>>>//*** Purpose: Execute a prepared statement                                 ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLExecute hstmt                                             ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLExecDirect                                                ***
78554>>>>>>>>>//*** Purpose: Prepare and execute a statement.                             ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLExecDirect hstmt sStatement                               ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLFileFetch                                                 ***
78554>>>>>>>>>//*** Purpose: Get a row from a statement result set.                       ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLFileFetch hstmt [To File1 [File2 ...]]                    ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLBindFetchFile                                             ***
78554>>>>>>>>>//*** Purpose: Binds a file number to a statement so it can be used for     ***
78554>>>>>>>>>//***          fetching data. Only needed in non fileconnect. Note that     ***
78554>>>>>>>>>//***          can be assigned to the connection or the statement handle    ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLBindFileForFetch hstmt|hdbc FileName|FileNumber           ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLFetch                                                     ***
78554>>>>>>>>>//*** Purpose: Get a row from a statement result set.                       ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLFetch hstmt [To Var1 [Var2 ...]]                          ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLGetData                                                   ***
78554>>>>>>>>>//*** Purpose: Get a column's data.                                         ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLGetData hstmt iColumnNUmber [Length iLen] To Var          ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLColumnMap                                                 ***
78554>>>>>>>>>//*** Purpose: Determine the column number based on the column name.        ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLColumnMap hstmt sColName To iColNumber                    ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLColAttribute                                              ***
78554>>>>>>>>>//*** Purpose: Get an attribute of a column in a statements result set.     ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLColAttribute hstmt iCol iAttrId To sAttrib                ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLStmtAttribute                                             ***
78554>>>>>>>>>//*** Purpose: Get an atribute of a statement.                              ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLStmtAttribute hstmt iAttribId To sAttrib                  ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLCall                                                      ***
78554>>>>>>>>>//*** Purpose: Call a stored procedure.                                     ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLCall hstmt ProcedureName [Arg1 ...] [To Var]              ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLGetArguments                                              ***
78554>>>>>>>>>//*** Purpsoe: Get the arguments of a stored procedure. This command should ***
78554>>>>>>>>>//***          be used when a procedure has multiple result sets. Some      ***
78554>>>>>>>>>//***          backends (SQL SErver for example) will return these as the   ***
78554>>>>>>>>>//***          last result set. This emans you first process all other      ***
78554>>>>>>>>>//***          result sets and then get the arguments and return value.     ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLGetArguments hstmt [Arg1...] [To Var]                     ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLNextResultSet                                             ***
78554>>>>>>>>>//*** Purpose: Go the the next result set. This command should be used when ***
78554>>>>>>>>>//***          a procedure call results in multiple result sets. Processing ***
78554>>>>>>>>>//***          such procedures can be done by loping through the result     ***
78554>>>>>>>>>//***          sets.                                                        ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLNextResultSet hstmt                                       ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>//*** Command: SQLFetchActivatesBuffer                                      ***
78554>>>>>>>>>//*** Purpose: Setup fetch behavior for a file. When set to true a          ***
78554>>>>>>>>>//***          succesfull fetch of the statement resutl set will            ***
78554>>>>>>>>>//***          automatically set the status of the file's bufer to          ***
78554>>>>>>>>>//***          DF_FILE_ACTIVE.                                              ***
78554>>>>>>>>>//***                                                                       ***
78554>>>>>>>>>//*** Syntax : SQLFetchActivatesBuffer hstmt FileNUmber|FileName sState     ***
78554>>>>>>>>>//*****************************************************************************
78554>>>>>>>>>
78554>>>>>>>>>//Doc/ Ignore=False
78554>>>>>>>
78554>>>>>>>// defines interface for cWindowMesageHook - currently a private runtime class
78554>>>>>>>Define     U_DFWINDOWSMESSAGEHOOK  for |CI0106
78554>>>>>>>Define     GET_ENABLEWINDOWSHOOK   for |CI$0542
78554>>>>>>>Define     MSG_DISABLEWINDOWSHOOK  for |CI$0543
78554>>>>>>>Define     GET_ONWINDOWSHOOK       for |CI$0544
78554>>>>>>>Define     WH_MOUSE for 7
78554>>>>>>>Define     WH_KEYBOARD for 2
78554>>>>>>>
78554>>>>>>>
78554>>>>>>>// suggestion lists use a global timer and a global suggestion list
78554>>>>>>>Global_Variable Handle ghoSuggestionList 
78554>>>>>>>Move 0 to ghoSuggestionList
78555>>>>>>>
78555>>>>>>>Global_Variable Handle ghoSuggestionTimer
78555>>>>>>>Move 0 to ghoSuggestionTimer
78556>>>>>>>
78556>>>>>>>// this will get created the first time it is needed. 
78556>>>>>>>Class cSuggestionTimer is a cTimer
78557>>>>>>>
78557>>>>>>>    Procedure Construct_Object
78559>>>>>>>        Forward Send Construct_Object
78561>>>>>>>        Property Handle phoTimerOwner 0
78562>>>>>>>        Set piTimeout to 50
78563>>>>>>>    End_Procedure
78564>>>>>>>  
78564>>>>>>>    Procedure OnTimer 
78566>>>>>>>        Handle hoOwner
78566>>>>>>>        Get phoTimerOwner to hoOwner
78567>>>>>>>        // do this in case progam close destroys owner before timer
78567>>>>>>>        Get Object_Id of hoOwner to hoOwner
78568>>>>>>>        If hoOwner Begin
78570>>>>>>>            Send OnSuggestionTimer to hoOwner
78571>>>>>>>        End
78571>>>>>>>>
78571>>>>>>>        Else Begin
78572>>>>>>>            // something wrong, shut off timer
78572>>>>>>>            Set pbEnabled to False   
78573>>>>>>>        End                                
78573>>>>>>>>
78573>>>>>>>    End_Procedure
78574>>>>>>>    
78574>>>>>>>End_Class
78575>>>>>>>
78575>>>>>>>Class cSuggestionHookMouse is a DFWindowsMessageHook
78576>>>>>>>    
78576>>>>>>>    // If mouse not in suggestion list or form, close suggestionlist
78576>>>>>>>    Function OnWindowsHook Integer i1 Integer i2 Integer i3 Returns Integer
78578>>>>>>>        tWinMouseHookStruct MouseHook
78578>>>>>>>        tWinMouseHookStruct MouseHook
78578>>>>>>>        Integer ivoid hObj
78578>>>>>>>        Handle hoOwner hoParent
78578>>>>>>>        If (i1=0 and (i2=WM_LBUTTONDOWN or i2=WM_RBUTTONDOWN or i2=WM_MBUTTONDOWN or ;                      i2=WM_NCLBUTTONDOWN or i2=WM_NCRBUTTONDOWN or i2=WM_NCMBUTTONDOWN)) Begin
78580>>>>>>>            Move (CopyMemory(AddressOf(MouseHook), i3, SizeOfType(tWinMouseHookStruct))) to iVoid
78581>>>>>>>            GET_OBJECT_FROM_WINDOW MouseHook.hwnd to hObj
78582>>>>>>>            Get Parent to hoParent
78583>>>>>>>            Get phoOwner of hoParent to hoOwner
78584>>>>>>>            If (not(hObj) or (hObj<>hoParent and hObj<>hoOwner)) Begin
78586>>>>>>>                Send DisableWindowsHook
78587>>>>>>>                Send DeActivateSuggestionList of hoOwner
78588>>>>>>>            End
78588>>>>>>>>
78588>>>>>>>        End
78588>>>>>>>>
78588>>>>>>>    End_Function
78589>>>>>>>
78589>>>>>>>    Procedure End_Construct_Object
78591>>>>>>>        Boolean bOk
78591>>>>>>>        Forward Send End_Construct_Object
78593>>>>>>>        Get EnableWindowsHook WH_MOUSE to bOk 
78594>>>>>>>    End_Procedure
78595>>>>>>>
78595>>>>>>>End_Class
78596>>>>>>>
78596>>>>>>>Class cSuggestionHookKbd is a DFWindowsMessageHook
78597>>>>>>>    
78597>>>>>>>    // If menu key, close suggestionlist
78597>>>>>>>    Function OnWindowsHook Integer i1 Integer i2 Integer i3 Returns Integer
78599>>>>>>>        Handle hoOwner
78599>>>>>>>        If (i1=0 and i2=VK_MENU) Begin
78601>>>>>>>            Delegate Get phoOwner to hoOwner
78603>>>>>>>            Send DisableWindowsHook
78604>>>>>>>            Send DeActivateSuggestionList of hoOwner
78605>>>>>>>        End
78605>>>>>>>>
78605>>>>>>>    End_Function
78606>>>>>>>    
78606>>>>>>>    Procedure End_Construct_Object
78608>>>>>>>        Boolean bOk
78608>>>>>>>        Forward Send End_Construct_Object
78610>>>>>>>        Get EnableWindowsHook WH_KEYBOARD  to bOk  
78611>>>>>>>    End_Procedure
78612>>>>>>>
78612>>>>>>>End_Class
78613>>>>>>>
78613>>>>>>>Class cSuggestionList is a cRichEdit
78614>>>>>>>    
78614>>>>>>>    Procedure Construct_Object
78616>>>>>>>        Handle hoObj
78616>>>>>>>        Forward Send Construct_Object
78618>>>>>>>        Property Handle phoOwner
78619>>>>>>>        Set Focus_Mode to NonFocusable
78620>>>>>>>        Set Attach_Parent_State to True
78621>>>>>>>        Set pbWrap to False
78622>>>>>>>        If (ghoSuggestionList) Begin
78624>>>>>>>            Send Destroy of ghoSuggestionList
78625>>>>>>>        End
78625>>>>>>>>
78625>>>>>>>        Get CreateNamed (RefClass(cSuggestionHookMouse)) "oMouseHook" to hoObj
78626>>>>>>>        Get CreateNamed (RefClass(cSuggestionHookKbd))"oKbdHook" to hoObj
78627>>>>>>>    End_Procedure
78628>>>>>>>    
78628>>>>>>>    Procedure Destroy_Object
78630>>>>>>>        Forward Send Destroy_Object
78632>>>>>>>        Move 0 to ghoSuggestionList
78633>>>>>>>    End_Procedure
78634>>>>>>>    
78634>>>>>>>    Procedure DeactivateList
78636>>>>>>>        Set pbEnabled of ghoSuggestionTimer to False
78637>>>>>>>        Send Deactivate
78638>>>>>>>        Send Destroy
78639>>>>>>>    End_Procedure
78640>>>>>>>    
78640>>>>>>>    Procedure InitList Handle hoForm
78642>>>>>>>        Integer iSize iLoc iLoc2
78642>>>>>>>        Get GuiSize of hoForm to iSize
78643>>>>>>>        Set GuiSize to (Hi(iSize)) (1000)
78644>>>>>>>        Get Absolute_GUIOrigin of hoForm to iLoc
78645>>>>>>>        Delegate Get Absolute_GUIOrigin to iLoc2
78647>>>>>>>        Set GuiLocation to (Hi(iLoc)-Hi(iLoc2)+Hi(iSize)+2) (Low(iLoc)+2-Low(iLoc2))
78648>>>>>>>        Set Visible_State to False
78649>>>>>>>    End_Procedure
78650>>>>>>>    
78650>>>>>>>    // scroll up one line
78650>>>>>>>    Procedure ScrollUp
78652>>>>>>>        Integer iLine
78652>>>>>>>        Get SelectedRow to iLine
78653>>>>>>>        If (iLine) Begin
78655>>>>>>>            Send SelectRow (iLine-1)
78656>>>>>>>        End
78656>>>>>>>>
78656>>>>>>>    End_Procedure
78657>>>>>>>    
78657>>>>>>>    // scroll down one line
78657>>>>>>>    Procedure ScrollDown
78659>>>>>>>        Integer iLine iLines
78659>>>>>>>        Get Line_Count to iLines
78660>>>>>>>        Get SelectedRow to iLine
78661>>>>>>>        // there can be an extra line at the end
78661>>>>>>>        If (iLine<iLines-1) Begin
78663>>>>>>>            Send SelectRow (iLine+1)
78664>>>>>>>        End
78664>>>>>>>>
78664>>>>>>>    End_Procedure
78665>>>>>>>    
78665>>>>>>>    // sets the current line to iLine and highlights it
78665>>>>>>>    Procedure SelectRow Integer iLine
78667>>>>>>>        Integer iPos iLen
78667>>>>>>>        Get FirstCharInLinePos iLine to iPos
78668>>>>>>>        Get LineLength iLine to iLen
78669>>>>>>>        Send SetSel iPos (iPos+iLen)
78670>>>>>>>    End_Procedure
78671>>>>>>>    
78671>>>>>>>    // get the current selected Line
78671>>>>>>>    Function SelectedRow Returns Integer
78673>>>>>>>        Integer iLine
78673>>>>>>>        Get LineFromChar -1 to iLine
78674>>>>>>>        Function_Return iLine
78675>>>>>>>    End_Function
78676>>>>>>>
78676>>>>>>>    // select the current row 
78676>>>>>>>    Procedure Mouse_Up Integer hCell Integer iPos
78678>>>>>>>        Handle hoObj
78678>>>>>>>        Get phoOwner to hoObj
78679>>>>>>>        Send Activate of hoObj // move focus to owner, which will close the list
78680>>>>>>>        Send SelectSuggestion of hoObj
78681>>>>>>>    End_Procedure // Mouse_Up
78682>>>>>>>      
78682>>>>>>>End_Class
78683>>>>>>>
78683>>>>>>>// This contains mixin support for suggestion logic and contains the interface that
78683>>>>>>>// is accessed publicly. This should be mixed into the form or column DEO object
78683>>>>>>>Class cSuggestion_mixin is a Mixin
78684>>>>>>>    
78684>>>>>>>    Procedure Define_cSuggestion_mixin
78686>>>>>>>        
78686>>>>>>>        Property Integer peSuggestionMode smFind
78687>>>>>>>        Property Boolean pbFullText False
78688>>>>>>>        Property Boolean pbCaseSensitive False
78689>>>>>>>        Property Integer piMaxResults 15
78690>>>>>>>        Property Integer piStartAtChar 2
78691>>>>>>>        Property Boolean pbFullWidth True
78692>>>>>>>        Property Integer piFindIndex 0
78693>>>>>>>        Property Boolean pbFindOnSelect True
78694>>>>>>>        Property Integer piPopupTimeout 50
78695>>>>>>>        
78695>>>>>>>        Property tSuggestion[] pSearchResults
78696>>>>>>>
78696>>>>>>>        Property Handle phcSuggestionListClass (RefClass(cSuggestionList))
78697>>>>>>>        
78697>>>>>>>    End_Procedure
78698>>>>>>>    
78698>>>>>>>    // Display one Suggestion Line in Suggestion List. Good for augmentation although
78698>>>>>>>    // this must be done carefully as you must know the suggestionlist interface, which
78698>>>>>>>    // if private
78698>>>>>>>    Procedure ShowSuggestion tSuggestion SuggestionData String sSearch
78700>>>>>>>        Integer i iCols iPos
78700>>>>>>>        String sValue
78700>>>>>>>        Integer eSuggestionMode
78700>>>>>>>        Boolean bFullText
78700>>>>>>>        
78700>>>>>>>        Get peSuggestionMode to eSuggestionMode
78701>>>>>>>        Get pbFullText to bFullText
78702>>>>>>>        
78702>>>>>>>        Move SuggestionData.aValues[0] to sValue
78703>>>>>>>        If (not(bFullText)) Begin
78705>>>>>>>            Set pbBold of ghoSuggestionList to True
78706>>>>>>>            Send AppendText of ghoSuggestionList (Left(sValue,Length(sSearch))) 
78707>>>>>>>            Set pbBold of ghoSuggestionList to False
78708>>>>>>>            Send AppendText of ghoSuggestionList (Mid(sValue,255,Length(sSearch)+1)) 
78709>>>>>>>        End
78709>>>>>>>>
78709>>>>>>>        Else Begin
78710>>>>>>>            Set pbBold of ghoSuggestionList to False
78711>>>>>>>            Move (Pos(Uppercase(sSearch),Uppercase(sValue))) to iPos
78712>>>>>>>            If (iPos) Begin
78714>>>>>>>                Send AppendText of ghoSuggestionList (Left(sValue,iPos-1)) 
78715>>>>>>>                Set pbBold of ghoSuggestionList to True
78716>>>>>>>                Send AppendText of ghoSuggestionList (Mid(sValue,Length(sSearch),iPos)) 
78717>>>>>>>                Set pbBold of ghoSuggestionList to False
78718>>>>>>>            End
78718>>>>>>>>
78718>>>>>>>            Send AppendText of ghoSuggestionList (Mid(sValue,255,iPos+Length(sSearch))) 
78719>>>>>>>        End
78719>>>>>>>>
78719>>>>>>>        
78719>>>>>>>        // if addiitonal columns (usually validation) we assume the first value is the one that is
78719>>>>>>>        // matched and we display all other values (usually just one) to the
78719>>>>>>>        // right of it. 
78719>>>>>>>        Move (SizeOfArray(SuggestionData.aValues)) to iCols
78720>>>>>>>        If (iCols>1) Begin
78722>>>>>>>            Move "" to sValue
78723>>>>>>>            For i from 1 to (iCols-1)
78729>>>>>>>>
78729>>>>>>>                Move (sValue + If(i=1," - ","  ") + SuggestionData.aValues[i]) to sValue
78730>>>>>>>            Loop
78731>>>>>>>>
78731>>>>>>>            Send AppendText of ghoSuggestionList sValue
78732>>>>>>>        End
78732>>>>>>>>
78732>>>>>>>    End_Procedure
78733>>>>>>>    
78733>>>>>>>    // used to catch a set_field_value_Error
78733>>>>>>>    Procedure Error_Report Integer iError Integer iLine String sErr
78735>>>>>>>    End_Procedure
78736>>>>>>>    
78736>>>>>>>    // does a Set_Field_Value with error testing around it.
78736>>>>>>>    Function SafeSetFieldValue Integer iFile Integer iField String sValue Returns Boolean
78738>>>>>>>        Handle hoOldError
78738>>>>>>>        Boolean bErr
78738>>>>>>>        Move Error_Object_Id to hoOldError
78739>>>>>>>        Move Self to Error_Object_Id
78740>>>>>>>        Move False to Err 
78741>>>>>>>        Set_Field_Value iFile iField to sValue
78744>>>>>>>        Move Err to bErr
78745>>>>>>>        Move hoOldError to Error_Object_Id
78746>>>>>>>        Function_Return bErr        
78747>>>>>>>    End_Function
78748>>>>>>>
78748>>>>>>>
78748>>>>>>>    Procedure SuggestionsFindIncremental String sSearch tSuggestion[] ByRef aSuggestions
78750>>>>>>>        Integer iFile iField iIndex iLen iRow iMax eType iLength iDec
78750>>>>>>>        Handle hoServer
78750>>>>>>>        Boolean bContinue bCase bOldRelate bNeedsRelate bInvalid
78750>>>>>>>        String sVal sLowSearch
78750>>>>>>>        RowID riTest
78750>>>>>>>        
78750>>>>>>>        Get Server to hoServer
78751>>>>>>>        Get Data_File  to iFile
78752>>>>>>>        Get Data_Field to iField       
78753>>>>>>>        
78753>>>>>>>        If ((hoServer <> 0) and (iFile <> 0)) Begin
78755>>>>>>>            Get piFindIndex to iIndex
78756>>>>>>>            Get piMaxResults to iMax
78757>>>>>>>            Get pbCaseSensitive to bCase
78758>>>>>>>            
78758>>>>>>>            Get_Attribute DF_FIELD_TYPE of iFile iField to eType
78761>>>>>>>            Get_Attribute DF_FIELD_LENGTH of iFile iField to iLength
78764>>>>>>>            Get_Attribute DF_FIELD_PRECISION of iFile iField to iDec
78767>>>>>>>            
78767>>>>>>>            Move (iLength - iDec) to iLength
78768>>>>>>>            
78768>>>>>>>            If (iIndex <= 0) Begin
78770>>>>>>>                Get_Attribute DF_FIELD_INDEX of iFile iField to iIndex
78773>>>>>>>            End
78773>>>>>>>>
78773>>>>>>>            
78773>>>>>>>            
78773>>>>>>>            
78773>>>>>>>            If (iIndex > 0) Begin
78775>>>>>>>                Get No_Relate_State of hoServer to bOldRelate
78776>>>>>>>                Get DDOConstraintNeedsRelate of hoServer iIndex to bNeedsRelate
78777>>>>>>>                Set No_Relate_State of hoServer to (not(bNeedsRelate))
78778>>>>>>>                                
78778>>>>>>>                Move True to bContinue
78779>>>>>>>                Move (Length(sSearch)) to iLen
78780>>>>>>>                Move (Lowercase(sSearch)) to sLowSearch
78781>>>>>>>                Move 0 to iRow
78782>>>>>>>                
78782>>>>>>>                //  Find first record
78782>>>>>>>                Send Request_Read of hoServer FIRST_RECORD iFile iIndex
78783>>>>>>>                Get SafeSetFieldValue iFile iField sSearch to bInvalid
78784>>>>>>>                If bInvalid Begin
78786>>>>>>>                    Move False to bContinue
78787>>>>>>>                End
78787>>>>>>>>
78787>>>>>>>                
78787>>>>>>>                If (bContinue) Begin
78789>>>>>>>                    Send Request_Read of hoServer GE iFile iIndex
78790>>>>>>>                End
78790>>>>>>>>
78790>>>>>>>                
78790>>>>>>>                While (Found and bContinue)
78794>>>>>>>                    Get_Field_Value iFile iField to sVal
78797>>>>>>>                    
78797>>>>>>>                    If ((not(bCase) and Lowercase(Left(sVal, iLen)) = sLowSearch) or (bCase and Left(sVal, iLen) = sSearch)) Begin
78799>>>>>>>
78799>>>>>>>                        Move (SerializeRowID(GetRowID(iFile)))  to aSuggestions[iRow].sRowId
78800>>>>>>>                        Move (Trim(sVal))                       to aSuggestions[iRow].aValues[0]
78801>>>>>>>                        Increment iRow
78802>>>>>>>                        
78802>>>>>>>                        Move (iRow < iMax) to bContinue
78803>>>>>>>                       
78803>>>>>>>                        Send Request_Read of hoServer GT iFile iIndex  
78804>>>>>>>                    End
78804>>>>>>>>
78804>>>>>>>                    Else Begin
78805>>>>>>>                        If (eType = DF_BCD and Length(sSearch) < iLength) Begin
78807>>>>>>>                            //  For numeric fields we'll jump in the index to the next possible value (for example from 40 to 400)
78807>>>>>>>                            
78807>>>>>>>                            Move (GetRowID(iFile)) to riTest
78808>>>>>>>                            
78808>>>>>>>                            Move (sSearch * 10) to sSearch
78809>>>>>>>                            
78809>>>>>>>                            Get SafeSetFieldValue iFile iField sSearch to bInvalid
78810>>>>>>>                            If bInvalid Begin
78812>>>>>>>                                Move False to bContinue
78813>>>>>>>                            End
78813>>>>>>>>
78813>>>>>>>                            Else Begin
78814>>>>>>>                                Send Request_Read of hoServer GE iFile iIndex
78815>>>>>>>                                Move (not(IsSameRowID(riTest, GetRowID(iFile)))) to bContinue
78816>>>>>>>                            End 
78816>>>>>>>>
78816>>>>>>>                        End
78816>>>>>>>>
78816>>>>>>>                        Else Begin
78817>>>>>>>                            Move False to bContinue
78818>>>>>>>                        End
78818>>>>>>>>
78818>>>>>>>                    End
78818>>>>>>>>
78818>>>>>>>                    
78818>>>>>>>                Loop
78819>>>>>>>>
78819>>>>>>>                Set No_Relate_State of hoServer to bOldRelate
78820>>>>>>>            End
78820>>>>>>>>
78820>>>>>>>        End
78820>>>>>>>>
78820>>>>>>>    End_Procedure
78821>>>>>>>    
78821>>>>>>>    Procedure SuggestionsFindFullText String sSearch tSuggestion[] ByRef aSuggestions
78823>>>>>>>        Integer iFile iField iIndex iRow iMax
78823>>>>>>>        Handle hoServer
78823>>>>>>>        Boolean bContinue bCase  bOldRelate bNeedsRelate
78823>>>>>>>        String sVal sLowSearch
78823>>>>>>>        
78823>>>>>>>        Get Server to hoServer
78824>>>>>>>        Get Data_File  to iFile
78825>>>>>>>        Get Data_Field to iField       
78826>>>>>>>        
78826>>>>>>>        If ((hoServer <> 0) and (iFile <> 0)) Begin
78828>>>>>>>            Get piMaxResults to iMax
78829>>>>>>>            Get pbCaseSensitive to bCase
78830>>>>>>>            
78830>>>>>>>            Get piFindIndex to iIndex
78831>>>>>>>            If (iIndex <= 0) Begin
78833>>>>>>>                Get_Attribute DF_FIELD_INDEX of iFile iField to iIndex
78836>>>>>>>            End
78836>>>>>>>>
78836>>>>>>>            
78836>>>>>>>            Get No_Relate_State of hoServer to bOldRelate
78837>>>>>>>            Get DDOConstraintNeedsRelate of hoServer iIndex to bNeedsRelate
78838>>>>>>>            Set No_Relate_State of hoServer to (not(bNeedsRelate))
78839>>>>>>>            
78839>>>>>>>            
78839>>>>>>>            Move (Lowercase(sSearch)) to sLowSearch
78840>>>>>>>            Move True to bContinue
78841>>>>>>>            Move 0 to iRow
78842>>>>>>>                
78842>>>>>>>            //  Find first record
78842>>>>>>>            Send Request_Read of hoServer FIRST_RECORD iFile iIndex
78843>>>>>>>            
78843>>>>>>>            While (Found and (iRow < iMax))
78847>>>>>>>                Get_Field_Value iFile iField to sVal
78850>>>>>>>                
78850>>>>>>>                If ((bCase and sVal contains sSearch) or (not(bCase) and Lowercase(sVal) contains sLowSearch)) Begin
78852>>>>>>>                    Move (SerializeRowID(GetRowID(iFile)))  to aSuggestions[iRow].sRowId
78853>>>>>>>                    Move (Trim(sVal))                       to aSuggestions[iRow].aValues[0]
78854>>>>>>>                    Increment iRow
78855>>>>>>>                End
78855>>>>>>>>
78855>>>>>>>                
78855>>>>>>>                Send Request_Read of hoServer GT iFile iIndex 
78856>>>>>>>            Loop
78857>>>>>>>>
78857>>>>>>>            Set No_Relate_State of hoServer to bOldRelate
78858>>>>>>>        End
78858>>>>>>>>
78858>>>>>>>    End_Procedure
78859>>>>>>>    
78859>>>>>>>    Procedure SuggestionsSQLFullText String sSearch tSuggestion[] ByRef aSuggestions
78861>>>>>>>        Integer iFile iField iIndex iRow iMax
78861>>>>>>>        Handle hoServer
78861>>>>>>>        Boolean bContinue bOrigActive  bOldRelate bNeedsRelate
78861>>>>>>>        String sVal sOrigFilter sFilter sFile sField
78861>>>>>>>        
78861>>>>>>>        Get Server to hoServer
78862>>>>>>>        Get Data_File  to iFile
78863>>>>>>>        Get Data_Field to iField       
78864>>>>>>>        
78864>>>>>>>        If ((hoServer <> 0) and (iFile <> 0)) Begin
78866>>>>>>>            
78866>>>>>>>            // make sure we send DD messages to owner DDO
78866>>>>>>>            Get Which_Data_Set of hoServer iFile to hoServer
78867>>>>>>>            If (hoServer=0) Begin
78869>>>>>>>                Procedure_Return
78870>>>>>>>            End
78870>>>>>>>>
78870>>>>>>>            
78870>>>>>>>            Get piMaxResults to iMax
78871>>>>>>>            Get piFindIndex to iIndex
78872>>>>>>>            If (iIndex <= 0) Begin
78874>>>>>>>                Get_Attribute DF_FIELD_INDEX of iFile iField to iIndex
78877>>>>>>>            End
78877>>>>>>>>
78877>>>>>>>            
78877>>>>>>>            //  Determine current filter settings
78877>>>>>>>            Get psSQLFilter of hoServer to sOrigFilter
78878>>>>>>>            Get pbUseDDSqlFilters of hoServer to bOrigActive
78879>>>>>>>            
78879>>>>>>>            // generate the Like filter string
78879>>>>>>>            Get SQLStrLike of hoServer iField sSearch to sFilter
78880>>>>>>>            // If filtering was active append this to what's there
78880>>>>>>>            If (bOrigActive) Begin
78882>>>>>>>                Get SQLStrAppend of hoServer sOrigFilter sFilter to sFilter
78883>>>>>>>            End
78883>>>>>>>>
78883>>>>>>>            
78883>>>>>>>            //  Set filter
78883>>>>>>>            Set psSQLFilter of hoServer to sFilter
78884>>>>>>>            Set pbUseDDSqlFilters of hoServer to True
78885>>>>>>>            
78885>>>>>>>            
78885>>>>>>>            // this will optimize No_relate. If your DF constraint does not
78885>>>>>>>            // need a post-relate test, we will disabled relates for this
78885>>>>>>>            Get No_Relate_State of hoServer to bOldRelate
78886>>>>>>>            Get DDOConstraintNeedsRelate of hoServer iIndex to bNeedsRelate
78887>>>>>>>            Set No_Relate_State of hoServer to (not(bNeedsRelate))
78888>>>>>>>
78888>>>>>>>            //  Find records
78888>>>>>>>            Move True to bContinue
78889>>>>>>>            Move 0 to iRow
78890>>>>>>>            
78890>>>>>>>            Send Request_Read of hoServer FIRST_RECORD iFile iIndex
78891>>>>>>>            
78891>>>>>>>            While (bContinue)
78895>>>>>>>                Get_Field_Value iFile iField to sVal
78898>>>>>>>                
78898>>>>>>>                If (Found) Begin // and ((bCase and sVal contains sSearch) or (not(bCase) and Lowercase(sVal) contains sLowSearch))) Begin
78900>>>>>>>                    Move (SerializeRowID(GetRowID(iFile)))  to aSuggestions[iRow].sRowId
78901>>>>>>>                    Move (Trim(sVal))                       to aSuggestions[iRow].aValues[0]
78902>>>>>>>                    Increment iRow
78903>>>>>>>                    
78903>>>>>>>                    Move (iRow < iMax) to bContinue
78904>>>>>>>                   
78904>>>>>>>                    Send Request_Read of hoServer GT iFile iIndex 
78905>>>>>>>                End
78905>>>>>>>>
78905>>>>>>>                Else Begin
78906>>>>>>>                    Move False to bContinue
78907>>>>>>>                End
78907>>>>>>>>
78907>>>>>>>                
78907>>>>>>>            Loop
78908>>>>>>>>
78908>>>>>>>            
78908>>>>>>>            //  Restore filters
78908>>>>>>>            Set psSQLFilter of hoServer to sOrigFilter
78909>>>>>>>            Set pbUseDDSqlFilters of hoServer to bOrigActive
78910>>>>>>>            Set No_Relate_State of hoServer to bOldRelate
78911>>>>>>>        End
78911>>>>>>>>
78911>>>>>>>    End_Procedure
78912>>>>>>>    
78912>>>>>>>    Procedure SuggestionsValidation String sSearch tSuggestion[] ByRef aSuggestions Boolean bFullText
78914>>>>>>>        Handle hoServer hoTable
78914>>>>>>>        Integer iFile iField iRow iCount iFound iMax iLen
78914>>>>>>>        Variant[][] aData
78915>>>>>>>        Boolean bCaseSensitive bContinue
78915>>>>>>>        String sDescr sVal
78915>>>>>>>        
78915>>>>>>>        Get Server to hoServer
78916>>>>>>>        Get Data_File  to iFile
78917>>>>>>>        Get Data_Field to iField       
78918>>>>>>>        
78918>>>>>>>        If ((hoServer <> 0) and (iFile <> 0)) Begin
78920>>>>>>>            Get File_Field_Table_Object of hoServer iFile iField to hoTable
78921>>>>>>>            If (hoTable <> 0) Begin
78923>>>>>>>                Get tabledata of hoTable to aData
78924>>>>>>>        
78924>>>>>>>                Get piMaxResults to iMax
78925>>>>>>>                Get pbCaseSensitive to bCaseSensitive  
78926>>>>>>>            
78926>>>>>>>                If (not(bCaseSensitive)) Begin
78928>>>>>>>                    Move (Lowercase(sSearch)) to sSearch
78929>>>>>>>                End
78929>>>>>>>>
78929>>>>>>>                
78929>>>>>>>                
78929>>>>>>>                Move (SizeOfArray(aData)) to iCount
78930>>>>>>>                Move 0 to iRow
78931>>>>>>>                Move (Length(sSearch)) to iLen
78932>>>>>>>                Move True to bContinue
78933>>>>>>>                
78933>>>>>>>            
78933>>>>>>>                While (iFound < iMax and iRow < iCount and bContinue)
78937>>>>>>>                    If (not(bCaseSensitive)) Begin
78939>>>>>>>                        Move (Lowercase(aData[iRow][0])) to sVal
78940>>>>>>>                        Move (Lowercase(aData[iRow][1])) to sDescr
78941>>>>>>>                    End
78941>>>>>>>>
78941>>>>>>>                    Else Begin
78942>>>>>>>                        Move aData[iRow][0] to sVal
78943>>>>>>>                        Move aData[iRow][1] to sDescr
78944>>>>>>>                    End
78944>>>>>>>>
78944>>>>>>>                    
78944>>>>>>>                    If ((bFullText and (sVal contains sSearch)) or (not(bFullText) and (Left(sVal, iLen) = sSearch))) Begin
78946>>>>>>>                        Move aData[iRow][0] to aSuggestions[iFound].sRowId
78947>>>>>>>                        Move aData[iRow][0] to aSuggestions[iFound].aValues[0]
78948>>>>>>>                        Move aData[iRow][1] to aSuggestions[iFound].aValues[1]
78949>>>>>>>                        Increment iFound
78950>>>>>>>                    End
78950>>>>>>>>
78950>>>>>>>                    Else Begin
78951>>>>>>>                        Move (bFullText or iFound = 0) to bContinue
78952>>>>>>>                    End
78952>>>>>>>>
78952>>>>>>>                    
78952>>>>>>>                    Increment iRow
78953>>>>>>>                Loop
78954>>>>>>>>
78954>>>>>>>            End
78954>>>>>>>>
78954>>>>>>>        End
78954>>>>>>>>
78954>>>>>>>         
78954>>>>>>>    End_Procedure
78955>>>>>>>    
78955>>>>>>>    
78955>>>>>>>    Procedure OnFindSuggestions String sSearch tSuggestion[] ByRef aSuggestions
78957>>>>>>>        Integer iMode iFile
78957>>>>>>>        Boolean bFullText bResult bSupportsSQL
78957>>>>>>>        Handle hoServer
78957>>>>>>>        
78957>>>>>>>        Get Server to hoServer
78958>>>>>>>        Get Data_File  to iFile
78959>>>>>>>        
78959>>>>>>>        If ((hoServer <> 0) and (iFile <> 0)) Begin
78961>>>>>>>            
78961>>>>>>>            Get peSuggestionMode to iMode
78962>>>>>>>            Get pbFullText to bFullText
78963>>>>>>>            
78963>>>>>>>            If (iMode = smFind) Begin
78965>>>>>>>                If (not(bFullText)) Begin
78967>>>>>>>                    Send SuggestionsFindIncremental sSearch (&aSuggestions)
78968>>>>>>>                End
78968>>>>>>>>
78968>>>>>>>                Else Begin
78969>>>>>>>                    Get SupportsSQLFilters of hoServer to bSupportsSQL
78970>>>>>>>                    If (bSupportsSQL) Begin
78972>>>>>>>                        Send SuggestionsSQLFullText sSearch (&aSuggestions)
78973>>>>>>>                    End
78973>>>>>>>>
78973>>>>>>>                    Else Begin
78974>>>>>>>                        Send SuggestionsFindFullText sSearch (&aSuggestions)
78975>>>>>>>                    End
78975>>>>>>>>
78975>>>>>>>                End
78975>>>>>>>>
78975>>>>>>>            End
78975>>>>>>>>
78975>>>>>>>            Else If (iMode = smValidationTable) Begin
78978>>>>>>>                Send SuggestionsValidation sSearch (&aSuggestions) bFullText
78979>>>>>>>            End
78979>>>>>>>>
78979>>>>>>>        End
78979>>>>>>>>
78979>>>>>>>    End_Procedure
78980>>>>>>>    
78980>>>>>>>    Procedure OnSelectSuggestion String sSearch tSuggestion Suggestion
78982>>>>>>>        Handle hoServer
78982>>>>>>>        Integer iFile iField iMode
78982>>>>>>>        Boolean bFind
78982>>>>>>>        RowID rRowId
78982>>>>>>>        
78982>>>>>>>        Get Server to hoServer
78983>>>>>>>        Get Data_File  to iFile
78984>>>>>>>        Get Data_Field to iField       
78985>>>>>>>        
78985>>>>>>>        If ((hoServer <> 0) and (iFile <> 0)) Begin
78987>>>>>>>            Get peSuggestionMode to iMode
78988>>>>>>>            
78988>>>>>>>            If (iMode = smFind) Begin
78990>>>>>>>                Get pbFindOnSelect to bFind
78991>>>>>>>                If (bFind) Begin
78993>>>>>>>                    Move (DeserializeRowID(Suggestion.sRowId)) to rRowId    
78994>>>>>>>                    
78994>>>>>>>                    If (not(IsNullRowID(rRowId))) Begin
78996>>>>>>>                        Send FindByRowId of hoServer iFile rRowId
78997>>>>>>>                    End
78997>>>>>>>>
78997>>>>>>>                End
78997>>>>>>>>
78997>>>>>>>                Else Begin
78998>>>>>>>                    Set Value to Suggestion.aValues[0]
78999>>>>>>>                    Set Item_Changed_State to True
79000>>>>>>>                End
79000>>>>>>>>
79000>>>>>>>            End
79000>>>>>>>>
79000>>>>>>>            Else If (imode = smValidationTable) Begin
79003>>>>>>>                Set Value to Suggestion.sRowId
79004>>>>>>>                Set Item_Changed_State to True
79005>>>>>>>            End
79005>>>>>>>>
79005>>>>>>>            
79005>>>>>>>        End
79005>>>>>>>>
79005>>>>>>>    End_Procedure
79006>>>>>>>    
79006>>>>>>>    // Return true if Suggestion should be invoked. Can be augmented
79006>>>>>>>    Function ShouldSuggestion String sValue Boolean bChanged Returns Boolean
79008>>>>>>>        Integer iStartAtChar
79008>>>>>>>        Get piStartAtChar to iStartAtChar
79009>>>>>>>        Function_Return (bChanged and Length(sValue)>=iStartAtChar)
79010>>>>>>>    End_Function
79011>>>>>>>    
79011>>>>>>>    
79011>>>>>>>End_Class
79012>>>>>>>
79012>>>>>>>
79012>>>>>>>// This contains logic that deals with the Windows object. It relies on the interface in 
79012>>>>>>>// sSuggestion_mixin, which means it must be mixed in as a sibling of this object (as is done
79012>>>>>>>// in dbSuggestionForm or as a child of this object (as is done in cDbCJGridColumnSuggestion), which
79012>>>>>>>// means messages are resolved via delegation. sSuggestion_mixin does not send messages to this class.
79012>>>>>>>// Note that cSuggestion_mixin and cSuggestionControl_mixin are designed so they can be mixed in at
79012>>>>>>>// the same level or mixed in such that cSuggestionControl_mixin is in the child object and cSuggestion_mixin
79012>>>>>>>// is in the parent
79012>>>>>>> 
79012>>>>>>>Class cSuggestionControl_mixin is a Mixin
79013>>>>>>>    
79013>>>>>>>    Procedure Define_cSuggestionControl_mixin
79015>>>>>>>        
79015>>>>>>>        Property Integer piTimeOutTicks 0
79016>>>>>>>        
79016>>>>>>>        On_Key kEnter Send SelectSuggestion
79017>>>>>>>        On_Key Key_Escape Send DeActivateSuggestionList
79018>>>>>>>        On_Key Key_Up_Arrow Send Up
79019>>>>>>>        On_Key Key_Down_Arrow Send Down
79020>>>>>>>
79020>>>>>>>    End_Procedure
79021>>>>>>>
79021>>>>>>>    Procedure AdjustSuggestionListSize Integer iLines
79023>>>>>>>        Integer i  iX iMax iY
79023>>>>>>>        String sTxt
79023>>>>>>>        Boolean bFullWidth
79023>>>>>>>        For i from 0 to (iLines-1)
79029>>>>>>>>
79029>>>>>>>            Get Line of ghoSuggestionList i to sTxt
79030>>>>>>>            Get Text_Extent of ghoSuggestionList sTxt to iX
79031>>>>>>>            Move (Low(iX) max iMax) to iMax
79032>>>>>>>            Move (Hi(iX)) to iY
79033>>>>>>>        Loop
79034>>>>>>>>
79034>>>>>>>        Move (iMax + 20) to imax
79035>>>>>>>        Get pbFullWidth to bFullWidth
79036>>>>>>>        If bFullWidth Begin
79038>>>>>>>            Move (iMax max (Low(GuiSize(Self)))) to iMax
79039>>>>>>>        End
79039>>>>>>>>
79039>>>>>>>        If (iLines) Begin
79041>>>>>>>            Set GuiSize of ghoSuggestionList to (iY*(iLines)+8) iMax
79042>>>>>>>            Send SelectRow of ghoSuggestionList 0 // go to first line
79043>>>>>>>        End
79043>>>>>>>>
79043>>>>>>>        Else Begin
79044>>>>>>>            Set GuiSize of ghoSuggestionList to (Hi(GuiSize(Self))) (low(GuiSize(Self)))
79045>>>>>>>        End
79045>>>>>>>>
79045>>>>>>>    End_Procedure
79046>>>>>>>    
79046>>>>>>>    // show all suggestions
79046>>>>>>>    Procedure ShowSuggestions
79048>>>>>>>        tSuggestion[] aResults
79048>>>>>>>        tSuggestion[] aResults
79049>>>>>>>        Integer i iLines
79049>>>>>>>        String sSearch 
79049>>>>>>>        Get pSearchResults to aResults
79050>>>>>>>        Get Value to sSearch
79051>>>>>>>        Send Delete_Data of ghoSuggestionList
79052>>>>>>>        Move (SizeOfArray(aResults)) to iLines
79053>>>>>>>        For i from 0 to (iLines-1)
79059>>>>>>>>
79059>>>>>>>            Send ShowSuggestion aResults[i] sSearch
79060>>>>>>>            If ((iLines-1)<>i) Begin
79062>>>>>>>                Send AppendTextLn of ghoSuggestionList ""
79063>>>>>>>            End
79063>>>>>>>>
79063>>>>>>>        Loop
79064>>>>>>>>
79064>>>>>>>        Send AdjustSuggestionListSize iLines
79065>>>>>>>    End_Procedure
79066>>>>>>>
79066>>>>>>>    Procedure FindSuggestions 
79068>>>>>>>        String sSearch
79068>>>>>>>        tSuggestion[] aResults
79068>>>>>>>        tSuggestion[] aResults
79069>>>>>>>        String[] aParams
79070>>>>>>>        Get Value to sSearch
79071>>>>>>>        Send OnFindSuggestions sSearch (&aResults)
79072>>>>>>>        Set pSearchResults to aResults
79073>>>>>>>        // if an error was raised, the suggestion list will be gone
79073>>>>>>>        If (ghoSuggestionList) Begin
79075>>>>>>>            Send ShowSuggestions
79076>>>>>>>        End
79076>>>>>>>>
79076>>>>>>>    End_Procedure
79077>>>>>>>
79077>>>>>>>    Procedure SelectSuggestion 
79079>>>>>>>        String sSearch
79079>>>>>>>        tSuggestion[] aData
79079>>>>>>>        tSuggestion[] aData
79080>>>>>>>        Integer iSelRow
79080>>>>>>>        If ghoSuggestionList Begin
79082>>>>>>>            Get SelectedRow of ghoSuggestionList to iSelRow
79083>>>>>>>            Get Value to sSearch
79084>>>>>>>            Get pSearchResults to aData        
79085>>>>>>>            Send DeActivateSuggestionList
79086>>>>>>>            Send CancelEditIfGrid
79087>>>>>>>            If (iSelRow>=0 and SizeOfArray(aData)>iSelRow) Begin
79089>>>>>>>                Send OnSelectSuggestion sSearch aData[iSelRow] 
79090>>>>>>>            End
79090>>>>>>>>
79090>>>>>>>        End
79090>>>>>>>>
79090>>>>>>>        Else Begin
79091>>>>>>>            Send Default_Action
79092>>>>>>>        End
79092>>>>>>>>
79092>>>>>>>    End_Procedure
79093>>>>>>>    
79093>>>>>>>    Procedure CancelEditIfGrid
79095>>>>>>>        // do nothing with forms, remember
79095>>>>>>>        // to replace or augment with grid to
79095>>>>>>>        // cancel the edit control
79095>>>>>>>    End_Procedure
79096>>>>>>>
79096>>>>>>>    
79096>>>>>>>    Function ParentForSuggestion Returns Handle
79098>>>>>>>        Handle hoMain hoMainPanel
79098>>>>>>>
79098>>>>>>>        // we must have an application object and a main panel object
79098>>>>>>>        If ghoApplication Begin
79100>>>>>>>            Get phoMainPanel of ghoApplication to hoMainPanel
79101>>>>>>>        End
79101>>>>>>>>
79101>>>>>>>        If (hoMainPanel=0 or Self<=Desktop) Begin
79103>>>>>>>            Function_Return 0
79104>>>>>>>        End
79104>>>>>>>>
79104>>>>>>>
79104>>>>>>>        Move Self to hoMain
79105>>>>>>>        Repeat
79105>>>>>>>>
79105>>>>>>>            Get Parent of hoMain to hoMain
79106>>>>>>>        Until (hoMain=Desktop or Block_Mouse_State(hoMain) or hoMainPanel=hoMain)
79108>>>>>>>
79108>>>>>>>        Function_Return (If(hoMain>Desktop,hoMain,0))
79109>>>>>>>        
79109>>>>>>>    End_Function
79110>>>>>>>    
79110>>>>>>>    Procedure ActivateSuggestionList
79112>>>>>>>        Handle hoView hcSuggest
79112>>>>>>>        Get ParentForSuggestion to hoView
79113>>>>>>>        If hoView Begin
79115>>>>>>>            Get phcSuggestionListClass to hcSuggest
79116>>>>>>>            Get CreateNamed of hoView hcSuggest "oSuggestList" to ghoSuggestionList
79117>>>>>>>            Send InitList of ghoSuggestionList Self
79118>>>>>>>            Set Focus_Mode of ghoSuggestionList to Focusable
79119>>>>>>>            Set phoOwner of ghoSuggestionList to Self
79120>>>>>>>            Send Add_Focus of ghoSuggestionList hoView
79121>>>>>>>        End
79121>>>>>>>>
79121>>>>>>>    End_Procedure
79122>>>>>>>    
79122>>>>>>>    Procedure DeActivateSuggestionList
79124>>>>>>>        If ghoSuggestionList Begin
79126>>>>>>>            Send DeactivateList of ghoSuggestionList
79127>>>>>>>        End
79127>>>>>>>>
79127>>>>>>>    End_Procedure
79128>>>>>>>    
79128>>>>>>>    // augment to kill suggest list if focus is not moving to it  
79128>>>>>>>    // customized for grid
79128>>>>>>>    Procedure OnKillFocus
79130>>>>>>>        // note focus has already changed here
79130>>>>>>>        If (ghoSuggestionList) Begin
79132>>>>>>>            If (Focus(Self)<>ghoSuggestionList) Begin
79134>>>>>>>                Send DeActivateSuggestionList
79135>>>>>>>                Forward Send OnKillFocus
79137>>>>>>>            End
79137>>>>>>>>
79137>>>>>>>            Else Begin
79138>>>>>>>                // giving focus to the suggestion list here
79138>>>>>>>            End
79138>>>>>>>>
79138>>>>>>>        End
79138>>>>>>>>
79138>>>>>>>        Else Begin
79139>>>>>>>            Forward Send OnKillFocus
79141>>>>>>>        End
79141>>>>>>>>
79141>>>>>>>    End_Procedure
79142>>>>>>>    
79142>>>>>>>    Procedure Up
79144>>>>>>>        If (Focus(Desktop) = Self and ghoSuggestionList) Begin
79146>>>>>>>           Send ScrollUp of ghoSuggestionList
79147>>>>>>>        End
79147>>>>>>>>
79147>>>>>>>    End_Procedure
79148>>>>>>>
79148>>>>>>>    Procedure Down
79150>>>>>>>        If (Focus(Desktop) = Self and ghoSuggestionList) Begin
79152>>>>>>>           Send ScrollDown of ghoSuggestionList
79153>>>>>>>        End
79153>>>>>>>>
79153>>>>>>>    End_Procedure
79154>>>>>>>    
79154>>>>>>>
79154>>>>>>>    Procedure Key Integer iKey
79156>>>>>>>        Integer iEndTicks
79156>>>>>>>        
79156>>>>>>>        If (Focus(Desktop) <> Self) Begin
79158>>>>>>>          Forward Send Key iKey
79160>>>>>>>          Procedure_Return
79161>>>>>>>        End
79161>>>>>>>>
79161>>>>>>>        
79161>>>>>>>        Send DeActivateSuggestionList
79162>>>>>>>        Move (GetTickCount()) to iEndTicks
79163>>>>>>>        // record the time of key press
79163>>>>>>>        If (piTimeOutTicks(Self) = 0) Begin
79165>>>>>>>         
79165>>>>>>>            If (ghoSuggestionTimer=0) Begin
79167>>>>>>>               Send CreateSuggestionTimer
79168>>>>>>>            End
79168>>>>>>>>
79168>>>>>>>         
79168>>>>>>>            Set pbEnabled of ghoSuggestionTimer to True
79169>>>>>>>            Set phoTimerOwner of ghoSuggestionTimer to Self
79170>>>>>>>        End
79170>>>>>>>>
79170>>>>>>>        Set piTimeOutTicks to iEndTicks
79171>>>>>>>        
79171>>>>>>>        Forward Send Key iKey
79173>>>>>>>    End_Procedure
79174>>>>>>>    
79174>>>>>>>    Procedure CreateSuggestionTimer
79176>>>>>>>        Handle hoMainPanel
79176>>>>>>>        // we must have an application object and a main panel object
79176>>>>>>>        If ghoApplication Begin
79178>>>>>>>            Get phoMainPanel of ghoApplication to hoMainPanel
79179>>>>>>>        End
79179>>>>>>>>
79179>>>>>>>        If (hoMainPanel=0) Begin
79181>>>>>>>            Error DFERR_PROGRAM "Auto-suggest requires an application object and a main panel object"
79182>>>>>>>>
79182>>>>>>>            Procedure_Return
79183>>>>>>>        End
79183>>>>>>>>
79183>>>>>>>        Get CreateNamed of hoMainPanel (RefClass(cSuggestionTimer)) "oSuggestionTimer" to ghoSuggestionTimer
79184>>>>>>>    End_Procedure
79185>>>>>>>  
79185>>>>>>>    // sent by Auto Suggest Timer. Invoke suggestion list as needed
79185>>>>>>>    Procedure OnSuggestionTimer
79187>>>>>>>        Boolean bDoIt
79187>>>>>>>        Integer iEndTicks iStartTicks iTicks iTimeOut iChanged
79187>>>>>>>        String sValue
79187>>>>>>>        
79187>>>>>>>        If (Focus(Desktop) <> Self) Begin
79189>>>>>>>            // focus out of whack. Stop the timer
79189>>>>>>>            Set pbEnabled of ghoSuggestionTimer to False
79190>>>>>>>            Send DeActivateSuggestionList   
79191>>>>>>>            Procedure_Return
79192>>>>>>>        End                                
79192>>>>>>>>
79192>>>>>>>
79192>>>>>>>        Get piTimeOutTicks to iStartTicks
79193>>>>>>>        If (iStartTicks <> 0) Begin           
79195>>>>>>>            Move (GetTickCount()) to iEndTicks 
79196>>>>>>>            Move (iEndTicks - iStartTicks) to iTicks
79197>>>>>>>            // If tick count rolled over
79197>>>>>>>            If (iTicks < 0) Begin
79199>>>>>>>                Move (-iTicks) to iTicks 
79200>>>>>>>            End
79200>>>>>>>>
79200>>>>>>>        End
79200>>>>>>>>
79200>>>>>>>        Get piPopupTimeout to iTimeOut
79201>>>>>>>        If (iTicks >= iTimeOut) Begin
79203>>>>>>>            // If time delay has been met, launch autocomplete
79203>>>>>>>            Set pbEnabled  of ghoSuggestionTimer to False
79204>>>>>>>            Get Value to sValue
79205>>>>>>>            Get Item_Changed_State 0 to iChanged
79206>>>>>>>            Get ShouldSuggestion sValue iChanged to bDoIt
79207>>>>>>>            If bDoIt Begin
79209>>>>>>>                Send ActivateSuggestionList
79210>>>>>>>                Send FindSuggestions
79211>>>>>>>                Set Visible_State of ghoSuggestionList to True
79212>>>>>>>            End
79212>>>>>>>>
79212>>>>>>>            Set piTimeOutTicks to 0
79213>>>>>>>        End
79213>>>>>>>>
79213>>>>>>>    End_Procedure
79214>>>>>>>
79214>>>>>>>End_Class
79215>>>>>>>
79215>>>>>Use cDbCJGridColumn.pkg
79215>>>>>Use cDbCJGridColumnEdit.pkg
79215>>>>>
79215>>>>>// This is the edit control that gets embedded in cDbCJGridColumnSuggestion object.
79215>>>>>
79215>>>>>Class cDbCJGridColumnSuggestionEdit is a cDbCJGridColumnEdit
79216>>>>>
79216>>>>>    Import_Class_Protocol cSuggestionControl_mixin
79217>>>>>
79217>>>>>    Procedure Construct_Object
79219>>>>>        Forward Send Construct_Object
79221>>>>>        Send Define_cSuggestionControl_mixin
79222>>>>>    End_Procedure
79223>>>>>    
79223>>>>>    // Called when closing a suggestion form. With grids we must also make sure that the
79223>>>>>    // edit is canceled. 
79223>>>>>    Procedure CancelEditIfGrid
79225>>>>>        Send CancelEdit
79226>>>>>    End_Procedure
79227>>>>>    
79227>>>>>End_Class
79228>>>>>
79228>>>>>// A cDbCJGridColumnSuggestion would be dropped inside of cDbCJGrid.
79228>>>>>
79228>>>>>Class cDbCJGridColumnSuggestion is a cDbCJGridColumn
79229>>>>>    
79229>>>>>    Import_Class_Protocol cSuggestion_mixin            
79230>>>>>    
79230>>>>>    Procedure Construct_Object
79232>>>>>        Forward Send Construct_Object
79234>>>>>
79234>>>>>        Send Define_cSuggestion_mixin
79235>>>>>        Set phcEditClass to (RefClass(cDbCJGridColumnSuggestionEdit))
79236>>>>>    End_Procedure
79237>>>>>    
79237>>>>>End_Class
79238>>>Use dfSelLst.pkg
79238>>>
79238>>>Deferred_View Activate_RegistroEmpleado for ;Object RegistroEmpleado is a dbView
79263>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
79265>>>    End_Object
79266>>>
79266>>>    Object oEmpleado_DD is a cEmpleadoDataDictionary
79268>>>        Set DDO_Server to oNacionalidad_DD
79269>>>    End_Object
79270>>>
79270>>>    Set Main_DD to oEmpleado_DD
79271>>>    Set Server to oEmpleado_DD
79272>>>
79272>>>    Set Border_Style to Border_Thick
79273>>>    Set Size to 164 422
79274>>>    Set Location to 2 2
79275>>>    Set Label to "Registro de Empleado"
79276>>>    Set piMaxSize to 164 450
79277>>>    Set piMinSize to 164 422
79278>>>
79278>>>    Object oDbGroup1 is a dbGroup
79280>>>        Set Size to 128 164
79281>>>        Set Location to 29 9
79282>>>        Set Label to "Datos Personales"
79283>>>        Set Color to clSilver
79284>>>
79284>>>        Object oEmpleado_Numero is a dbForm
79286>>>            Entry_Item Empleado.Numero
79287>>>            Set Location to 21 66
79288>>>            Set Size to 13 30
79289>>>            Set Label to "Numero:"
79290>>>            Set Prompt_Button_Mode to PB_PromptOn
79291>>>            Set Label_Color to clSilver
79292>>>        End_Object
79293>>>
79293>>>        Object oEmpleado_PrimerNombre is a dbForm
79295>>>            Entry_Item Empleado.PrimerNombre
79296>>>            Set Location to 36 66
79297>>>            Set Size to 13 87
79298>>>            Set Label to "PrimerNombre:"
79299>>>            Set Label_Color to clSilver
79300>>>        End_Object
79301>>>
79301>>>        Object oEmpleado_SegundoNombre is a dbForm
79303>>>            Entry_Item Empleado.SegundoNombre
79304>>>            Set Location to 51 66
79305>>>            Set Size to 13 87
79306>>>            Set Label to "SegundoNombre:"
79307>>>            Set Label_Color to clSilver
79308>>>        End_Object
79309>>>
79309>>>        Object oEmpleado_PrimerApellido is a dbForm
79311>>>            Entry_Item Empleado.PrimerApellido
79312>>>            Set Location to 66 66
79313>>>            Set Size to 13 87
79314>>>            Set Label to "PrimerApellido:"
79315>>>            Set Label_Color to clSilver
79316>>>        End_Object
79317>>>
79317>>>        Object oEmpleado_SegundoApellido is a dbForm
79319>>>            Entry_Item Empleado.SegundoApellido
79320>>>            Set Location to 82 66
79321>>>            Set Size to 13 87
79322>>>            Set Label to "SegundoApellido:"
79323>>>            Set Label_Color to clSilver
79324>>>        End_Object
79325>>>
79325>>>        Object oNacionalidad_Pais is a dbForm
79327>>>            Entry_Item Nacionalidad.Pais
79328>>>            Set Location to 98 92
79329>>>            Set Size to 13 61
79330>>>        End_Object
79331>>>
79331>>>        Object oEmpleado_Nacionalidad is a dbForm
79333>>>            Entry_Item Nacionalidad.Numero
79334>>>            Set Location to 98 66
79335>>>            Set Size to 13 22
79336>>>            Set Label to "Nacionalidad:"
79337>>>            Set Prompt_Button_Mode to PB_PromptOn
79338>>>            Set Prompt_Object to (ListaNacionalidad(Current_Object))
79339>>>          
79339>>>        End_Object
79340>>>    End_Object
79341>>>
79341>>>    Object oDbListEmpleado is a dbList
79343>>>        Set Size to 131 243
79344>>>        Set Location to 29 178
79345>>>        
79345>>>
79345>>>        Begin_Row
79348>>>            Entry_Item Empleado.Numero             
79349>>>            Entry_Item (Trim(Empleado.PrimerNombre) + ' ' + Trim( Empleado.SegundoNombre))
79350>>>            Entry_Item (Trim(Empleado.PrimerApellido) + ' ' + Trim( Empleado.SegundoApellido))
79351>>>            Entry_Item Nacionalidad.Pais
79352>>>        End_Row
79357>>>
79357>>>        Set Main_File to Empleado.File_Number
79358>>>
79358>>>        Set Form_Width 0 to 25
79359>>>        Set Header_Label 0 to "Num"
79360>>>        Set Form_Width 1 to 80
79361>>>        Set Header_Label 1 to "Nombres "
79362>>>        Set Form_Width 2 to 80
79363>>>        Set Header_Label 2 to "Apellidos"
79364>>>        Set Form_Width 3 to 50
79365>>>        Set Header_Label 3 to "Pais"
79366>>>    End_Object
79367>>>
79367>>>Cd_End_Object
79369>>>>
79369>        Use RegistroMarcajes.vw
Including file: RegistroMarcajes.vw    (C:\DataFlex Projects\Control Marcajes\AppSrc\RegistroMarcajes.vw)
79369>>>Use Windows.pkg
79369>>>Use DFClient.pkg
79369>>>Use cDbCJGrid.pkg
79369>>>Use cdbCJGridColumn.pkg
79369>>>Use cNacionalidadDataDictionary.dd
79369>>>Use cEmpleadoDataDictionary.dd
79369>>>Use cTipoMarcajeDataDictionary.dd
Including file: cTipoMarcajeDataDictionary.dd    (C:\DataFlex Projects\Control Marcajes\DDSrc\cTipoMarcajeDataDictionary.dd)
79369>>>>>Use DataDict.pkg
79369>>>>>
79369>>>>>Open TipoMarcaje
Including file: TipoMarcaje.fd    (C:\DataFlex Projects\Control Marcajes\DDSrc\TipoMarcaje.fd)
79371>>>>>Open Marcaje
79373>>>>>Open Autoincrementable
79375>>>>>
79375>>>>>Class cTipoMarcajeDataDictionary is a DataDictionary
79376>>>>>    
79376>>>>>    Procedure Construct_Object
79378>>>>>        Forward Send Construct_Object
79380>>>>>        Set Main_File to TipoMarcaje.File_Number
79381>>>>>
79381>>>>>        Set Add_System_File to Autoincrementable.File_Number DD_Lock_On_All
79382>>>>>
79382>>>>>        Set Add_Client_File to Marcaje.File_Number
79383>>>>>
79383>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79384>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79385>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79386>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79387>>>>>
79387>>>>>        Set Field_Option Field TipoMarcaje.Numero DD_AUTOFIND to True
79388>>>>>        Set Key_Field_State Field TipoMarcaje.Numero to True
79389>>>>>        Set Field_Auto_Increment Field TipoMarcaje.Numero to File_Field Autoincrementable.NumTipoMarcaje
79390>>>>>
79390>>>>>        Set Field_Option Field TipoMarcaje.TipoMarcaje DD_CAPSLOCK to True
79391>>>>>        Set Field_Option Field TipoMarcaje.TipoMarcaje DD_AUTOFIND to True
79392>>>>>        Set Field_Option Field TipoMarcaje.TipoMarcaje DD_REQUIRED to True
79393>>>>>
79393>>>>>    End_Procedure
79394>>>>>
79394>>>>>End_Class
79395>>>Use cMarcajeDataDictionary.dd
Including file: cMarcajeDataDictionary.dd    (C:\DataFlex Projects\Control Marcajes\DDSrc\cMarcajeDataDictionary.dd)
79395>>>>>Use DataDict.pkg
79395>>>>>
79395>>>>>Open Marcaje
79397>>>>>Open Empleado
79399>>>>>Open TipoMarcaje
79401>>>>>Open Autoincrementable
79403>>>>>
79403>>>>>Register_Object ListaTipoMarcaje
79403>>>>>Register_Object ListaEmpleado
79403>>>>>
79403>>>>>Class cMarcajeDataDictionary is a DataDictionary
79404>>>>>    
79404>>>>>    Procedure Construct_Object
79406>>>>>        Forward Send Construct_Object
79408>>>>>        Set Main_File to Marcaje.File_Number
79409>>>>>
79409>>>>>        Set Add_System_File to Autoincrementable.File_Number DD_Lock_On_All
79410>>>>>
79410>>>>>        Set Add_Server_File to Empleado.File_Number
79411>>>>>        Set Add_Server_File to TipoMarcaje.File_Number
79412>>>>>
79412>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79413>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79414>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79415>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79416>>>>>
79416>>>>>        Set Field_Option Field Marcaje.Numero DD_AUTOFIND to True
79417>>>>>        Set Field_Auto_Increment Field Marcaje.Numero to File_Field Autoincrementable.NumMarcaje
79418>>>>>        Set Key_Field_State Field Marcaje.Numero to True
79419>>>>>        Set Field_Option Field Marcaje.Numero DD_DISPLAYONLY to True
79420>>>>>
79420>>>>>        Set Field_Prompt_Object Field Marcaje.Empleado to ListaEmpleado
79421>>>>>        Set Field_Option Field Marcaje.Empleado DD_AUTOFIND to True
79422>>>>>        Set Field_Option Field Marcaje.Empleado DD_CAPSLOCK to True
79423>>>>>        Set Field_Option Field Marcaje.Empleado DD_REQUIRED to True
79424>>>>>
79424>>>>>        Set Field_Option Field Marcaje.FechaMarcaje DD_REQUIRED to True
79425>>>>>
79425>>>>>        Set Field_Option Field Marcaje.HoraMarcaje DD_REQUIRED to True
79426>>>>>
79426>>>>>        Set Field_Prompt_Object Field Marcaje.TipoMarcaje to ListaTipoMarcaje
79427>>>>>        Set Field_Option Field Marcaje.TipoMarcaje DD_AUTOFIND to True
79428>>>>>        Set Field_Option Field Marcaje.TipoMarcaje DD_REQUIRED to True
79429>>>>>
79429>>>>>    End_Procedure
79430>>>>>
79430>>>>>End_Class
79431>>>>>
79431>>>>>Use ListaEmpleado.sl
79431>>>>>Use ListaTipoMarcaje.sl
Including file: ListaTipoMarcaje.sl    (C:\DataFlex Projects\Control Marcajes\AppSrc\ListaTipoMarcaje.sl)
79431>>>>>>>//**************************************************************
79431>>>>>>>// TableLookup.tpl for Windows application for Spanish 
79431>>>>>>>// translated by Moose Software (www.moose-software.com) 
79431>>>>>>>// 13/07/2010 Revised for VDF 16.0 by Moose Software
79431>>>>>>>// 05/02/2012 Revised for VDF 17.0 by Moose Software
79431>>>>>>>// 13/06/2013 Revised for VDF 17.1 by Moose Software
79431>>>>>>>// 02/05/2014 Revised for VDF 18.0 by Moose Software
79431>>>>>>>//*************************************************************
79431>>>>>>>
79431>>>>>>>Use Windows.pkg
79431>>>>>>>Use DFClient.pkg
79431>>>>>>>use DFSellst.pkg
79431>>>>>>>Use cTipoMarcajeDataDictionary.dd
79431>>>>>>>
79431>>>>>>>Object ListaTipoMarcaje is a dbModalPanel
79433>>>>>>>    Object oTipoMarcaje_DD is a cTipoMarcajeDataDictionary
79435>>>>>>>    End_Object
79436>>>>>>>
79436>>>>>>>    Set Main_DD to oTipoMarcaje_DD
79437>>>>>>>    Set Server to oTipoMarcaje_DD
79438>>>>>>>
79438>>>>>>>    Set Size to 133 292
79439>>>>>>>    Set Location     to 4 5
79440>>>>>>>    Set Border_Style to Border_Thick
79441>>>>>>>    Set Label to "Tipo Marcaje"
79442>>>>>>>
79442>>>>>>>    Object oSelList is a dbList
79444>>>>>>>        Set peAnchors to anAll
79445>>>>>>>        Set Size      to 105 280
79446>>>>>>>        Set Location  to 6 6
79447>>>>>>>
79447>>>>>>>        Begin_Row
79450>>>>>>>            Entry_Item TipoMarcaje.Numero
79451>>>>>>>            Entry_Item TipoMarcaje.TipoMarcaje
79452>>>>>>>        End_Row
79457>>>>>>>
79457>>>>>>>        Set Main_File to TipoMarcaje.File_Number
79458>>>>>>>
79458>>>>>>>        Set Form_Width 0 to 48
79459>>>>>>>        Set Header_Label 0 to "Numero"
79460>>>>>>>        Set Form_Width 1 to 60
79461>>>>>>>        Set Header_Label 1 to "TipoMarcaje"
79462>>>>>>>    End_Object
79463>>>>>>>
79463>>>>>>>    Object oOK_bn is a Button
79465>>>>>>>        Set Label     to "&Aceptar"
79466>>>>>>>        Set Location  to 115 128
79467>>>>>>>        Set peAnchors to anBottomRight
79468>>>>>>>
79468>>>>>>>        Procedure OnClick
79471>>>>>>>            Send Ok of oSelList
79472>>>>>>>        End_Procedure
79473>>>>>>>
79473>>>>>>>    End_Object
79474>>>>>>>
79474>>>>>>>    Object oCancel_bn is a Button
79476>>>>>>>        Set Label     to "&Cancelar"
79477>>>>>>>        Set Location  to 115 182
79478>>>>>>>        Set peAnchors to anBottomRight
79479>>>>>>>
79479>>>>>>>        Procedure OnClick
79482>>>>>>>            Send Cancel of oSelList
79483>>>>>>>        End_Procedure
79484>>>>>>>
79484>>>>>>>    End_Object
79485>>>>>>>
79485>>>>>>>    Object oSearch_bn is a Button
79487>>>>>>>        Set Label     to "&Buscar..."
79488>>>>>>>        Set Location  to 115 236
79489>>>>>>>        Set peAnchors to anBottomRight
79490>>>>>>>
79490>>>>>>>        Procedure OnClick
79493>>>>>>>            Send Search of oSelList
79494>>>>>>>        End_Procedure
79495>>>>>>>
79495>>>>>>>    End_Object
79496>>>>>>>
79496>>>>>>>    On_Key Key_Alt+Key_A Send KeyAction of oOk_bn
79497>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
79498>>>>>>>    On_Key Key_Alt+Key_B Send KeyAction of oSearch_bn
79499>>>>>>>
79499>>>>>>>End_Object
79500>>>>>>>
79500>>>>>>>//*********************************************** end of TableLookup.tpl for Spanish ****************
79500>>>>>>>
79500>>>Use cDbCJGridColumnSuggestion.pkg
79500>>>Use cCJGridColumn.pkg
79500>>>
79500>>>Activate_View Activate_RegistroMarcajes for RegistroMarcajes
79510>>>>
79510>>>Object RegistroMarcajes is a dbView
79512>>>    Object oTipoMarcaje_DD is a cTipoMarcajeDataDictionary
79514>>>    End_Object
79515>>>
79515>>>    Object oNacionalidad_DD is a cNacionalidadDataDictionary
79517>>>    End_Object
79518>>>
79518>>>    Object oEmpleado_DD is a cEmpleadoDataDictionary
79520>>>        Set DDO_Server to oNacionalidad_DD
79521>>>    End_Object
79522>>>
79522>>>    Object oMarcaje_DD is a cMarcajeDataDictionary
79524>>>        Set DDO_Server to oTipoMarcaje_DD
79525>>>        Set DDO_Server to oEmpleado_DD
79526>>>    End_Object
79527>>>
79527>>>    Set Main_DD to oMarcaje_DD
79528>>>    Set Server to oMarcaje_DD
79529>>>
79529>>>    Set Border_Style to Border_Thick
79530>>>    Set Size to 236 498
79531>>>    Set Location to 2 2
79532>>>    Set Label to "Registro de Marcajes"
79533>>>    Set Bitmap_Style to Bitmap_Center
79534>>>    
79534>>>
79534>>>    Object oDbGroup1 is a dbGroup
79536>>>        Set Size to 207 480
79537>>>        Set Location to 13 11
79538>>>        Set Label to "Registro de Marcajes"
79539>>>
79539>>>        Object oDbCJGrid1 is a cDbCJGrid
79541>>>            Set Size to 183 463
79542>>>            Set Location to 14 9
79543>>>
79543>>>            Object oMarcaje_Numero is a cDbCJGridColumn
79545>>>                Entry_Item Marcaje.Numero
79546>>>                Set piWidth to 52
79547>>>                Set psCaption to "Numero"
79548>>>                Set pbCapslock to True
79549>>>            End_Object
79550>>>            
79550>>>            
79550>>>
79550>>>            Object oMarcaje_Empleado is a cDbCJGridColumn
79552>>>                Entry_Item Empleado.Numero 
79553>>>                Set piWidth to 69
79554>>>                Set psCaption to "Empleado"
79555>>>            End_Object
79556>>>
79556>>>            Object ColumnaUnida is a cDbCJGridColumn
79558>>>                Set_Field_Value Empleado.PrimerApellido to "Hola"
                Set_Field_Value Empleado.PrimerApellido to "Hola"
ERROR: 4345 Error de comprobaci¢n de tipo TO, MUST BE DEFINED ON LINE: 64 (79558) OF FILE: C:\DataFlex Projects\Control Marcajes\AppSrc\RegistroMarcajes.vw
ERROR: 4345 Error de comprobaci¢n de tipo |CS"Hola", INVALID LITERAL ON LINE: 64 (79558) OF FILE: C:\DataFlex Projects\Control Marcajes\AppSrc\RegistroMarcajes.vw
ERROR: 4345 Error de comprobaci¢n de tipo  #$, ARGUMENT REQUIRED ON LINE: 64 (79558) OF FILE: C:\DataFlex Projects\Control Marcajes\AppSrc\RegistroMarcajes.vw
ERROR: 4345 Error de comprobaci¢n de tipo  #$, INVALID LITERAL ON LINE: 64 (79558) OF FILE: C:\DataFlex Projects\Control Marcajes\AppSrc\RegistroMarcajes.vw
ERROR: 4345 Error de comprobaci¢n de tipo  #$, ARGUMENT REQUIRED ON LINE: 64 (79558) OF FILE: C:\DataFlex Projects\Control Marcajes\AppSrc\RegistroMarcajes.vw
ERROR: 4345 Error de comprobaci¢n de tipo  #$, INVALID LITERAL ON LINE: 64 (79558) OF FILE: C:\DataFlex Projects\Control Marcajes\AppSrc\RegistroMarcajes.vw
ERROR: 4345 Error de comprobaci¢n de tipo  #$, ARGUMENT REQUIRED ON LINE: 64 (79558) OF FILE: C:\DataFlex Projects\Control Marcajes\AppSrc\RegistroMarcajes.vw
ERROR: 4345 Error de comprobaci¢n de tipo TO, MUST BE DEFINED ON LINE: 64 (79559) OF FILE: C:\DataFlex Projects\Control Marcajes\AppSrc\RegistroMarcajes.vw
ERROR: 4345 Error de comprobaci¢n de tipo |CS"Hola", INVALID LITERAL ON LINE: 64 (79559) OF FILE: C:\DataFlex Projects\Control Marcajes\AppSrc\RegistroMarcajes.vw
ERROR: 4345 Error de comprobaci¢n de tipo  #$, ARGUMENT REQUIRED ON LINE: 64 (79559) OF FILE: C:\DataFlex Projects\Control Marcajes\AppSrc\RegistroMarcajes.vw
ERROR: 4345 Error de comprobaci¢n de tipo  #$, ARGUMENT REQUIRED ON LINE: 64 (79559) OF FILE: C:\DataFlex Projects\Control Marcajes\AppSrc\RegistroMarcajes.vw
ERROR: 4345 Error de comprobaci¢n de tipo TO, MUST BE DEFINED ON LINE: 64 (79559) OF FILE: C:\DataFlex Projects\Control Marcajes\AppSrc\RegistroMarcajes.vw
ERROR: 4328 Simbolo no definido en argumento TO ON LINE: 64 (79559) OF FILE: C:\DataFlex Projects\Control Marcajes\AppSrc\RegistroMarcajes.vw
79561>>>                Set piWidth to 144
79562>>>                Set psCaption to "Todo"
79563>>>                Set Visible_State to True
79564>>>            End_Object
79565>>>
79565>>>            Object oEmpleado_PrimerNombre is a cDbCJGridColumn 
79567>>>                               
79567>>>                Entry_Item Empleado.PrimerApellido
79568>>>                
79568>>>                Set piWidth to 226
79569>>>                Set psCaption to "Nombre Completo"
79570>>>                Set pbResizable to False
79571>>>            End_Object
79572>>>
79572>>>            Object oMarcaje_FechaMarcaje is a cDbCJGridColumn
79574>>>                Entry_Item Marcaje.FechaMarcaje
79575>>>                Set piWidth to 87
79576>>>                Set psCaption to "Fecha"
79577>>>            End_Object
79578>>>
79578>>>            Object oMarcaje_HoraMarcaje is a cDbCJGridColumn
79580>>>                Entry_Item Marcaje.HoraMarcaje
79581>>>                Set piWidth to 91
79582>>>                Set psCaption to "Hora"
79583>>>            End_Object
79584>>>
79584>>>            Object oMarcaje_TipoMarcaje is a cDbCJGridColumn
79586>>>                Entry_Item TipoMarcaje.Numero
79587>>>                Set piWidth to 72
79588>>>                Set psCaption to "Tipo Marcaje"
79589>>>                Set Prompt_Button_Mode to PB_PromptOn
79590>>>                Set Prompt_Object of oMarcaje_TipoMarcaje to (ListaTipoMarcaje(Current_Object))
79591>>>                
79591>>>            End_Object
79592>>>
79592>>>            Object oTipoMarcaje_TipoMarcaje is a cDbCJGridColumn
79594>>>                Entry_Item TipoMarcaje.TipoMarcaje
79595>>>                Set piWidth to 69
79596>>>                Set psCaption to "Marcaje"
79597>>>                
79597>>>            End_Object
79598>>>        End_Object
79599>>>    End_Object
79600>>>
79600>>>End_Object
79601>
79601>        Procedure Activate_About
79604>            Send DoAbout "" "" "" "" ""
79605>        End_Procedure
79606>
79606>    End_Object
79607>
79607>End_Object
79608>
79608>Start_UI
79609>
79609>//************************** end of WindowsProject.tpl for Spanish **************
79609>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 13
Total Symbols  : 45318
Total Resources: 0
Total Commands : 79608
Total Windows  : 1
Total Pages    : 1
Static Data    : 485837
Message area   : 550516
Total Blocks   : 28555
13 ERRORS HAVE BEEN FOUND.
